<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ggcoefstats • ggstatsplot</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><!-- docsearch --><script src="../../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><link href="../../extra.css" rel="stylesheet">
<meta property="og:title" content="ggcoefstats">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">ggstatsplot</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.2.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/additional.html">additional vignettes</a>
    </li>
    <li>
      <a href="../../articles/tests_and_coverage.html">Tests and Coverage</a>
    </li>
    <li>
      <a href="../../articles/web_only/combine_plots.html">combine_plots</a>
    </li>
    <li>
      <a href="../../articles/web_only/effsize_interpretation.html">effect size interpretation</a>
    </li>
    <li>
      <a href="../../articles/web_only/faq.html">Frequently asked questions</a>
    </li>
    <li>
      <a href="../../articles/web_only/gallery.html">Gallery of ggstatsplot examples</a>
    </li>
    <li>
      <a href="../../articles/web_only/ggbetweenstats.html">ggbetweenstats</a>
    </li>
    <li>
      <a href="../../articles/web_only/ggcoefstats.html">ggcoefstats</a>
    </li>
    <li>
      <a href="../../articles/web_only/ggcorrmat.html">ggcorrmat</a>
    </li>
    <li>
      <a href="../../articles/web_only/ggdotplotstats.html">ggdotplotstats</a>
    </li>
    <li>
      <a href="../../articles/web_only/gghistostats.html">gghistostats</a>
    </li>
    <li>
      <a href="../../articles/web_only/ggpiestats.html">ggpiestats</a>
    </li>
    <li>
      <a href="../../articles/web_only/ggscatterstats.html">ggscatterstats</a>
    </li>
    <li>
      <a href="../../articles/web_only/ggwithinstats.html">ggwithinstats</a>
    </li>
    <li>
      <a href="../../articles/web_only/other_resources.html">other resources to learn about `ggstatsplot`</a>
    </li>
    <li>
      <a href="../../articles/web_only/purrr_examples.html">using `ggstatsplot` with the `purrr` package</a>
    </li>
    <li>
      <a href="../../articles/web_only/session_info.html">session information</a>
    </li>
    <li>
      <a href="../../articles/web_only/theme_ggstatsplot.html">ggstatsplot theme</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/IndrajeetPatil/ggstatsplot">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="ggcoefstats_files/header-attrs-2.1/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>ggcoefstats</h1>
                        <h4 class="author">Indrajeet Patil</h4>
            
            <h4 class="date">2020-02-04</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/IndrajeetPatil/ggstatsplot/blob/master/vignettes/web_only/ggcoefstats.Rmd"><code>vignettes/web_only/ggcoefstats.Rmd</code></a></small>
      <div class="hidden name"><code>ggcoefstats.Rmd</code></div>

    </div>

    
    
<p>The function <code><a href="../../reference/ggcoefstats.html">ggstatsplot::ggcoefstats</a></code> generates <strong>dot-and-whisker plots</strong> for regression models saved in a tidy data frame (produced with the <code>broom</code> package and its mixed-effects modeling variant <code>broom.mixed</code> package).</p>
<p>By default, the plot displays <code>95%</code> confidence intervals for the regression coefficients. The function currently supports only those classes of object that are supported by the <code>broom</code> package. For an exhaustive list, see- <a href="https://broom.tidyverse.org/articles/available-methods.html" class="uri">https://broom.tidyverse.org/articles/available-methods.html</a></p>
<p>In this vignette, we will see examples of how to use this function. We will try to cover as many classes of objects as possible. Unfortunately, there is no single dataset that will be helpful for carrying out all types of regression analyses and, therefore, we will use various datasets to explore data-specific hypotheses using regression models.</p>
<p><strong>Note before</strong>: The following demo uses the pipe operator (<code><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></code>), so in case you are not familiar with this operator, here is a good explanation: <a href="http://r4ds.had.co.nz/pipes.html" class="uri">http://r4ds.had.co.nz/pipes.html</a></p>
<div id="general-structure-of-the-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#general-structure-of-the-plots" class="anchor"></a>General structure of the plots</h2>
<p>Although the statistical models displayed in the plot may differ based on the class of models being investigated, there are few aspects of the plot that will be invariant across models:</p>
<ul>
<li><p>The dot-whisker plot contains a dot representing the <strong>estimate</strong> and their <strong>confidence intervals</strong> (<code>95%</code> is the default). The estimate can either be effect sizes (for tests that depend on the <code>F</code> statistic) or regression coefficients (for tests with <code>t</code> and <code>z</code> statistic), etc. The function will, by default, display a helpful <code>x</code>-axis label that should clear up what estimates are being displayed. The confidence intervals can sometimes be asymmetric if bootstrapping was used.</p></li>
<li><p>The caption will always contain diagnostic information, if available, about models that can be useful for model selection: The smaller the Akaike’s Information Criterion (<strong>AIC</strong>) and the Bayesian Information Criterion (<strong>BIC</strong>) values, the “better” the model is. Additionally, the higher the <strong>log-likelihood</strong> value the “better” is the model fit.</p></li>
<li><p>The output of this function will be a <code>ggplot2</code> object and, thus, it can be further modified (e.g., change themes, etc.) with <code>ggplot2</code> functions.</p></li>
</ul>
<p>Most of the regression models that are supported in the <code>broom</code> and <code>broom.mixed</code> packages with <code>tidy</code> and <code>glance</code> methods are also supported by <code>ggcoefstats</code>. For example-</p>
<p><code>aareg</code>, <code>anova</code>, <code>aov</code>, <code>aovlist</code>, <code>Arima</code>, <code>bglmerMod</code>, <code>bigglm</code>, <code>biglm</code>, <code>blavaan</code>, <code>bmlm</code>, <code>blmerMod</code>, <code>bracl</code>, <code>brglm2</code>, <code>brmsfit</code>, <code>btergm</code>, <code>cch</code>, <code>cgam</code>, <code>cgamm</code>, <code>cglm</code>, <code>clm</code>, <code>clmm</code>, <code>coeftest</code>, <code>confusionMatrix</code>, <code>coxme</code>, <code>coxph</code>, <code>cpglm</code>, <code>cpglmm</code>, <code>complmrob</code>, <code>DirichReg</code>, <code>drc</code>, <code>emmGrid</code>, <code>epi.2by2</code>, <code>ergm</code>, <code>feis</code>, <code>felm</code>, <code>fitdistr</code>, <code>flexsurvreg</code>, <code>glmc</code>, <code>glmerMod</code>, <code>glmmTMB</code>, <code>gls</code>, <code>gam</code>, <code>Gam</code>, <code>gamlss</code>, <code>garch</code>, <code>glm</code>, <code>glmmadmb</code>, <code>glmmPQL</code>, <code>glmRob</code>, <code>glmrob</code>, <code>glmx</code>, <code>gmm</code>, <code>hurdle</code>, <code>ivreg</code>, <code>iv_robust</code>, <code>lavaan</code>, <code>lm</code>, <code>lm.beta</code>, <code>lmerMod</code>, <code>lmodel2</code>, <code>lmRob</code>, <code>lmrob</code>, <code>mcmc</code>, <code>MCMCglmm</code>, <code>mclogit</code>, <code>mmclogit</code>, <code>mediate</code>, <code>mixor</code>, <code>mjoint</code>, <code>mle2</code>, <code>mlm</code>, <code>multinom</code>, <code>negbin</code>, <code>nlmerMod</code>, <code>nlrq</code>, <code>nlreg</code>, <code>nls</code>, <code>orcutt</code>, <code>plm</code>, <code>polr</code>, <code>ridgelm</code>, <code>rjags</code>, <code>rlm</code>, <code>rlmerMod</code>, <code>rq</code>, <code>rqss</code>, <code>slm</code>, <code>speedglm</code>, <code>speedlm</code>, <code>stanfit</code>, <code>stanreg</code>, <code>survreg</code>, <code>svyglm</code>, <code>svyolr</code>, <code>svyglm</code>, <code>tobit</code>, <code>truncreg</code>, <code>vgam</code>, <code>wbgee</code>, <code>wblm</code>, etc.</p>
<p>In the following examples, we will try out a number of regression models and, additionally, we will also see how we can change different aspects of the plot itself.</p>
</div>
<div id="omnibus-anova-aov" class="section level2">
<h2 class="hasAnchor">
<a href="#omnibus-anova-aov" class="anchor"></a>omnibus ANOVA (<code>aov</code>)</h2>
<p>For this analysis, let’s use the <code>movies_long</code> dataset, which provides information about IMDB ratings, budget, length, MPAA ratings (R-rated, PG, or PG-13), and genre for a number of movies. Let’s say our hypothesis is that the IMDB ratings for a movie are predicted by a multiplicative effect of the genre and the MPAA rating it got. Let’s carry out an omnibus ANOVA to see if this is the case.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># loading needed libraries</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggstatsplot)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co"># for reproducibility</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co"># to speed up the calculation, let's use only 10% of the data</span></span>
<span id="cb1-9"><a href="#cb1-9"></a>movies_<span class="dv">10</span> &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/sample.html">sample_frac</a></span>(<span class="dt">tbl =</span> ggstatsplot<span class="op">::</span>movies_long, <span class="dt">size =</span> <span class="fl">0.1</span>)</span>
<span id="cb1-10"><a href="#cb1-10"></a></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co"># plot</span></span>
<span id="cb1-12"><a href="#cb1-12"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb1-13"><a href="#cb1-13"></a>  <span class="dt">x =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span>(</span>
<span id="cb1-14"><a href="#cb1-14"></a>    <span class="dt">formula =</span> rating <span class="op">~</span><span class="st"> </span>mpaa <span class="op">*</span><span class="st"> </span>genre,</span>
<span id="cb1-15"><a href="#cb1-15"></a>    <span class="dt">data =</span> movies_<span class="dv">10</span></span>
<span id="cb1-16"><a href="#cb1-16"></a>  ),</span>
<span id="cb1-17"><a href="#cb1-17"></a>  <span class="dt">effsize =</span> <span class="st">"eta"</span>, <span class="co"># changing the effect size estimate being displayed</span></span>
<span id="cb1-18"><a href="#cb1-18"></a>  <span class="dt">partial =</span> <span class="ot">FALSE</span>, <span class="co"># just eta-squared</span></span>
<span id="cb1-19"><a href="#cb1-19"></a>  <span class="dt">point.color =</span> <span class="st">"red"</span>, <span class="co"># changing the point color</span></span>
<span id="cb1-20"><a href="#cb1-20"></a>  <span class="dt">point.size =</span> <span class="dv">4</span>, <span class="co"># changing the point size</span></span>
<span id="cb1-21"><a href="#cb1-21"></a>  <span class="dt">point.shape =</span> <span class="dv">15</span>, <span class="co"># changing the point shape</span></span>
<span id="cb1-22"><a href="#cb1-22"></a>  <span class="dt">package =</span> <span class="st">"dutchmasters"</span>, <span class="co"># package from which color paletter is to be taken</span></span>
<span id="cb1-23"><a href="#cb1-23"></a>  <span class="dt">palette =</span> <span class="st">"milkmaid"</span>, <span class="co"># color palette for labels</span></span>
<span id="cb1-24"><a href="#cb1-24"></a>  <span class="dt">title =</span> <span class="st">"omnibus ANOVA"</span> <span class="co"># title for the plot</span></span>
<span id="cb1-25"><a href="#cb1-25"></a>) <span class="op">+</span></span>
<span id="cb1-26"><a href="#cb1-26"></a><span class="st">  </span><span class="co"># further modification with the ggplot2 commands</span></span>
<span id="cb1-27"><a href="#cb1-27"></a><span class="st">  </span><span class="co"># note the order in which the labels are entered</span></span>
<span id="cb1-28"><a href="#cb1-28"></a><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_y_discrete</a></span>(<span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"MPAA"</span>, <span class="st">"Genre"</span>, <span class="st">"Interaction term"</span>)) <span class="op">+</span></span>
<span id="cb1-29"><a href="#cb1-29"></a><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(</span>
<span id="cb1-30"><a href="#cb1-30"></a>    <span class="dt">x =</span> <span class="st">"effect size estimate (partial omega-squared)"</span>,</span>
<span id="cb1-31"><a href="#cb1-31"></a>    <span class="dt">y =</span> <span class="ot">NULL</span></span>
<span id="cb1-32"><a href="#cb1-32"></a>  )</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/aov1-1.png" width="768"></p>
<p>As this plot shows, there is no interaction effect between these two factors.</p>
<p>Note that we can also use this function for model selection. You can try out different models with the code below and see how the AIC, BIC, and log-likelihood values change. Looking at the model diagnostics, you should be able to see that the model with only <code>genre</code> as the predictor of ratings seems to perform almost equally well as more complicated additive and multiplicative models. Although there is certainly some improvement with additive and multiplicative models, it is by no means convincing enough for us to abandon a simpler model.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggstatsplot)</span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co"># to speed up the calculation, let's use only 10% of the data</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>movies_<span class="dv">10</span> &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/sample.html">sample_frac</a></span>(<span class="dt">tbl =</span> ggstatsplot<span class="op">::</span>movies_long, <span class="dt">size =</span> <span class="fl">0.1</span>)</span>
<span id="cb2-5"><a href="#cb2-5"></a></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co"># for reproducibility</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb2-8"><a href="#cb2-8"></a></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co"># plot</span></span>
<span id="cb2-10"><a href="#cb2-10"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/combine_plots.html">combine_plots</a></span>(</span>
<span id="cb2-11"><a href="#cb2-11"></a>  <span class="co"># model 1</span></span>
<span id="cb2-12"><a href="#cb2-12"></a>  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb2-13"><a href="#cb2-13"></a>    <span class="dt">x =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span>(</span>
<span id="cb2-14"><a href="#cb2-14"></a>      <span class="dt">formula =</span> rating <span class="op">~</span><span class="st"> </span>mpaa,</span>
<span id="cb2-15"><a href="#cb2-15"></a>      <span class="dt">data =</span> movies_<span class="dv">10</span></span>
<span id="cb2-16"><a href="#cb2-16"></a>    ),</span>
<span id="cb2-17"><a href="#cb2-17"></a>    <span class="dt">stats.label.color =</span> <span class="st">"black"</span>,</span>
<span id="cb2-18"><a href="#cb2-18"></a>    <span class="dt">title =</span> <span class="st">"1. Only MPAA ratings"</span></span>
<span id="cb2-19"><a href="#cb2-19"></a>  ), <span class="co"># model 2</span></span>
<span id="cb2-20"><a href="#cb2-20"></a>  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb2-21"><a href="#cb2-21"></a>    <span class="dt">x =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span>(</span>
<span id="cb2-22"><a href="#cb2-22"></a>      <span class="dt">formula =</span> rating <span class="op">~</span><span class="st"> </span>genre,</span>
<span id="cb2-23"><a href="#cb2-23"></a>      <span class="dt">data =</span> movies_<span class="dv">10</span></span>
<span id="cb2-24"><a href="#cb2-24"></a>    ),</span>
<span id="cb2-25"><a href="#cb2-25"></a>    <span class="dt">stats.label.color =</span> <span class="st">"black"</span>,</span>
<span id="cb2-26"><a href="#cb2-26"></a>    <span class="dt">title =</span> <span class="st">"2. Only genre"</span></span>
<span id="cb2-27"><a href="#cb2-27"></a>  ), <span class="co"># model 3</span></span>
<span id="cb2-28"><a href="#cb2-28"></a>  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb2-29"><a href="#cb2-29"></a>    <span class="dt">x =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span>(</span>
<span id="cb2-30"><a href="#cb2-30"></a>      <span class="dt">formula =</span> rating <span class="op">~</span><span class="st"> </span>mpaa <span class="op">+</span><span class="st"> </span>genre,</span>
<span id="cb2-31"><a href="#cb2-31"></a>      <span class="dt">data =</span> movies_<span class="dv">10</span></span>
<span id="cb2-32"><a href="#cb2-32"></a>    ),</span>
<span id="cb2-33"><a href="#cb2-33"></a>    <span class="dt">stats.label.color =</span> <span class="st">"black"</span>,</span>
<span id="cb2-34"><a href="#cb2-34"></a>    <span class="dt">title =</span> <span class="st">"3. Additive effect of MPAA and genre"</span></span>
<span id="cb2-35"><a href="#cb2-35"></a>  ), <span class="co"># model 4</span></span>
<span id="cb2-36"><a href="#cb2-36"></a>  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb2-37"><a href="#cb2-37"></a>    <span class="dt">x =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span>(</span>
<span id="cb2-38"><a href="#cb2-38"></a>      <span class="dt">formula =</span> rating <span class="op">~</span><span class="st"> </span>mpaa <span class="op">*</span><span class="st"> </span>genre,</span>
<span id="cb2-39"><a href="#cb2-39"></a>      <span class="dt">data =</span> movies_<span class="dv">10</span></span>
<span id="cb2-40"><a href="#cb2-40"></a>    ),</span>
<span id="cb2-41"><a href="#cb2-41"></a>    <span class="dt">stats.label.color =</span> <span class="st">"black"</span>,</span>
<span id="cb2-42"><a href="#cb2-42"></a>    <span class="dt">title =</span> <span class="st">"4. Multiplicative effect of MPAA and genre"</span></span>
<span id="cb2-43"><a href="#cb2-43"></a>  ),</span>
<span id="cb2-44"><a href="#cb2-44"></a>  <span class="dt">title.text =</span> <span class="st">"Model selection using ggcoefstats"</span>,</span>
<span id="cb2-45"><a href="#cb2-45"></a>  <span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"(a)"</span>, <span class="st">"(b)"</span>, <span class="st">"(c)"</span>, <span class="st">"(d)"</span>)</span>
<span id="cb2-46"><a href="#cb2-46"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/aov2-1.png" width="960"></p>
</div>
<div id="linear-model-lm" class="section level2">
<h2 class="hasAnchor">
<a href="#linear-model-lm" class="anchor"></a>linear model (<code>lm</code>)</h2>
<p>Now that we have figured out that the movie’s <code>genre</code> explains a fair amount of the variation in how people rate the movie on IMDB, let’s run a linear regression model to see how different types of genres compare with each other using <strong>Action</strong> movies as our comparison point.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># plot</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="dt">x =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(</span>
<span id="cb3-4"><a href="#cb3-4"></a>    <span class="dt">formula =</span> rating <span class="op">~</span><span class="st"> </span>genre,</span>
<span id="cb3-5"><a href="#cb3-5"></a>    <span class="dt">data =</span> dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(</span>
<span id="cb3-6"><a href="#cb3-6"></a>      <span class="dt">.data =</span> ggstatsplot<span class="op">::</span>movies_long,</span>
<span id="cb3-7"><a href="#cb3-7"></a>      genre <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(</span>
<span id="cb3-8"><a href="#cb3-8"></a>        <span class="st">"Action"</span>,</span>
<span id="cb3-9"><a href="#cb3-9"></a>        <span class="st">"Action Comedy"</span>,</span>
<span id="cb3-10"><a href="#cb3-10"></a>        <span class="st">"Action Drama"</span>,</span>
<span id="cb3-11"><a href="#cb3-11"></a>        <span class="st">"Comedy"</span>,</span>
<span id="cb3-12"><a href="#cb3-12"></a>        <span class="st">"Drama"</span>,</span>
<span id="cb3-13"><a href="#cb3-13"></a>        <span class="st">"Comedy Drama"</span></span>
<span id="cb3-14"><a href="#cb3-14"></a>      )</span>
<span id="cb3-15"><a href="#cb3-15"></a>    )</span>
<span id="cb3-16"><a href="#cb3-16"></a>  ),</span>
<span id="cb3-17"><a href="#cb3-17"></a>  <span class="dt">conf.level =</span> <span class="fl">0.99</span>, <span class="co"># changing the confidence levels for confidence intervals</span></span>
<span id="cb3-18"><a href="#cb3-18"></a>  <span class="dt">sort =</span> <span class="st">"ascending"</span>, <span class="co"># sorting the terms of the model based on estimate values</span></span>
<span id="cb3-19"><a href="#cb3-19"></a>  <span class="dt">label.direction =</span> <span class="st">"both"</span>, <span class="co"># direction in which to adjust position of labels (both x and y)</span></span>
<span id="cb3-20"><a href="#cb3-20"></a>  <span class="dt">ggtheme =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_gray</a></span>(), <span class="co"># changing the default theme</span></span>
<span id="cb3-21"><a href="#cb3-21"></a>  <span class="dt">stats.label.color =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"#CC79A7"</span>, <span class="st">"darkgreen"</span>, <span class="st">"#0072B2"</span>, <span class="st">"black"</span>, <span class="st">"red"</span>),</span>
<span id="cb3-22"><a href="#cb3-22"></a>  <span class="dt">title =</span> <span class="st">"Movie ratings by their genre"</span>,</span>
<span id="cb3-23"><a href="#cb3-23"></a>  <span class="dt">subtitle =</span> <span class="st">"Source: www.imdb.com"</span></span>
<span id="cb3-24"><a href="#cb3-24"></a>) <span class="op">+</span></span>
<span id="cb3-25"><a href="#cb3-25"></a><span class="st">  </span><span class="co"># further modification with the ggplot2 commands</span></span>
<span id="cb3-26"><a href="#cb3-26"></a><span class="st">  </span><span class="co"># note the order in which the labels are entered</span></span>
<span id="cb3-27"><a href="#cb3-27"></a><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_y_discrete</a></span>(<span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Comedy"</span>, <span class="st">"Action Comedy"</span>, <span class="st">"Action Drama"</span>, <span class="st">"Comedy Drama"</span>, <span class="st">"Drama"</span>)) <span class="op">+</span></span>
<span id="cb3-28"><a href="#cb3-28"></a><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">y =</span> <span class="st">"Genre compared to Action movies)"</span>) <span class="op">+</span></span>
<span id="cb3-29"><a href="#cb3-29"></a><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">axis.title.y =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">face =</span> <span class="st">"bold"</span>))</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/lm-1.png" width="768"></p>
<p>As can be seen from the regression coefficients, compared to action movies, comedies and action comedies are not rated significantly better. All three of the “drama” types (pure, action or comedy dramas) have statistical significantly higher regression coefficients. This finding occurs even with our more conservative <code>0.99</code> confidence interval.</p>
</div>
<div id="linear-mixed-effects-model-lmerlmermod" class="section level2">
<h2 class="hasAnchor">
<a href="#linear-mixed-effects-model-lmerlmermod" class="anchor"></a>linear mixed-effects model (<code>lmer</code>/<code>lmerMod</code>)</h2>
<p>Now let’s say we want to see how movie’s budget relates to how good the movie is rated to be on IMDB (e.g., more money, better ratings?). But we have reasons to believe that the relationship between these two variables might be different for different genres (e.g., budget might be a good predictor of how good the movie is rated to be for animations or actions movies as more money can help with better visual effects and animations, but this may not be true for dramas, so we don’t want to use <code><a href="https://rdrr.io/r/stats/lm.html">stats::lm</a></code>. In this case, therefore, we will be running a linear mixed-effects model (using <code><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lme4::lmer</a></code> and <em>p</em>-values generated using the <code>sjstats::p_values</code> function) with a random slope for the genre variable.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># set up</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(lme4)</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggstatsplot)</span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co"># to speed up the calculation, let's use only 10% of the data</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>movies_<span class="dv">10</span> &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/sample.html">sample_frac</a></span>(<span class="dt">tbl =</span> ggstatsplot<span class="op">::</span>movies_long, <span class="dt">size =</span> <span class="fl">0.1</span>)</span>
<span id="cb4-8"><a href="#cb4-8"></a></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="co"># combining the two different plots</span></span>
<span id="cb4-10"><a href="#cb4-10"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/combine_plots.html">combine_plots</a></span>(</span>
<span id="cb4-11"><a href="#cb4-11"></a>  <span class="co"># model 1: simple linear model</span></span>
<span id="cb4-12"><a href="#cb4-12"></a>  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb4-13"><a href="#cb4-13"></a>    <span class="dt">x =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(</span>
<span id="cb4-14"><a href="#cb4-14"></a>      <span class="dt">formula =</span> <span class="kw"><a href="https://rdrr.io/r/base/scale.html">scale</a></span>(rating) <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/scale.html">scale</a></span>(budget),</span>
<span id="cb4-15"><a href="#cb4-15"></a>      <span class="dt">data =</span> movies_<span class="dv">10</span></span>
<span id="cb4-16"><a href="#cb4-16"></a>    ),</span>
<span id="cb4-17"><a href="#cb4-17"></a>    <span class="dt">title =</span> <span class="st">"linear model"</span>,</span>
<span id="cb4-18"><a href="#cb4-18"></a>    <span class="dt">stats.label.color =</span> <span class="st">"black"</span>,</span>
<span id="cb4-19"><a href="#cb4-19"></a>    <span class="dt">exclude.intercept =</span> <span class="ot">FALSE</span> <span class="co"># show the intercept</span></span>
<span id="cb4-20"><a href="#cb4-20"></a>  ) <span class="op">+</span></span>
<span id="cb4-21"><a href="#cb4-21"></a><span class="st">    </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/parse.html">parse</a></span>(<span class="dt">text =</span> <span class="st">"'standardized regression coefficient' ~italic(beta)"</span>)),</span>
<span id="cb4-22"><a href="#cb4-22"></a>  <span class="co"># model 2: linear mixed-effects model</span></span>
<span id="cb4-23"><a href="#cb4-23"></a>  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb4-24"><a href="#cb4-24"></a>    <span class="dt">x =</span> lme4<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span>(</span>
<span id="cb4-25"><a href="#cb4-25"></a>      <span class="dt">formula =</span> <span class="kw"><a href="https://rdrr.io/r/base/scale.html">scale</a></span>(rating) <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/scale.html">scale</a></span>(budget) <span class="op">+</span><span class="st"> </span>(budget <span class="op">|</span><span class="st"> </span>genre),</span>
<span id="cb4-26"><a href="#cb4-26"></a>      <span class="dt">data =</span> movies_<span class="dv">10</span>,</span>
<span id="cb4-27"><a href="#cb4-27"></a>      <span class="dt">control =</span> lme4<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html">lmerControl</a></span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>)</span>
<span id="cb4-28"><a href="#cb4-28"></a>    ),</span>
<span id="cb4-29"><a href="#cb4-29"></a>    <span class="dt">title =</span> <span class="st">"linear mixed-effects model"</span>,</span>
<span id="cb4-30"><a href="#cb4-30"></a>    <span class="dt">stats.label.color =</span> <span class="st">"black"</span>,</span>
<span id="cb4-31"><a href="#cb4-31"></a>    <span class="dt">exclude.intercept =</span> <span class="ot">FALSE</span></span>
<span id="cb4-32"><a href="#cb4-32"></a>  ) <span class="op">+</span></span>
<span id="cb4-33"><a href="#cb4-33"></a><span class="st">    </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(</span>
<span id="cb4-34"><a href="#cb4-34"></a>      <span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/parse.html">parse</a></span>(<span class="dt">text =</span> <span class="st">"'standardized regression coefficient' ~italic(beta)"</span>),</span>
<span id="cb4-35"><a href="#cb4-35"></a>      <span class="dt">y =</span> <span class="st">"fixed effects"</span></span>
<span id="cb4-36"><a href="#cb4-36"></a>    ),</span>
<span id="cb4-37"><a href="#cb4-37"></a>  <span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"(a)"</span>, <span class="st">"(b)"</span>),</span>
<span id="cb4-38"><a href="#cb4-38"></a>  <span class="dt">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb4-39"><a href="#cb4-39"></a>  <span class="dt">ncol =</span> <span class="dv">1</span>,</span>
<span id="cb4-40"><a href="#cb4-40"></a>  <span class="dt">title.text =</span> <span class="st">"Relationship between movie budget and its IMDB rating"</span></span>
<span id="cb4-41"><a href="#cb4-41"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/lmer1-1.png" width="672"></p>
<p>As can be seen from these plots, although there seems to be a really small correlation between budget and rating in a linear model, this effect is not significant once we take into account the hierarchical structure of the data.</p>
<p>Note that for mixed-effects models, only the <em>fixed</em> effects are shown because there are no confidence intervals for <em>random</em> effects terms. In case, you would like to see these terms, you can enter the same object you entered as <code>x</code> argument to <code>ggcoefstats</code> in <code><a href="http://broom.tidyverse.org/reference/reexports.html">broom::tidy</a></code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co"># to speed up the calculation, let's use only 10% of the data</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>movies_<span class="dv">10</span> &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/sample.html">sample_frac</a></span>(<span class="dt">tbl =</span> ggstatsplot<span class="op">::</span>movies_long, <span class="dt">size =</span> <span class="fl">0.1</span>)</span>
<span id="cb5-5"><a href="#cb5-5"></a></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co"># tidy output</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>broom.mixed<span class="op">::</span><span class="kw">tidy</span>(</span>
<span id="cb5-8"><a href="#cb5-8"></a>  <span class="dt">x =</span> lme4<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span>(</span>
<span id="cb5-9"><a href="#cb5-9"></a>    <span class="dt">formula =</span> <span class="kw"><a href="https://rdrr.io/r/base/scale.html">scale</a></span>(rating) <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/scale.html">scale</a></span>(budget) <span class="op">+</span><span class="st"> </span>(budget <span class="op">|</span><span class="st"> </span>genre),</span>
<span id="cb5-10"><a href="#cb5-10"></a>    <span class="dt">data =</span> movies_<span class="dv">10</span>,</span>
<span id="cb5-11"><a href="#cb5-11"></a>    <span class="dt">control =</span> lme4<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html">lmerControl</a></span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>)</span>
<span id="cb5-12"><a href="#cb5-12"></a>  ),</span>
<span id="cb5-13"><a href="#cb5-13"></a>  <span class="dt">conf.int =</span> <span class="ot">TRUE</span>,</span>
<span id="cb5-14"><a href="#cb5-14"></a>  <span class="dt">conf.level =</span> <span class="fl">0.95</span></span>
<span id="cb5-15"><a href="#cb5-15"></a>)</span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="co">#&gt; # A tibble: 6 x 8</span></span>
<span id="cb5-17"><a href="#cb5-17"></a><span class="co">#&gt;   effect  group   term           estimate std.error statistic conf.low conf.high</span></span>
<span id="cb5-18"><a href="#cb5-18"></a><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb5-19"><a href="#cb5-19"></a><span class="co">#&gt; 1 fixed   &lt;NA&gt;    (Intercept)    -4.98e-2    0.147     -0.339   -0.338     0.238</span></span>
<span id="cb5-20"><a href="#cb5-20"></a><span class="co">#&gt; 2 fixed   &lt;NA&gt;    scale(budget)   4.28e-2    0.0806     0.531   -0.115     0.201</span></span>
<span id="cb5-21"><a href="#cb5-21"></a><span class="co">#&gt; 3 ran_pa~ genre   sd__(Intercep~  3.87e-1   NA         NA       NA        NA    </span></span>
<span id="cb5-22"><a href="#cb5-22"></a><span class="co">#&gt; 4 ran_pa~ genre   cor__(Interce~ -1.00e+0   NA         NA       NA        NA    </span></span>
<span id="cb5-23"><a href="#cb5-23"></a><span class="co">#&gt; 5 ran_pa~ genre   sd__budget      8.43e-4   NA         NA       NA        NA    </span></span>
<span id="cb5-24"><a href="#cb5-24"></a><span class="co">#&gt; 6 ran_pa~ Residu~ sd__Observati~  9.49e-1   NA         NA       NA        NA</span></span></code></pre></div>
</div>
<div id="robust-linear-mixed-effects-models-rlmer" class="section level2">
<h2 class="hasAnchor">
<a href="#robust-linear-mixed-effects-models-rlmer" class="anchor"></a>robust linear mixed-effects models (<code>rlmer</code>)</h2>
<p>Robust version of <code>lmer</code> (as implemented in <code>robustlmm</code> package) is also supported-</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(robustlmm)</span>
<span id="cb6-3"><a href="#cb6-3"></a></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co"># model</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>roblmm.mod &lt;-</span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="st">  </span>robustlmm<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/robustlmm/man/rlmer.html">rlmer</a></span>(</span>
<span id="cb6-7"><a href="#cb6-7"></a>    <span class="dt">formula =</span> <span class="kw"><a href="https://rdrr.io/r/base/scale.html">scale</a></span>(Reaction) <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/scale.html">scale</a></span>(Days) <span class="op">+</span><span class="st"> </span>(Days <span class="op">|</span><span class="st"> </span>Subject),</span>
<span id="cb6-8"><a href="#cb6-8"></a>    <span class="dt">data =</span> sleepstudy,</span>
<span id="cb6-9"><a href="#cb6-9"></a>    <span class="dt">rho.sigma.e =</span> <span class="kw">psi2propII</span>(smoothPsi, <span class="dt">k =</span> <span class="fl">2.28</span>),</span>
<span id="cb6-10"><a href="#cb6-10"></a>    <span class="dt">rho.sigma.b =</span> <span class="kw">chgDefaults</span>(smoothPsi, <span class="dt">k =</span> <span class="fl">5.11</span>, <span class="dt">s =</span> <span class="dv">10</span>)</span>
<span id="cb6-11"><a href="#cb6-11"></a>  )</span>
<span id="cb6-12"><a href="#cb6-12"></a></span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="co"># plot</span></span>
<span id="cb6-14"><a href="#cb6-14"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb6-15"><a href="#cb6-15"></a>  <span class="dt">x =</span> roblmm.mod,</span>
<span id="cb6-16"><a href="#cb6-16"></a>  <span class="dt">title =</span> <span class="st">"robust estimation of linear mixed-effects model"</span>,</span>
<span id="cb6-17"><a href="#cb6-17"></a>  <span class="dt">conf.level =</span> <span class="fl">0.90</span></span>
<span id="cb6-18"><a href="#cb6-18"></a>)</span>
<span id="cb6-19"><a href="#cb6-19"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/rlmer-1.png" width="700"></p>
</div>
<div id="non-linear-mixed-effects-model-nlmernlmermod" class="section level2">
<h2 class="hasAnchor">
<a href="#non-linear-mixed-effects-model-nlmernlmermod" class="anchor"></a>non-linear mixed-effects model (<code>nlmer</code>/<code>nlmerMod</code>)</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># data</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(lme4)</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb7-4"><a href="#cb7-4"></a>startvec &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">Asym =</span> <span class="dv">200</span>, <span class="dt">xmid =</span> <span class="dv">725</span>, <span class="dt">scal =</span> <span class="dv">350</span>)</span>
<span id="cb7-5"><a href="#cb7-5"></a></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co"># model</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>nm1 &lt;-</span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="st">  </span>lme4<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/lme4/man/nlmer.html">nlmer</a></span>(</span>
<span id="cb7-9"><a href="#cb7-9"></a>    <span class="dt">formula =</span> circumference <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/SSlogis.html">SSlogis</a></span>(age, Asym, xmid, scal) <span class="op">~</span><span class="st"> </span>Asym <span class="op">|</span><span class="st"> </span>Tree,</span>
<span id="cb7-10"><a href="#cb7-10"></a>    <span class="dt">data =</span> Orange,</span>
<span id="cb7-11"><a href="#cb7-11"></a>    <span class="dt">start =</span> startvec</span>
<span id="cb7-12"><a href="#cb7-12"></a>  )</span>
<span id="cb7-13"><a href="#cb7-13"></a></span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="co"># plot</span></span>
<span id="cb7-15"><a href="#cb7-15"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb7-16"><a href="#cb7-16"></a>  <span class="dt">x =</span> nm1,</span>
<span id="cb7-17"><a href="#cb7-17"></a>  <span class="dt">title =</span> <span class="st">"non-linear mixed-effects model"</span></span>
<span id="cb7-18"><a href="#cb7-18"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/nlmer-1.png" width="576"></p>
</div>
<div id="non-linear-least-squares-model-nls" class="section level2">
<h2 class="hasAnchor">
<a href="#non-linear-least-squares-model-nls" class="anchor"></a>non-linear least-squares model (<code>nls</code>)</h2>
<p>So far we have been assuming a linear relationship between movie budget and rating. But what if we want to also explore the possibility of a non-linear relationship? In that case, we can run a non-linear least squares regression. Note that you need to choose some non-linear function, which will be based on prior exploratory data analysis (<code>y ~ k/x + c</code> implemented here, but you can try out other non-linear functions, e.g. <code>Y ~ k * exp(-b*c)</code>).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggstatsplot)</span>
<span id="cb8-2"><a href="#cb8-2"></a></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co"># to speed up the calculation, let's use only 10% of the data</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>movies_<span class="dv">10</span> &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/sample.html">sample_frac</a></span>(<span class="dt">tbl =</span> ggstatsplot<span class="op">::</span>movies_long, <span class="dt">size =</span> <span class="fl">0.1</span>)</span>
<span id="cb8-5"><a href="#cb8-5"></a></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co"># model</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>mod &lt;-</span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="st">  </span>stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span>(</span>
<span id="cb8-9"><a href="#cb8-9"></a>    <span class="dt">formula =</span> rating <span class="op">~</span><span class="st"> </span>k <span class="op">/</span><span class="st"> </span>budget <span class="op">+</span><span class="st"> </span>c, <span class="co"># try toying around with the form of non-linear function</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>    <span class="dt">data =</span> movies_<span class="dv">10</span>,</span>
<span id="cb8-11"><a href="#cb8-11"></a>    <span class="dt">start =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">k =</span> <span class="dv">1</span>, <span class="dt">c =</span> <span class="dv">0</span>)</span>
<span id="cb8-12"><a href="#cb8-12"></a>  )</span>
<span id="cb8-13"><a href="#cb8-13"></a></span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="co"># plot</span></span>
<span id="cb8-15"><a href="#cb8-15"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb8-16"><a href="#cb8-16"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb8-17"><a href="#cb8-17"></a>  <span class="dt">title =</span> <span class="st">"non-linear least squares regression"</span>,</span>
<span id="cb8-18"><a href="#cb8-18"></a>  <span class="dt">subtitle =</span> <span class="st">"Non-linear relationship between budget and rating"</span></span>
<span id="cb8-19"><a href="#cb8-19"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/nls-1.png" width="576"></p>
<p>This analysis shows that there is indeed a possible non-linear association between rating and budget (non-linear regression term <code>k</code> is significant), at least with the particular non-linear function we used.</p>
</div>
<div id="stationary-linear-model-slm" class="section level2">
<h2 class="hasAnchor">
<a href="#stationary-linear-model-slm" class="anchor"></a>stationary linear model (<code>slm</code>)</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># setup</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(slm)</span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"shan"</span>)</span>
<span id="cb9-5"><a href="#cb9-5"></a></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co"># model</span></span>
<span id="cb9-7"><a href="#cb9-7"></a>mod &lt;-</span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="st">  </span><span class="kw">slm</span>(</span>
<span id="cb9-9"><a href="#cb9-9"></a>    <span class="dt">myformula =</span> shan<span class="op">$</span>PM_Xuhui <span class="op">~</span><span class="st"> </span>.,</span>
<span id="cb9-10"><a href="#cb9-10"></a>    <span class="dt">data =</span> shan,</span>
<span id="cb9-11"><a href="#cb9-11"></a>    <span class="dt">method_cov_st =</span> <span class="st">"fitAR"</span>,</span>
<span id="cb9-12"><a href="#cb9-12"></a>    <span class="dt">model_selec =</span> <span class="dv">-1</span></span>
<span id="cb9-13"><a href="#cb9-13"></a>  )</span>
<span id="cb9-14"><a href="#cb9-14"></a></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="co"># plot</span></span>
<span id="cb9-16"><a href="#cb9-16"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb9-17"><a href="#cb9-17"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb9-18"><a href="#cb9-18"></a>  <span class="dt">conf.level =</span> <span class="fl">0.90</span>,</span>
<span id="cb9-19"><a href="#cb9-19"></a>  <span class="dt">title =</span> <span class="st">"stationary linear models"</span>,</span>
<span id="cb9-20"><a href="#cb9-20"></a>  <span class="dt">package =</span> <span class="st">"rcartocolor"</span>,</span>
<span id="cb9-21"><a href="#cb9-21"></a>  <span class="dt">palette =</span> <span class="st">"Vivid"</span></span>
<span id="cb9-22"><a href="#cb9-22"></a>)</span>
<span id="cb9-23"><a href="#cb9-23"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/slm-1.png" width="576"></p>
</div>
<div id="generalized-linear-model-glm" class="section level2">
<h2 class="hasAnchor">
<a href="#generalized-linear-model-glm" class="anchor"></a>generalized linear model (<code>glm</code>)</h2>
<p>In all the analyses carried out thus far, the outcome variable (<code>y</code> in <code>y ~ x</code>) has been continuous. In case the outcome variable is nominal/categorical/factor, we can use the <strong>generalized</strong> form of linear model that works even if the response is a numeric vector or a factor vector, etc.</p>
<p>To explore this model, we will use the Titanic dataset, which tabulates information on the fate of passengers on the fatal maiden voyage of the ocean liner <em>Titanic</em>, summarized according to economic status (class), sex, age, and survival. Let’s say we want to know what was the strongest predictor of whether someone survived the Titanic disaster-</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggstatsplot)</span>
<span id="cb10-2"><a href="#cb10-2"></a></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="co"># having a look at the Titanic dataset</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>df &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="dt">x =</span> Titanic)</span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(df)</span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co">#&gt; 'data.frame':    32 obs. of  5 variables:</span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">#&gt;  $ Class   : Factor w/ 4 levels "1st","2nd","3rd",..: 1 2 3 4 1 2 3 4 1 2 ...</span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co">#&gt;  $ Sex     : Factor w/ 2 levels "Male","Female": 1 1 1 1 2 2 2 2 1 1 ...</span></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="co">#&gt;  $ Age     : Factor w/ 2 levels "Child","Adult": 1 1 1 1 1 1 1 1 2 2 ...</span></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co">#&gt;  $ Survived: Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="co">#&gt;  $ Freq    : num  0 0 35 0 0 0 17 0 118 154 ...</span></span>
<span id="cb10-12"><a href="#cb10-12"></a></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="co"># model</span></span>
<span id="cb10-14"><a href="#cb10-14"></a>mod &lt;-</span>
<span id="cb10-15"><a href="#cb10-15"></a><span class="st">  </span>stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span>(</span>
<span id="cb10-16"><a href="#cb10-16"></a>    <span class="dt">formula =</span> Survived <span class="op">~</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Age,</span>
<span id="cb10-17"><a href="#cb10-17"></a>    <span class="dt">data =</span> df,</span>
<span id="cb10-18"><a href="#cb10-18"></a>    <span class="dt">weights =</span> df<span class="op">$</span>Freq,</span>
<span id="cb10-19"><a href="#cb10-19"></a>    <span class="dt">family =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span>(<span class="dt">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb10-20"><a href="#cb10-20"></a>  )</span>
<span id="cb10-21"><a href="#cb10-21"></a></span>
<span id="cb10-22"><a href="#cb10-22"></a><span class="co"># plot</span></span>
<span id="cb10-23"><a href="#cb10-23"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb10-24"><a href="#cb10-24"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb10-25"><a href="#cb10-25"></a>  <span class="dt">exponentiate =</span> <span class="ot">TRUE</span>,</span>
<span id="cb10-26"><a href="#cb10-26"></a>  <span class="dt">ggtheme =</span> ggthemes<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ggthemes/man/theme_economist.html">theme_economist_white</a></span>(),</span>
<span id="cb10-27"><a href="#cb10-27"></a>  <span class="dt">title =</span> <span class="st">"generalized linear model (glm)"</span>,</span>
<span id="cb10-28"><a href="#cb10-28"></a>  <span class="dt">vline.color =</span> <span class="st">"red"</span>,</span>
<span id="cb10-29"><a href="#cb10-29"></a>  <span class="dt">vline.linetype =</span> <span class="st">"solid"</span>,</span>
<span id="cb10-30"><a href="#cb10-30"></a>  <span class="dt">label.segment.color =</span> <span class="st">"red"</span>,</span>
<span id="cb10-31"><a href="#cb10-31"></a>  <span class="dt">stats.label.color =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"orangered"</span>, <span class="st">"dodgerblue"</span>)</span>
<span id="cb10-32"><a href="#cb10-32"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/glm1-1.png" width="576"></p>
<p>As can be seen from the regression coefficients, all entered predictors were significant predictors of the outcome. More specifically, being a female was associated with higher likelihood of survival (compared to male). On other hand, being an adult was associated with decreased likelihood of survival (compared to child).</p>
<p><strong>Note</strong>: Few things to keep in mind for <code>glm</code> models,</p>
<ul>
<li><p>The exact statistic will depend on the family used. Below we will see a host of different function calls to <code>glm</code> with a variety of different families.</p></li>
<li><p>Some families will have a <code>t</code> statistic associated with them, while others a <code>z</code> statistic. The function will figure this out for you.</p></li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># creating dataframes to use for regression analyses</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggstatsplot)</span>
<span id="cb11-3"><a href="#cb11-3"></a></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co"># dataframe #1</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>(</span>
<span id="cb11-6"><a href="#cb11-6"></a>  df.counts &lt;-</span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="st">    </span>base<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(</span>
<span id="cb11-8"><a href="#cb11-8"></a>      <span class="dt">treatment =</span> <span class="kw"><a href="https://rdrr.io/r/base/gl.html">gl</a></span>(<span class="dt">n =</span> <span class="dv">3</span>, <span class="dt">k =</span> <span class="dv">3</span>, <span class="dt">length =</span> <span class="dv">9</span>),</span>
<span id="cb11-9"><a href="#cb11-9"></a>      <span class="dt">outcome =</span> <span class="kw"><a href="https://rdrr.io/r/base/gl.html">gl</a></span>(<span class="dt">n =</span> <span class="dv">3</span>, <span class="dt">k =</span> <span class="dv">1</span>, <span class="dt">length =</span> <span class="dv">9</span>),</span>
<span id="cb11-10"><a href="#cb11-10"></a>      <span class="dt">counts =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">18</span>, <span class="dv">17</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">13</span>, <span class="dv">12</span>)</span>
<span id="cb11-11"><a href="#cb11-11"></a>    ) <span class="op">%&gt;%</span></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="st">    </span>tibble<span class="op">::</span><span class="kw"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span>(<span class="dt">x =</span> .)</span>
<span id="cb11-13"><a href="#cb11-13"></a>)</span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="co">#&gt; # A tibble: 9 x 3</span></span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="co">#&gt;   treatment outcome counts</span></span>
<span id="cb11-16"><a href="#cb11-16"></a><span class="co">#&gt;   &lt;fct&gt;     &lt;fct&gt;    &lt;dbl&gt;</span></span>
<span id="cb11-17"><a href="#cb11-17"></a><span class="co">#&gt; 1 1         1           18</span></span>
<span id="cb11-18"><a href="#cb11-18"></a><span class="co">#&gt; 2 1         2           17</span></span>
<span id="cb11-19"><a href="#cb11-19"></a><span class="co">#&gt; 3 1         3           15</span></span>
<span id="cb11-20"><a href="#cb11-20"></a><span class="co">#&gt; 4 2         1           20</span></span>
<span id="cb11-21"><a href="#cb11-21"></a><span class="co">#&gt; 5 2         2           10</span></span>
<span id="cb11-22"><a href="#cb11-22"></a><span class="co">#&gt; 6 2         3           20</span></span>
<span id="cb11-23"><a href="#cb11-23"></a><span class="co">#&gt; 7 3         1           25</span></span>
<span id="cb11-24"><a href="#cb11-24"></a><span class="co">#&gt; 8 3         2           13</span></span>
<span id="cb11-25"><a href="#cb11-25"></a><span class="co">#&gt; 9 3         3           12</span></span>
<span id="cb11-26"><a href="#cb11-26"></a></span>
<span id="cb11-27"><a href="#cb11-27"></a><span class="co"># dataframe #2</span></span>
<span id="cb11-28"><a href="#cb11-28"></a>(df.clotting &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(</span>
<span id="cb11-29"><a href="#cb11-29"></a>  <span class="dt">u =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">100</span>),</span>
<span id="cb11-30"><a href="#cb11-30"></a>  <span class="dt">lot1 =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">118</span>, <span class="dv">58</span>, <span class="dv">42</span>, <span class="dv">35</span>, <span class="dv">27</span>, <span class="dv">25</span>, <span class="dv">21</span>, <span class="dv">19</span>, <span class="dv">18</span>),</span>
<span id="cb11-31"><a href="#cb11-31"></a>  <span class="dt">lot2 =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">69</span>, <span class="dv">35</span>, <span class="dv">26</span>, <span class="dv">21</span>, <span class="dv">18</span>, <span class="dv">16</span>, <span class="dv">13</span>, <span class="dv">12</span>, <span class="dv">12</span>)</span>
<span id="cb11-32"><a href="#cb11-32"></a>) <span class="op">%&gt;%</span></span>
<span id="cb11-33"><a href="#cb11-33"></a><span class="st">  </span>tibble<span class="op">::</span><span class="kw"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span>(<span class="dt">x =</span> .))</span>
<span id="cb11-34"><a href="#cb11-34"></a><span class="co">#&gt; # A tibble: 9 x 3</span></span>
<span id="cb11-35"><a href="#cb11-35"></a><span class="co">#&gt;       u  lot1  lot2</span></span>
<span id="cb11-36"><a href="#cb11-36"></a><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb11-37"><a href="#cb11-37"></a><span class="co">#&gt; 1     5   118    69</span></span>
<span id="cb11-38"><a href="#cb11-38"></a><span class="co">#&gt; 2    10    58    35</span></span>
<span id="cb11-39"><a href="#cb11-39"></a><span class="co">#&gt; 3    15    42    26</span></span>
<span id="cb11-40"><a href="#cb11-40"></a><span class="co">#&gt; 4    20    35    21</span></span>
<span id="cb11-41"><a href="#cb11-41"></a><span class="co">#&gt; 5    30    27    18</span></span>
<span id="cb11-42"><a href="#cb11-42"></a><span class="co">#&gt; 6    40    25    16</span></span>
<span id="cb11-43"><a href="#cb11-43"></a><span class="co">#&gt; 7    60    21    13</span></span>
<span id="cb11-44"><a href="#cb11-44"></a><span class="co">#&gt; 8    80    19    12</span></span>
<span id="cb11-45"><a href="#cb11-45"></a><span class="co">#&gt; 9   100    18    12</span></span>
<span id="cb11-46"><a href="#cb11-46"></a></span>
<span id="cb11-47"><a href="#cb11-47"></a><span class="co"># dataframe #3</span></span>
<span id="cb11-48"><a href="#cb11-48"></a>x1 &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dv">50</span>)</span>
<span id="cb11-49"><a href="#cb11-49"></a>y1 &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span>(<span class="dt">n =</span> <span class="dv">50</span>, <span class="dt">lambda =</span> <span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x1))</span>
<span id="cb11-50"><a href="#cb11-50"></a>(df<span class="fl">.3</span> &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">x =</span> x1, <span class="dt">y =</span> y1) <span class="op">%&gt;%</span></span>
<span id="cb11-51"><a href="#cb11-51"></a><span class="st">  </span>tibble<span class="op">::</span><span class="kw"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span>(<span class="dt">x =</span> .))</span>
<span id="cb11-52"><a href="#cb11-52"></a><span class="co">#&gt; # A tibble: 50 x 2</span></span>
<span id="cb11-53"><a href="#cb11-53"></a><span class="co">#&gt;         x     y</span></span>
<span id="cb11-54"><a href="#cb11-54"></a><span class="co">#&gt;     &lt;dbl&gt; &lt;int&gt;</span></span>
<span id="cb11-55"><a href="#cb11-55"></a><span class="co">#&gt;  1 -1.03      2</span></span>
<span id="cb11-56"><a href="#cb11-56"></a><span class="co">#&gt;  2 -0.729     0</span></span>
<span id="cb11-57"><a href="#cb11-57"></a><span class="co">#&gt;  3 -0.625     1</span></span>
<span id="cb11-58"><a href="#cb11-58"></a><span class="co">#&gt;  4 -1.69      0</span></span>
<span id="cb11-59"><a href="#cb11-59"></a><span class="co">#&gt;  5  0.838     4</span></span>
<span id="cb11-60"><a href="#cb11-60"></a><span class="co">#&gt;  6  0.153     4</span></span>
<span id="cb11-61"><a href="#cb11-61"></a><span class="co">#&gt;  7 -1.14      2</span></span>
<span id="cb11-62"><a href="#cb11-62"></a><span class="co">#&gt;  8  1.25      9</span></span>
<span id="cb11-63"><a href="#cb11-63"></a><span class="co">#&gt;  9  0.426     3</span></span>
<span id="cb11-64"><a href="#cb11-64"></a><span class="co">#&gt; 10 -0.295     1</span></span>
<span id="cb11-65"><a href="#cb11-65"></a><span class="co">#&gt; # ... with 40 more rows</span></span>
<span id="cb11-66"><a href="#cb11-66"></a></span>
<span id="cb11-67"><a href="#cb11-67"></a><span class="co"># dataframe #4</span></span>
<span id="cb11-68"><a href="#cb11-68"></a>x2 &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dv">50</span>)</span>
<span id="cb11-69"><a href="#cb11-69"></a>y2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(</span>
<span id="cb11-70"><a href="#cb11-70"></a>  <span class="dt">n =</span> <span class="dv">50</span>,</span>
<span id="cb11-71"><a href="#cb11-71"></a>  <span class="dt">size =</span> <span class="dv">1</span>,</span>
<span id="cb11-72"><a href="#cb11-72"></a>  <span class="dt">prob =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/Logistic.html">plogis</a></span>(x2)</span>
<span id="cb11-73"><a href="#cb11-73"></a>)</span>
<span id="cb11-74"><a href="#cb11-74"></a></span>
<span id="cb11-75"><a href="#cb11-75"></a>(df<span class="fl">.4</span> &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">x =</span> x2, <span class="dt">y =</span> y2) <span class="op">%&gt;%</span></span>
<span id="cb11-76"><a href="#cb11-76"></a><span class="st">  </span>tibble<span class="op">::</span><span class="kw"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span>(<span class="dt">x =</span> .))</span>
<span id="cb11-77"><a href="#cb11-77"></a><span class="co">#&gt; # A tibble: 50 x 2</span></span>
<span id="cb11-78"><a href="#cb11-78"></a><span class="co">#&gt;          x     y</span></span>
<span id="cb11-79"><a href="#cb11-79"></a><span class="co">#&gt;      &lt;dbl&gt; &lt;int&gt;</span></span>
<span id="cb11-80"><a href="#cb11-80"></a><span class="co">#&gt;  1 -1.03       0</span></span>
<span id="cb11-81"><a href="#cb11-81"></a><span class="co">#&gt;  2 -0.710      1</span></span>
<span id="cb11-82"><a href="#cb11-82"></a><span class="co">#&gt;  3  0.257      0</span></span>
<span id="cb11-83"><a href="#cb11-83"></a><span class="co">#&gt;  4 -0.247      0</span></span>
<span id="cb11-84"><a href="#cb11-84"></a><span class="co">#&gt;  5 -0.348      1</span></span>
<span id="cb11-85"><a href="#cb11-85"></a><span class="co">#&gt;  6 -0.952      1</span></span>
<span id="cb11-86"><a href="#cb11-86"></a><span class="co">#&gt;  7 -0.0450     1</span></span>
<span id="cb11-87"><a href="#cb11-87"></a><span class="co">#&gt;  8 -0.785      0</span></span>
<span id="cb11-88"><a href="#cb11-88"></a><span class="co">#&gt;  9 -1.67       0</span></span>
<span id="cb11-89"><a href="#cb11-89"></a><span class="co">#&gt; 10 -0.380      0</span></span>
<span id="cb11-90"><a href="#cb11-90"></a><span class="co">#&gt; # ... with 40 more rows</span></span>
<span id="cb11-91"><a href="#cb11-91"></a></span>
<span id="cb11-92"><a href="#cb11-92"></a><span class="co"># combining all plots in a single plot</span></span>
<span id="cb11-93"><a href="#cb11-93"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/combine_plots.html">combine_plots</a></span>(</span>
<span id="cb11-94"><a href="#cb11-94"></a>  <span class="co"># Family: Poisson</span></span>
<span id="cb11-95"><a href="#cb11-95"></a>  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb11-96"><a href="#cb11-96"></a>    <span class="dt">x =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span>(</span>
<span id="cb11-97"><a href="#cb11-97"></a>      <span class="dt">formula =</span> counts <span class="op">~</span><span class="st"> </span>outcome <span class="op">+</span><span class="st"> </span>treatment,</span>
<span id="cb11-98"><a href="#cb11-98"></a>      <span class="dt">data =</span> df.counts,</span>
<span id="cb11-99"><a href="#cb11-99"></a>      <span class="dt">family =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/family.html">poisson</a></span>(<span class="dt">link =</span> <span class="st">"log"</span>)</span>
<span id="cb11-100"><a href="#cb11-100"></a>    ),</span>
<span id="cb11-101"><a href="#cb11-101"></a>    <span class="dt">title =</span> <span class="st">"Family: Poisson"</span>,</span>
<span id="cb11-102"><a href="#cb11-102"></a>    <span class="dt">stats.label.color =</span> <span class="st">"black"</span></span>
<span id="cb11-103"><a href="#cb11-103"></a>  ),</span>
<span id="cb11-104"><a href="#cb11-104"></a>  <span class="co"># Family: Gamma</span></span>
<span id="cb11-105"><a href="#cb11-105"></a>  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb11-106"><a href="#cb11-106"></a>    <span class="dt">x =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span>(</span>
<span id="cb11-107"><a href="#cb11-107"></a>      <span class="dt">formula =</span> lot1 <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(u),</span>
<span id="cb11-108"><a href="#cb11-108"></a>      <span class="dt">data =</span> df.clotting,</span>
<span id="cb11-109"><a href="#cb11-109"></a>      <span class="dt">family =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/family.html">Gamma</a></span>(<span class="dt">link =</span> <span class="st">"inverse"</span>)</span>
<span id="cb11-110"><a href="#cb11-110"></a>    ),</span>
<span id="cb11-111"><a href="#cb11-111"></a>    <span class="dt">title =</span> <span class="st">"Family: Gamma"</span>,</span>
<span id="cb11-112"><a href="#cb11-112"></a>    <span class="dt">stats.label.color =</span> <span class="st">"black"</span></span>
<span id="cb11-113"><a href="#cb11-113"></a>  ),</span>
<span id="cb11-114"><a href="#cb11-114"></a>  <span class="co"># Family: Quasi</span></span>
<span id="cb11-115"><a href="#cb11-115"></a>  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb11-116"><a href="#cb11-116"></a>    <span class="dt">x =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span>(</span>
<span id="cb11-117"><a href="#cb11-117"></a>      <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x,</span>
<span id="cb11-118"><a href="#cb11-118"></a>      <span class="dt">family =</span> <span class="kw"><a href="https://rdrr.io/r/stats/family.html">quasi</a></span>(<span class="dt">variance =</span> <span class="st">"mu"</span>, <span class="dt">link =</span> <span class="st">"log"</span>),</span>
<span id="cb11-119"><a href="#cb11-119"></a>      <span class="dt">data =</span> df<span class="fl">.3</span></span>
<span id="cb11-120"><a href="#cb11-120"></a>    ),</span>
<span id="cb11-121"><a href="#cb11-121"></a>    <span class="dt">title =</span> <span class="st">"Family: Quasi"</span>,</span>
<span id="cb11-122"><a href="#cb11-122"></a>    <span class="dt">stats.label.color =</span> <span class="st">"black"</span></span>
<span id="cb11-123"><a href="#cb11-123"></a>  ),</span>
<span id="cb11-124"><a href="#cb11-124"></a>  <span class="co"># Family: Quasibinomial</span></span>
<span id="cb11-125"><a href="#cb11-125"></a>  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb11-126"><a href="#cb11-126"></a>    <span class="dt">x =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span>(</span>
<span id="cb11-127"><a href="#cb11-127"></a>      <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x,</span>
<span id="cb11-128"><a href="#cb11-128"></a>      <span class="dt">family =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/family.html">quasibinomial</a></span>(<span class="dt">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb11-129"><a href="#cb11-129"></a>      <span class="dt">data =</span> df<span class="fl">.4</span></span>
<span id="cb11-130"><a href="#cb11-130"></a>    ),</span>
<span id="cb11-131"><a href="#cb11-131"></a>    <span class="dt">title =</span> <span class="st">"Family: Quasibinomial"</span>,</span>
<span id="cb11-132"><a href="#cb11-132"></a>    <span class="dt">stats.label.color =</span> <span class="st">"black"</span></span>
<span id="cb11-133"><a href="#cb11-133"></a>  ),</span>
<span id="cb11-134"><a href="#cb11-134"></a>  <span class="co"># Family: Quasipoisson</span></span>
<span id="cb11-135"><a href="#cb11-135"></a>  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb11-136"><a href="#cb11-136"></a>    <span class="dt">x =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span>(</span>
<span id="cb11-137"><a href="#cb11-137"></a>      <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x,</span>
<span id="cb11-138"><a href="#cb11-138"></a>      <span class="dt">family =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/family.html">quasipoisson</a></span>(<span class="dt">link =</span> <span class="st">"log"</span>),</span>
<span id="cb11-139"><a href="#cb11-139"></a>      <span class="dt">data =</span> df<span class="fl">.4</span></span>
<span id="cb11-140"><a href="#cb11-140"></a>    ),</span>
<span id="cb11-141"><a href="#cb11-141"></a>    <span class="dt">title =</span> <span class="st">"Family: Quasipoisson"</span>,</span>
<span id="cb11-142"><a href="#cb11-142"></a>    <span class="dt">stats.label.color =</span> <span class="st">"black"</span></span>
<span id="cb11-143"><a href="#cb11-143"></a>  ),</span>
<span id="cb11-144"><a href="#cb11-144"></a>  <span class="co"># Family: Gaussian</span></span>
<span id="cb11-145"><a href="#cb11-145"></a>  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb11-146"><a href="#cb11-146"></a>    <span class="dt">x =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span>(</span>
<span id="cb11-147"><a href="#cb11-147"></a>      <span class="dt">formula =</span> Sepal.Length <span class="op">~</span><span class="st"> </span>Species,</span>
<span id="cb11-148"><a href="#cb11-148"></a>      <span class="dt">family =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span>(<span class="dt">link =</span> <span class="st">"identity"</span>),</span>
<span id="cb11-149"><a href="#cb11-149"></a>      <span class="dt">data =</span> iris</span>
<span id="cb11-150"><a href="#cb11-150"></a>    ),</span>
<span id="cb11-151"><a href="#cb11-151"></a>    <span class="dt">title =</span> <span class="st">"Family: Gaussian"</span>,</span>
<span id="cb11-152"><a href="#cb11-152"></a>    <span class="dt">stats.label.color =</span> <span class="st">"black"</span></span>
<span id="cb11-153"><a href="#cb11-153"></a>  ),</span>
<span id="cb11-154"><a href="#cb11-154"></a>  <span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"(a)"</span>, <span class="st">"(b)"</span>, <span class="st">"(c)"</span>, <span class="st">"(d)"</span>, <span class="st">"(e)"</span>, <span class="st">"(f)"</span>),</span>
<span id="cb11-155"><a href="#cb11-155"></a>  <span class="dt">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb11-156"><a href="#cb11-156"></a>  <span class="dt">title.text =</span> <span class="st">"Exploring models with different `glm` families"</span>,</span>
<span id="cb11-157"><a href="#cb11-157"></a>  <span class="dt">title.color =</span> <span class="st">"blue"</span></span>
<span id="cb11-158"><a href="#cb11-158"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/glm_full-1.png" width="960"></p>
</div>
<div id="modified-fitting-for-generalized-linear-models-glm2" class="section level2">
<h2 class="hasAnchor">
<a href="#modified-fitting-for-generalized-linear-models-glm2" class="anchor"></a>modified fitting for generalized linear models (<code>glm2</code>)</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># setup</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(glm2)</span>
<span id="cb12-3"><a href="#cb12-3"></a>y &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb12-4"><a href="#cb12-4"></a></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co"># model</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>fit1 &lt;-<span class="st"> </span>glm2<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/glm2/man/glm2.html">glm2</a></span>(</span>
<span id="cb12-7"><a href="#cb12-7"></a>  <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb12-8"><a href="#cb12-8"></a>  <span class="dt">family =</span> <span class="kw"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span>(<span class="dt">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb12-9"><a href="#cb12-9"></a>  <span class="dt">control =</span> <span class="kw"><a href="https://rdrr.io/r/stats/glm.control.html">glm.control</a></span>(<span class="dt">trace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb12-10"><a href="#cb12-10"></a>)</span>
<span id="cb12-11"><a href="#cb12-11"></a></span>
<span id="cb12-12"><a href="#cb12-12"></a><span class="co"># plot</span></span>
<span id="cb12-13"><a href="#cb12-13"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb12-14"><a href="#cb12-14"></a>  <span class="dt">x =</span> fit1,</span>
<span id="cb12-15"><a href="#cb12-15"></a>  <span class="dt">title =</span> <span class="st">"greater stability for fitting </span><span class="ch">\n</span><span class="st">generalized linear models"</span>,</span>
<span id="cb12-16"><a href="#cb12-16"></a>  <span class="dt">exclude.intercept =</span> <span class="ot">FALSE</span></span>
<span id="cb12-17"><a href="#cb12-17"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/glm2-1.png" width="384"></p>
</div>
<div id="two-stage-least-squares-instrumental-variables-regression-iv_robust" class="section level2">
<h2 class="hasAnchor">
<a href="#two-stage-least-squares-instrumental-variables-regression-iv_robust" class="anchor"></a>Two-Stage Least Squares Instrumental Variables Regression (<code>iv_robust</code>)</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># setup</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(fabricatr)</span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(estimatr)</span>
<span id="cb13-5"><a href="#cb13-5"></a></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="co"># data</span></span>
<span id="cb13-7"><a href="#cb13-7"></a>dat &lt;-<span class="st"> </span><span class="kw">fabricate</span>(</span>
<span id="cb13-8"><a href="#cb13-8"></a>  <span class="dt">N =</span> <span class="dv">40</span>,</span>
<span id="cb13-9"><a href="#cb13-9"></a>  <span class="dt">Y =</span> <span class="kw"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span>(N, <span class="dt">lambda =</span> <span class="dv">4</span>),</span>
<span id="cb13-10"><a href="#cb13-10"></a>  <span class="dt">Z =</span> <span class="kw"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(N, <span class="dv">1</span>, <span class="dt">prob =</span> <span class="fl">0.4</span>),</span>
<span id="cb13-11"><a href="#cb13-11"></a>  <span class="dt">D =</span> Z <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(N, <span class="dv">1</span>, <span class="dt">prob =</span> <span class="fl">0.8</span>),</span>
<span id="cb13-12"><a href="#cb13-12"></a>  <span class="dt">X =</span> <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(N),</span>
<span id="cb13-13"><a href="#cb13-13"></a>  <span class="dt">G =</span> <span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], N, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb13-14"><a href="#cb13-14"></a>)</span>
<span id="cb13-15"><a href="#cb13-15"></a></span>
<span id="cb13-16"><a href="#cb13-16"></a><span class="co"># instrument for treatment `D` with encouragement `Z`</span></span>
<span id="cb13-17"><a href="#cb13-17"></a>mod &lt;-<span class="st"> </span>estimatr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/estimatr/man/iv_robust.html">iv_robust</a></span>(<span class="dt">formula =</span> Y <span class="op">~</span><span class="st"> </span>D <span class="op">+</span><span class="st"> </span>X <span class="op">|</span><span class="st"> </span>Z <span class="op">+</span><span class="st"> </span>X, <span class="dt">data =</span> dat)</span>
<span id="cb13-18"><a href="#cb13-18"></a></span>
<span id="cb13-19"><a href="#cb13-19"></a><span class="co"># plot</span></span>
<span id="cb13-20"><a href="#cb13-20"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb13-21"><a href="#cb13-21"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb13-22"><a href="#cb13-22"></a>  <span class="dt">exclude.intercept =</span> <span class="ot">FALSE</span>,</span>
<span id="cb13-23"><a href="#cb13-23"></a>  <span class="dt">title =</span> <span class="st">"Two-Stage Least Squares Instrumental Variables Regression"</span></span>
<span id="cb13-24"><a href="#cb13-24"></a>)</span>
<span id="cb13-25"><a href="#cb13-25"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/iv_robust-1.png" width="672"></p>
</div>
<div id="fitting-negative-binomial-glm-negbin" class="section level2">
<h2 class="hasAnchor">
<a href="#fitting-negative-binomial-glm-negbin" class="anchor"></a>fitting negative binomial GLM (<code>negbin</code>)</h2>
<p>Just to demonstrate that this can be done, let’s also flip the axes:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># setup</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(MASS)</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(lme4)</span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">101</span>)</span>
<span id="cb14-5"><a href="#cb14-5"></a></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="co"># data</span></span>
<span id="cb14-7"><a href="#cb14-7"></a>dd &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span>(</span>
<span id="cb14-8"><a href="#cb14-8"></a>  <span class="dt">f1 =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>),</span>
<span id="cb14-9"><a href="#cb14-9"></a>  <span class="dt">f2 =</span> LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],</span>
<span id="cb14-10"><a href="#cb14-10"></a>  <span class="dt">g =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>,</span>
<span id="cb14-11"><a href="#cb14-11"></a>  <span class="dt">rep =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">15</span>,</span>
<span id="cb14-12"><a href="#cb14-12"></a>  <span class="dt">KEEP.OUT.ATTRS =</span> <span class="ot">FALSE</span></span>
<span id="cb14-13"><a href="#cb14-13"></a>)</span>
<span id="cb14-14"><a href="#cb14-14"></a>mu &lt;-<span class="st"> </span><span class="dv">5</span> <span class="op">*</span><span class="st"> </span>(<span class="op">-</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/with.html">with</a></span>(dd, <span class="kw"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(f1) <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(f2)))</span>
<span id="cb14-15"><a href="#cb14-15"></a>dd<span class="op">$</span>y &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/NegBinomial.html">rnbinom</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(dd), <span class="dt">mu =</span> mu, <span class="dt">size =</span> <span class="fl">0.5</span>)</span>
<span id="cb14-16"><a href="#cb14-16"></a></span>
<span id="cb14-17"><a href="#cb14-17"></a><span class="co"># model</span></span>
<span id="cb14-18"><a href="#cb14-18"></a>m.glm &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/MASS/man/glm.nb.html">glm.nb</a></span>(<span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>f1 <span class="op">*</span><span class="st"> </span>f2, <span class="dt">data =</span> dd)</span>
<span id="cb14-19"><a href="#cb14-19"></a></span>
<span id="cb14-20"><a href="#cb14-20"></a><span class="co"># plot</span></span>
<span id="cb14-21"><a href="#cb14-21"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb14-22"><a href="#cb14-22"></a>  <span class="dt">x =</span> m.glm,</span>
<span id="cb14-23"><a href="#cb14-23"></a>  <span class="dt">title =</span> <span class="st">"generalized linear model (GLM)</span><span class="ch">\n</span><span class="st"> for the negative binomial family"</span>,</span>
<span id="cb14-24"><a href="#cb14-24"></a>  <span class="dt">exclude.intercept =</span> <span class="ot">FALSE</span>,</span>
<span id="cb14-25"><a href="#cb14-25"></a>  <span class="dt">only.significant =</span> <span class="ot">TRUE</span>,</span>
<span id="cb14-26"><a href="#cb14-26"></a>  <span class="dt">stats.label.args =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">size =</span> <span class="fl">2.5</span>, <span class="dt">direction =</span> <span class="st">"x"</span>)</span>
<span id="cb14-27"><a href="#cb14-27"></a>) <span class="op">+</span></span>
<span id="cb14-28"><a href="#cb14-28"></a><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span>()</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/negbin-1.png" width="768"></p>
</div>
<div id="generalized-linear-mixed-effects-model-glmerglmermod" class="section level2">
<h2 class="hasAnchor">
<a href="#generalized-linear-mixed-effects-model-glmerglmermod" class="anchor"></a>generalized linear mixed-effects model (<code>glmer</code>/<code>glmerMod</code>)</h2>
<p>In the previous example, we saw how being a female and being a child was predictive of surviving the Titanic disaster. But in that analysis, we didn’t take into account one important factor: the passenger class in which people were traveling. Naively, we have reasons to believe that the effects of sex and age might be dependent on the class (maybe rescuing passengers in the first class were given priority?). To take into account this hierarchical structure of the data, we can run generalized linear mixed effects model with a random slope for class.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># setup</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(lme4)</span>
<span id="cb15-4"><a href="#cb15-4"></a></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="co"># model</span></span>
<span id="cb15-6"><a href="#cb15-6"></a>mod &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/lme4/man/glmer.html">glmer</a></span>(</span>
<span id="cb15-7"><a href="#cb15-7"></a>  <span class="dt">formula =</span> Survived <span class="op">~</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>(Sex <span class="op">+</span><span class="st"> </span>Age <span class="op">|</span><span class="st"> </span>Class),</span>
<span id="cb15-8"><a href="#cb15-8"></a>  <span class="co"># select 20% of the sample to reduce the time of execution</span></span>
<span id="cb15-9"><a href="#cb15-9"></a>  <span class="dt">data =</span> dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/sample.html">sample_frac</a></span>(<span class="dt">tbl =</span> ggstatsplot<span class="op">::</span>Titanic_full, <span class="dt">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb15-10"><a href="#cb15-10"></a>  <span class="dt">family =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span>(<span class="dt">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb15-11"><a href="#cb15-11"></a>  <span class="dt">control =</span> lme4<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html">glmerControl</a></span>(</span>
<span id="cb15-12"><a href="#cb15-12"></a>    <span class="dt">optimizer =</span> <span class="st">"Nelder_Mead"</span>,</span>
<span id="cb15-13"><a href="#cb15-13"></a>    <span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>,</span>
<span id="cb15-14"><a href="#cb15-14"></a>    <span class="dt">boundary.tol =</span> <span class="fl">1e-7</span></span>
<span id="cb15-15"><a href="#cb15-15"></a>  )</span>
<span id="cb15-16"><a href="#cb15-16"></a>)</span>
<span id="cb15-17"><a href="#cb15-17"></a></span>
<span id="cb15-18"><a href="#cb15-18"></a><span class="co"># plot</span></span>
<span id="cb15-19"><a href="#cb15-19"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb15-20"><a href="#cb15-20"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb15-21"><a href="#cb15-21"></a>  <span class="dt">title =</span> <span class="st">"generalized linear mixed-effects model"</span>,</span>
<span id="cb15-22"><a href="#cb15-22"></a>  <span class="dt">exponentiate =</span> <span class="ot">TRUE</span>,</span>
<span id="cb15-23"><a href="#cb15-23"></a>  <span class="dt">stats.label.color =</span> <span class="st">"black"</span></span>
<span id="cb15-24"><a href="#cb15-24"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/glmer-1.png" width="480"></p>
<p>As we had expected, once we take into account the differential relationship that might exist between survival and predictors across different passenger classes, only the sex factor remain a significant predictor. In other words, being a female was the strongest predictor of whether someone survived the tragedy that befell the Titanic.</p>
</div>
<div id="fitting-negative-binomial-glmm-glmer-nb" class="section level2">
<h2 class="hasAnchor">
<a href="#fitting-negative-binomial-glmm-glmer-nb" class="anchor"></a>fitting negative binomial GLMM (<code>glmer.nb</code>)</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># setup</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(MASS)</span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(lme4)</span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">101</span>)</span>
<span id="cb16-5"><a href="#cb16-5"></a></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="co"># data</span></span>
<span id="cb16-7"><a href="#cb16-7"></a>dd &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span>(</span>
<span id="cb16-8"><a href="#cb16-8"></a>  <span class="dt">f1 =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>),</span>
<span id="cb16-9"><a href="#cb16-9"></a>  <span class="dt">f2 =</span> LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],</span>
<span id="cb16-10"><a href="#cb16-10"></a>  <span class="dt">g =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>,</span>
<span id="cb16-11"><a href="#cb16-11"></a>  <span class="dt">rep =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">15</span>,</span>
<span id="cb16-12"><a href="#cb16-12"></a>  <span class="dt">KEEP.OUT.ATTRS =</span> <span class="ot">FALSE</span></span>
<span id="cb16-13"><a href="#cb16-13"></a>)</span>
<span id="cb16-14"><a href="#cb16-14"></a><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(mu &lt;-</span>
<span id="cb16-15"><a href="#cb16-15"></a><span class="st">  </span><span class="dv">5</span> <span class="op">*</span><span class="st"> </span>(<span class="op">-</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/with.html">with</a></span>(dd, <span class="kw"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(f1) <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(f2))))</span>
<span id="cb16-16"><a href="#cb16-16"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb16-17"><a href="#cb16-17"></a><span class="co">#&gt;       5      10      20      20      30      35</span></span>
<span id="cb16-18"><a href="#cb16-18"></a>dd<span class="op">$</span>y &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/NegBinomial.html">rnbinom</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(dd), <span class="dt">mu =</span> mu, <span class="dt">size =</span> <span class="fl">0.5</span>)</span>
<span id="cb16-19"><a href="#cb16-19"></a></span>
<span id="cb16-20"><a href="#cb16-20"></a><span class="co"># model</span></span>
<span id="cb16-21"><a href="#cb16-21"></a>m.nb &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/lme4/man/glmer.nb.html">glmer.nb</a></span>(<span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>f1 <span class="op">*</span><span class="st"> </span>f2 <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>g), <span class="dt">data =</span> dd)</span>
<span id="cb16-22"><a href="#cb16-22"></a></span>
<span id="cb16-23"><a href="#cb16-23"></a><span class="co"># plot</span></span>
<span id="cb16-24"><a href="#cb16-24"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb16-25"><a href="#cb16-25"></a>  <span class="dt">x =</span> m.nb,</span>
<span id="cb16-26"><a href="#cb16-26"></a>  <span class="dt">title =</span> <span class="st">"generalized linear mixed-effects model (GLMM)</span><span class="ch">\n</span><span class="st"> for the negative binomial family"</span>,</span>
<span id="cb16-27"><a href="#cb16-27"></a>  <span class="dt">exclude.intercept =</span> <span class="ot">FALSE</span></span>
<span id="cb16-28"><a href="#cb16-28"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/glmer.nb-1.png" width="576"></p>
</div>
<div id="compound-poisson-generalized-linear-models-cpglm" class="section level2">
<h2 class="hasAnchor">
<a href="#compound-poisson-generalized-linear-models-cpglm" class="anchor"></a>Compound Poisson Generalized Linear Models (<code>cpglm</code>)</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># set up</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(cplm)</span>
<span id="cb17-4"><a href="#cb17-4"></a></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="co"># model</span></span>
<span id="cb17-6"><a href="#cb17-6"></a>mod &lt;-<span class="st"> </span>cplm<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/cplm/man/cpglm.html">cpglm</a></span>(</span>
<span id="cb17-7"><a href="#cb17-7"></a>  <span class="dt">formula =</span> RLD <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(Zone) <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(Stock),</span>
<span id="cb17-8"><a href="#cb17-8"></a>  <span class="dt">data =</span> FineRoot</span>
<span id="cb17-9"><a href="#cb17-9"></a>)</span>
<span id="cb17-10"><a href="#cb17-10"></a></span>
<span id="cb17-11"><a href="#cb17-11"></a><span class="co"># plot</span></span>
<span id="cb17-12"><a href="#cb17-12"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb17-13"><a href="#cb17-13"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb17-14"><a href="#cb17-14"></a>  <span class="dt">title =</span> <span class="st">"Compound Poisson Generalized Linear Models"</span></span>
<span id="cb17-15"><a href="#cb17-15"></a>)</span>
<span id="cb17-16"><a href="#cb17-16"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/cpglm-1.png" width="960"></p>
</div>
<div id="compound-poisson-generalized-linear-mixed-models-cpglmm" class="section level2">
<h2 class="hasAnchor">
<a href="#compound-poisson-generalized-linear-mixed-models-cpglmm" class="anchor"></a>Compound Poisson Generalized Linear Mixed Models (<code>cpglmm</code>)</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># set up</span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(cplm)</span>
<span id="cb18-4"><a href="#cb18-4"></a></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="co"># model</span></span>
<span id="cb18-6"><a href="#cb18-6"></a>mod &lt;-<span class="st"> </span><span class="kw">cpglmm</span>(</span>
<span id="cb18-7"><a href="#cb18-7"></a>  <span class="dt">formula =</span> RLD <span class="op">~</span><span class="st"> </span>Stock <span class="op">+</span><span class="st"> </span>Spacing <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Plant),</span>
<span id="cb18-8"><a href="#cb18-8"></a>  <span class="dt">data =</span> FineRoot</span>
<span id="cb18-9"><a href="#cb18-9"></a>)</span>
<span id="cb18-10"><a href="#cb18-10"></a></span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="co"># plot</span></span>
<span id="cb18-12"><a href="#cb18-12"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb18-13"><a href="#cb18-13"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb18-14"><a href="#cb18-14"></a>  <span class="dt">title =</span> <span class="st">"Compound Poisson Generalized Linear Mixed Models"</span></span>
<span id="cb18-15"><a href="#cb18-15"></a>)</span>
<span id="cb18-16"><a href="#cb18-16"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/cpglmm-1.png" width="960"></p>
</div>
<div id="bayesian-compound-poisson-linear-models-bcplm" class="section level2">
<h2 class="hasAnchor">
<a href="#bayesian-compound-poisson-linear-models-bcplm" class="anchor"></a>Bayesian Compound Poisson Linear Models (<code>bcplm</code>)</h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># set up</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(cplm)</span>
<span id="cb19-4"><a href="#cb19-4"></a></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="co"># model</span></span>
<span id="cb19-6"><a href="#cb19-6"></a>mod &lt;-</span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="st">  </span><span class="kw">bcplm</span>(</span>
<span id="cb19-8"><a href="#cb19-8"></a>    <span class="dt">formula =</span> RLD <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(Zone) <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(Stock),</span>
<span id="cb19-9"><a href="#cb19-9"></a>    <span class="dt">data =</span> FineRoot,</span>
<span id="cb19-10"><a href="#cb19-10"></a>    <span class="dt">tune.iter =</span> <span class="dv">2000</span>,</span>
<span id="cb19-11"><a href="#cb19-11"></a>    <span class="dt">n.iter =</span> <span class="dv">6000</span>,</span>
<span id="cb19-12"><a href="#cb19-12"></a>    <span class="dt">n.burnin =</span> <span class="dv">1000</span>,</span>
<span id="cb19-13"><a href="#cb19-13"></a>    <span class="dt">n.thin =</span> <span class="dv">5</span></span>
<span id="cb19-14"><a href="#cb19-14"></a>  )</span>
<span id="cb19-15"><a href="#cb19-15"></a></span>
<span id="cb19-16"><a href="#cb19-16"></a><span class="co"># plot</span></span>
<span id="cb19-17"><a href="#cb19-17"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb19-18"><a href="#cb19-18"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb19-19"><a href="#cb19-19"></a>  <span class="dt">title =</span> <span class="st">"Bayesian Compound Poisson Linear Models"</span></span>
<span id="cb19-20"><a href="#cb19-20"></a>)</span></code></pre></div>
</div>
<div id="zero-inflated-compound-poisson-generalized-linear-models-zcpglm" class="section level2">
<h2 class="hasAnchor">
<a href="#zero-inflated-compound-poisson-generalized-linear-models-zcpglm" class="anchor"></a>Zero-inflated Compound Poisson Generalized Linear Models (<code>zcpglm</code>)</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># set up</span></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(cplm)</span>
<span id="cb20-4"><a href="#cb20-4"></a>da &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(AutoClaim, IN_YY <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="co"># use data in the Yip and Yau paper</span></span>
<span id="cb20-5"><a href="#cb20-5"></a>da &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/transform.html">transform</a></span>(da, <span class="dt">CLM_AMT5 =</span> CLM_AMT5 <span class="op">/</span><span class="st"> </span><span class="dv">1000</span>, <span class="dt">INCOME =</span> INCOME <span class="op">/</span><span class="st"> </span><span class="dv">10000</span>)</span>
<span id="cb20-6"><a href="#cb20-6"></a></span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="co"># model</span></span>
<span id="cb20-8"><a href="#cb20-8"></a>mod &lt;-<span class="st"> </span><span class="kw">zcpglm</span>(</span>
<span id="cb20-9"><a href="#cb20-9"></a>  <span class="dt">formula =</span> CLM_AMT5 <span class="op">~</span><span class="st"> </span>CAR_USE <span class="op">+</span><span class="st"> </span>MARRIED <span class="op">+</span><span class="st"> </span>AREA <span class="op">+</span><span class="st"> </span>MVR_PTS <span class="op">||</span><span class="st"> </span>MVR_PTS <span class="op">+</span><span class="st"> </span>INCOME,</span>
<span id="cb20-10"><a href="#cb20-10"></a>  <span class="dt">data =</span> da</span>
<span id="cb20-11"><a href="#cb20-11"></a>)</span>
<span id="cb20-12"><a href="#cb20-12"></a></span>
<span id="cb20-13"><a href="#cb20-13"></a><span class="co"># plot</span></span>
<span id="cb20-14"><a href="#cb20-14"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb20-15"><a href="#cb20-15"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb20-16"><a href="#cb20-16"></a>  <span class="dt">title =</span> <span class="st">"Zero-inflated Compound Poisson </span><span class="ch">\n</span><span class="st">Generalized Linear Models"</span></span>
<span id="cb20-17"><a href="#cb20-17"></a>)</span></code></pre></div>
</div>
<div id="vector-generalized-linear-models-vgam" class="section level2">
<h2 class="hasAnchor">
<a href="#vector-generalized-linear-models-vgam" class="anchor"></a>Vector Generalized Linear Models (<code>vgam</code>)</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># setup</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(VGAM)</span>
<span id="cb21-4"><a href="#cb21-4"></a>pneumo &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/transform.html">transform</a></span>(pneumo, <span class="dt">let =</span> <span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(exposure.time))</span>
<span id="cb21-5"><a href="#cb21-5"></a></span>
<span id="cb21-6"><a href="#cb21-6"></a><span class="co"># model</span></span>
<span id="cb21-7"><a href="#cb21-7"></a>mod &lt;-</span>
<span id="cb21-8"><a href="#cb21-8"></a><span class="st">  </span><span class="kw">vglm</span>(</span>
<span id="cb21-9"><a href="#cb21-9"></a>    <span class="dt">formula =</span> <span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(normal, mild, severe) <span class="op">~</span><span class="st"> </span>let,</span>
<span id="cb21-10"><a href="#cb21-10"></a>    <span class="dt">family =</span> multinomial,</span>
<span id="cb21-11"><a href="#cb21-11"></a>    <span class="dt">data =</span> pneumo</span>
<span id="cb21-12"><a href="#cb21-12"></a>  )</span>
<span id="cb21-13"><a href="#cb21-13"></a></span>
<span id="cb21-14"><a href="#cb21-14"></a><span class="co"># plot</span></span>
<span id="cb21-15"><a href="#cb21-15"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb21-16"><a href="#cb21-16"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb21-17"><a href="#cb21-17"></a>  <span class="dt">title =</span> <span class="st">"Vector Generalized Linear Models"</span>,</span>
<span id="cb21-18"><a href="#cb21-18"></a>  <span class="dt">exclude.intercept =</span> <span class="ot">FALSE</span></span>
<span id="cb21-19"><a href="#cb21-19"></a>)</span>
<span id="cb21-20"><a href="#cb21-20"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/vgam-1.png" width="576"></p>
</div>
<div id="constrained-generalized-additive-model-fitting-cgam" class="section level2">
<h2 class="hasAnchor">
<a href="#constrained-generalized-additive-model-fitting-cgam" class="anchor"></a>Constrained Generalized Additive Model Fitting (<code>cgam</code>)</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># setup</span></span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(cgam)</span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(cubic)</span>
<span id="cb22-5"><a href="#cb22-5"></a></span>
<span id="cb22-6"><a href="#cb22-6"></a><span class="co"># model</span></span>
<span id="cb22-7"><a href="#cb22-7"></a>m &lt;-<span class="st"> </span><span class="kw">cgam</span>(<span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="kw">incr.conv</span>(x), <span class="dt">data =</span> cubic)</span>
<span id="cb22-8"><a href="#cb22-8"></a></span>
<span id="cb22-9"><a href="#cb22-9"></a><span class="co"># plot</span></span>
<span id="cb22-10"><a href="#cb22-10"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb22-11"><a href="#cb22-11"></a>  <span class="dt">x =</span> m,</span>
<span id="cb22-12"><a href="#cb22-12"></a>  <span class="dt">title =</span> <span class="st">"Constrained Generalized Additive Model Fitting"</span>,</span>
<span id="cb22-13"><a href="#cb22-13"></a>  <span class="dt">exclude.intercept =</span> <span class="ot">FALSE</span></span>
<span id="cb22-14"><a href="#cb22-14"></a>)</span>
<span id="cb22-15"><a href="#cb22-15"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/cgam-1.png" width="576"></p>
</div>
<div id="constrained-generalized-additive-mixed-effects-model-fitting-cgamm" class="section level2">
<h2 class="hasAnchor">
<a href="#constrained-generalized-additive-mixed-effects-model-fitting-cgamm" class="anchor"></a>Constrained Generalized Additive Mixed-Effects Model Fitting (<code>cgamm</code>)</h2>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># setup</span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(cgam)</span>
<span id="cb23-4"><a href="#cb23-4"></a></span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="co"># simulate a balanced data set with 30 clusters</span></span>
<span id="cb23-6"><a href="#cb23-6"></a><span class="co"># each cluster has 30 data points</span></span>
<span id="cb23-7"><a href="#cb23-7"></a>n &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb23-8"><a href="#cb23-8"></a>m &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb23-9"><a href="#cb23-9"></a></span>
<span id="cb23-10"><a href="#cb23-10"></a><span class="co"># the standard deviation of between cluster error terms is 1</span></span>
<span id="cb23-11"><a href="#cb23-11"></a><span class="co"># the standard deviation of within cluster error terms is 2</span></span>
<span id="cb23-12"><a href="#cb23-12"></a>sige &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb23-13"><a href="#cb23-13"></a>siga &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb23-14"><a href="#cb23-14"></a></span>
<span id="cb23-15"><a href="#cb23-15"></a><span class="co"># generate a continuous predictor</span></span>
<span id="cb23-16"><a href="#cb23-16"></a>x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>(m <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb23-17"><a href="#cb23-17"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb23-18"><a href="#cb23-18"></a>  x[(n <span class="op">*</span><span class="st"> </span>(i <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(n <span class="op">*</span><span class="st"> </span>i)] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(n), <span class="dv">3</span>)</span>
<span id="cb23-19"><a href="#cb23-19"></a>}</span>
<span id="cb23-20"><a href="#cb23-20"></a><span class="co"># generate a group factor</span></span>
<span id="cb23-21"><a href="#cb23-21"></a>group &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Round.html">trunc</a></span>(<span class="dv">0</span><span class="op">:</span>((m <span class="op">*</span><span class="st"> </span>n) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span>n) <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb23-22"><a href="#cb23-22"></a></span>
<span id="cb23-23"><a href="#cb23-23"></a><span class="co"># generate the fixed-effect term</span></span>
<span id="cb23-24"><a href="#cb23-24"></a>mu &lt;-<span class="st"> </span><span class="dv">10</span> <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="dv">10</span> <span class="op">*</span><span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="dv">5</span>) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="dv">10</span> <span class="op">*</span><span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb23-25"><a href="#cb23-25"></a></span>
<span id="cb23-26"><a href="#cb23-26"></a><span class="co"># generate the random-intercept term asscosiated with each group</span></span>
<span id="cb23-27"><a href="#cb23-27"></a>avals &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(m, <span class="dv">0</span>, siga)</span>
<span id="cb23-28"><a href="#cb23-28"></a></span>
<span id="cb23-29"><a href="#cb23-29"></a><span class="co"># generate the response</span></span>
<span id="cb23-30"><a href="#cb23-30"></a>y &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>(m <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb23-31"><a href="#cb23-31"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb23-32"><a href="#cb23-32"></a>  y[group <span class="op">==</span><span class="st"> </span>i] &lt;-<span class="st"> </span>mu[group <span class="op">==</span><span class="st"> </span>i] <span class="op">+</span><span class="st"> </span>avals[i] <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(n, <span class="dv">0</span>, sige)</span>
<span id="cb23-33"><a href="#cb23-33"></a>}</span>
<span id="cb23-34"><a href="#cb23-34"></a></span>
<span id="cb23-35"><a href="#cb23-35"></a><span class="co"># use REML method to fit the model</span></span>
<span id="cb23-36"><a href="#cb23-36"></a>ans &lt;-<span class="st"> </span><span class="kw">cgamm</span>(<span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="kw">s.incr</span>(x) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>group), <span class="dt">reml =</span> <span class="ot">TRUE</span>)</span>
<span id="cb23-37"><a href="#cb23-37"></a></span>
<span id="cb23-38"><a href="#cb23-38"></a><span class="co"># plot</span></span>
<span id="cb23-39"><a href="#cb23-39"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb23-40"><a href="#cb23-40"></a>  <span class="dt">x =</span> ans,</span>
<span id="cb23-41"><a href="#cb23-41"></a>  <span class="dt">title =</span> <span class="st">"Constrained Generalized Additive Mixed-Effects Model Fitting"</span>,</span>
<span id="cb23-42"><a href="#cb23-42"></a>  <span class="dt">exclude.intercept =</span> <span class="ot">FALSE</span></span>
<span id="cb23-43"><a href="#cb23-43"></a>)</span>
<span id="cb23-44"><a href="#cb23-44"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/cgamm-1.png" width="672"></p>
</div>
<div id="hurdle-models-for-count-data-regression-hurdle" class="section level2">
<h2 class="hasAnchor">
<a href="#hurdle-models-for-count-data-regression-hurdle" class="anchor"></a>Hurdle Models for Count Data Regression (<code>hurdle</code>)</h2>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># setup</span></span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(pscl)</span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"bioChemists"</span>, <span class="dt">package =</span> <span class="st">"pscl"</span>)</span>
<span id="cb24-5"><a href="#cb24-5"></a></span>
<span id="cb24-6"><a href="#cb24-6"></a><span class="co"># geometric-poisson</span></span>
<span id="cb24-7"><a href="#cb24-7"></a>fm_hp2 &lt;-</span>
<span id="cb24-8"><a href="#cb24-8"></a><span class="st">  </span>pscl<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/pscl/man/hurdle.html">hurdle</a></span>(</span>
<span id="cb24-9"><a href="#cb24-9"></a>    <span class="dt">formula =</span> art <span class="op">~</span><span class="st"> </span>.,</span>
<span id="cb24-10"><a href="#cb24-10"></a>    <span class="dt">data =</span> bioChemists,</span>
<span id="cb24-11"><a href="#cb24-11"></a>    <span class="dt">zero =</span> <span class="st">"geometric"</span></span>
<span id="cb24-12"><a href="#cb24-12"></a>  )</span>
<span id="cb24-13"><a href="#cb24-13"></a></span>
<span id="cb24-14"><a href="#cb24-14"></a><span class="co"># plot</span></span>
<span id="cb24-15"><a href="#cb24-15"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb24-16"><a href="#cb24-16"></a>  <span class="dt">x =</span> fm_hp2,</span>
<span id="cb24-17"><a href="#cb24-17"></a>  <span class="dt">only.significant =</span> <span class="ot">TRUE</span>,</span>
<span id="cb24-18"><a href="#cb24-18"></a>  <span class="dt">exclude.intercept =</span> <span class="ot">FALSE</span>,</span>
<span id="cb24-19"><a href="#cb24-19"></a>  <span class="dt">conf.level =</span> <span class="fl">0.99</span>,</span>
<span id="cb24-20"><a href="#cb24-20"></a>  <span class="dt">title =</span> <span class="st">"Hurdle Models for Count Data Regression"</span></span>
<span id="cb24-21"><a href="#cb24-21"></a>)</span>
<span id="cb24-22"><a href="#cb24-22"></a><span class="co">#&gt; Warning:  No. of factor levels is greater than default palette color count.</span></span>
<span id="cb24-23"><a href="#cb24-23"></a><span class="co">#&gt;  Try using another color `palette` (and/or `package`).</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/hurdle-1.png" width="768"></p>
</div>
<div id="dirichlet-regression-model-dirichreg" class="section level2">
<h2 class="hasAnchor">
<a href="#dirichlet-regression-model-dirichreg" class="anchor"></a>Dirichlet regression model (<code>DirichReg</code>)</h2>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># setup</span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(DirichletReg)</span>
<span id="cb25-4"><a href="#cb25-4"></a></span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="co"># data</span></span>
<span id="cb25-6"><a href="#cb25-6"></a>ALake &lt;-<span class="st"> </span>ArcticLake</span>
<span id="cb25-7"><a href="#cb25-7"></a>ALake<span class="op">$</span>Y &lt;-<span class="st"> </span><span class="kw">DR_data</span>(ALake[, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>])</span>
<span id="cb25-8"><a href="#cb25-8"></a></span>
<span id="cb25-9"><a href="#cb25-9"></a><span class="co"># fit a quadratic Dirichlet regression models ("common")</span></span>
<span id="cb25-10"><a href="#cb25-10"></a>mod &lt;-<span class="st"> </span><span class="kw">DirichReg</span>(Y <span class="op">~</span><span class="st"> </span>depth <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span>(depth<span class="op">^</span><span class="dv">2</span>), ALake)</span>
<span id="cb25-11"><a href="#cb25-11"></a></span>
<span id="cb25-12"><a href="#cb25-12"></a><span class="co"># plot</span></span>
<span id="cb25-13"><a href="#cb25-13"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb25-14"><a href="#cb25-14"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb25-15"><a href="#cb25-15"></a>  <span class="dt">title =</span> <span class="st">"Dirichlet Regression"</span></span>
<span id="cb25-16"><a href="#cb25-16"></a>)</span>
<span id="cb25-17"><a href="#cb25-17"></a><span class="co">#&gt; 'r2()' does not support models of class 'DirichletRegModel'.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/DirichReg-1.png" width="576"></p>
</div>
<div id="generalized-linear-models-with-extra-parameters-glmx" class="section level2">
<h2 class="hasAnchor">
<a href="#generalized-linear-models-with-extra-parameters-glmx" class="anchor"></a>Generalized Linear Models with Extra Parameters (<code>glmx</code>)</h2>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co"># setup</span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(glmx)</span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(MASS)</span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">1</span>)</span>
<span id="cb26-5"><a href="#cb26-5"></a>d &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="dv">200</span>, <span class="dv">-1</span>, <span class="dv">1</span>))</span>
<span id="cb26-6"><a href="#cb26-6"></a>d<span class="op">$</span>y &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/NegBinomial.html">rnbinom</a></span>(<span class="dv">200</span>, <span class="dt">mu =</span> <span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span>d<span class="op">$</span>x), <span class="dt">size =</span> <span class="dv">1</span>)</span>
<span id="cb26-7"><a href="#cb26-7"></a></span>
<span id="cb26-8"><a href="#cb26-8"></a><span class="co"># model</span></span>
<span id="cb26-9"><a href="#cb26-9"></a>m_nb1 &lt;-</span>
<span id="cb26-10"><a href="#cb26-10"></a><span class="st">  </span><span class="kw">glmx</span>(</span>
<span id="cb26-11"><a href="#cb26-11"></a>    <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x,</span>
<span id="cb26-12"><a href="#cb26-12"></a>    <span class="dt">data =</span> d,</span>
<span id="cb26-13"><a href="#cb26-13"></a>    <span class="dt">family =</span> negative.binomial,</span>
<span id="cb26-14"><a href="#cb26-14"></a>    <span class="dt">xlink =</span> <span class="st">"log"</span>,</span>
<span id="cb26-15"><a href="#cb26-15"></a>    <span class="dt">xstart =</span> <span class="dv">0</span></span>
<span id="cb26-16"><a href="#cb26-16"></a>  )</span>
<span id="cb26-17"><a href="#cb26-17"></a></span>
<span id="cb26-18"><a href="#cb26-18"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb26-19"><a href="#cb26-19"></a>  <span class="dt">x =</span> m_nb1,</span>
<span id="cb26-20"><a href="#cb26-20"></a>  <span class="dt">title =</span> <span class="st">"Generalized Linear Models with Extra Parameters"</span></span>
<span id="cb26-21"><a href="#cb26-21"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/glmx-1.png" width="960"></p>
</div>
<div id="generalized-linear-mixed-model-trees-glmertree" class="section level2">
<h2 class="hasAnchor">
<a href="#generalized-linear-mixed-model-trees-glmertree" class="anchor"></a>generalized linear mixed model trees (<code>glmertree</code>)</h2>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="co"># setup</span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(glmertree)</span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"DepressionDemo"</span>, <span class="dt">package =</span> <span class="st">"glmertree"</span>)</span>
<span id="cb27-5"><a href="#cb27-5"></a></span>
<span id="cb27-6"><a href="#cb27-6"></a><span class="co"># fit normal linear regression LMM tree for continuous outcome</span></span>
<span id="cb27-7"><a href="#cb27-7"></a>lt &lt;-<span class="st"> </span>glmertree<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/glmertree/man/glmertree.html">lmertree</a></span>(</span>
<span id="cb27-8"><a href="#cb27-8"></a>  <span class="dt">formula =</span> depression <span class="op">~</span><span class="st"> </span>treatment <span class="op">|</span><span class="st"> </span>cluster <span class="op">|</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>anxiety <span class="op">+</span><span class="st"> </span>duration,</span>
<span id="cb27-9"><a href="#cb27-9"></a>  <span class="dt">data =</span> DepressionDemo</span>
<span id="cb27-10"><a href="#cb27-10"></a>)</span>
<span id="cb27-11"><a href="#cb27-11"></a></span>
<span id="cb27-12"><a href="#cb27-12"></a><span class="co"># fit logistic regression GLMM tree for binary outcome</span></span>
<span id="cb27-13"><a href="#cb27-13"></a>gt &lt;-<span class="st"> </span>glmertree<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/glmertree/man/glmertree.html">glmertree</a></span>(</span>
<span id="cb27-14"><a href="#cb27-14"></a>  <span class="dt">formula =</span> depression_bin <span class="op">~</span><span class="st"> </span>treatment <span class="op">|</span><span class="st"> </span>cluster <span class="op">|</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>anxiety <span class="op">+</span><span class="st"> </span>duration,</span>
<span id="cb27-15"><a href="#cb27-15"></a>  <span class="dt">data =</span> DepressionDemo</span>
<span id="cb27-16"><a href="#cb27-16"></a>)</span>
<span id="cb27-17"><a href="#cb27-17"></a></span>
<span id="cb27-18"><a href="#cb27-18"></a><span class="co"># plot</span></span>
<span id="cb27-19"><a href="#cb27-19"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/combine_plots.html">combine_plots</a></span>(</span>
<span id="cb27-20"><a href="#cb27-20"></a>  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb27-21"><a href="#cb27-21"></a>    <span class="dt">x =</span> lt<span class="op">$</span>lmer,</span>
<span id="cb27-22"><a href="#cb27-22"></a>    <span class="dt">title =</span> <span class="st">"normal linear regression </span><span class="ch">\n</span><span class="st">LMM tree for continuous outcome"</span></span>
<span id="cb27-23"><a href="#cb27-23"></a>  ),</span>
<span id="cb27-24"><a href="#cb27-24"></a>  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb27-25"><a href="#cb27-25"></a>    <span class="dt">x =</span> lt<span class="op">$</span>lmer,</span>
<span id="cb27-26"><a href="#cb27-26"></a>    <span class="dt">title =</span> <span class="st">"logistic regression </span><span class="ch">\n</span><span class="st">GLMM tree for binary outcome"</span></span>
<span id="cb27-27"><a href="#cb27-27"></a>  ),</span>
<span id="cb27-28"><a href="#cb27-28"></a>  <span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"(a)"</span>, <span class="st">"(b)"</span>)</span>
<span id="cb27-29"><a href="#cb27-29"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/glmertree-1.png" width="960"></p>
</div>
<div id="generalized-linear-mixed-models-using-penalized-quasi-likelihood-glmmpql" class="section level2">
<h2 class="hasAnchor">
<a href="#generalized-linear-mixed-models-using-penalized-quasi-likelihood-glmmpql" class="anchor"></a>generalized linear mixed models using Penalized Quasi-Likelihood (<code>glmmPQL</code>)</h2>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="co"># setup</span></span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(MASS)</span>
<span id="cb28-4"><a href="#cb28-4"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(nlme)</span>
<span id="cb28-5"><a href="#cb28-5"></a></span>
<span id="cb28-6"><a href="#cb28-6"></a><span class="co"># model</span></span>
<span id="cb28-7"><a href="#cb28-7"></a>mod &lt;-</span>
<span id="cb28-8"><a href="#cb28-8"></a><span class="st">  </span>MASS<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/MASS/man/glmmPQL.html">glmmPQL</a></span>(</span>
<span id="cb28-9"><a href="#cb28-9"></a>    <span class="dt">fixed =</span> y <span class="op">~</span><span class="st"> </span>trt <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span>(week <span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span>),</span>
<span id="cb28-10"><a href="#cb28-10"></a>    <span class="dt">random =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID,</span>
<span id="cb28-11"><a href="#cb28-11"></a>    <span class="dt">family =</span> binomial,</span>
<span id="cb28-12"><a href="#cb28-12"></a>    <span class="dt">data =</span> bacteria,</span>
<span id="cb28-13"><a href="#cb28-13"></a>    <span class="dt">verbose =</span> <span class="ot">FALSE</span></span>
<span id="cb28-14"><a href="#cb28-14"></a>  )</span>
<span id="cb28-15"><a href="#cb28-15"></a></span>
<span id="cb28-16"><a href="#cb28-16"></a><span class="co"># plot</span></span>
<span id="cb28-17"><a href="#cb28-17"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb28-18"><a href="#cb28-18"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb28-19"><a href="#cb28-19"></a>  <span class="dt">title =</span> <span class="st">"generalized linear mixed models </span><span class="ch">\n</span><span class="st"> using Penalized Quasi-Likelihood"</span>,</span>
<span id="cb28-20"><a href="#cb28-20"></a>  <span class="dt">exclude.intercept =</span> <span class="ot">FALSE</span></span>
<span id="cb28-21"><a href="#cb28-21"></a>)</span>
<span id="cb28-22"><a href="#cb28-22"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/glmmPQL-1.png" width="576"></p>
</div>
<div id="generalized-linear-mixed-models-using-template-model-builder-glmmtmb" class="section level2">
<h2 class="hasAnchor">
<a href="#generalized-linear-mixed-models-using-template-model-builder-glmmtmb" class="anchor"></a>generalized linear mixed models using Template Model Builder (<code>glmmTMB</code>)</h2>
<p><code>glmmTMB</code> package allows for flexibly fitting generalized linear mixed models (GLMMs) and extensions. Model objects from this package are also supported.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="co"># set up</span></span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(glmmTMB)</span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(lme4)</span>
<span id="cb29-4"><a href="#cb29-4"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb29-5"><a href="#cb29-5"></a></span>
<span id="cb29-6"><a href="#cb29-6"></a><span class="co"># model</span></span>
<span id="cb29-7"><a href="#cb29-7"></a>mod &lt;-</span>
<span id="cb29-8"><a href="#cb29-8"></a><span class="st">  </span>glmmTMB<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/glmmTMB/man/glmmTMB.html">glmmTMB</a></span>(</span>
<span id="cb29-9"><a href="#cb29-9"></a>    <span class="dt">formula =</span> Reaction <span class="op">~</span><span class="st"> </span>Days <span class="op">+</span><span class="st"> </span>(Days <span class="op">|</span><span class="st"> </span>Subject),</span>
<span id="cb29-10"><a href="#cb29-10"></a>    <span class="dt">data =</span> sleepstudy,</span>
<span id="cb29-11"><a href="#cb29-11"></a>    <span class="dt">family =</span> glmmTMB<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/glmmTMB/man/nbinom2.html">truncated_poisson</a></span>()</span>
<span id="cb29-12"><a href="#cb29-12"></a>  )</span>
<span id="cb29-13"><a href="#cb29-13"></a></span>
<span id="cb29-14"><a href="#cb29-14"></a><span class="co"># plotting the model</span></span>
<span id="cb29-15"><a href="#cb29-15"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb29-16"><a href="#cb29-16"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb29-17"><a href="#cb29-17"></a>  <span class="dt">conf.method =</span> <span class="st">"uniroot"</span>,</span>
<span id="cb29-18"><a href="#cb29-18"></a>  <span class="dt">title =</span> <span class="st">"generalized linear mixed models </span><span class="ch">\n</span><span class="st">using Template Model Builder"</span></span>
<span id="cb29-19"><a href="#cb29-19"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/glmmTMB-1.png" width="576"></p>
</div>
<div id="generalized-linear-mixed-models-using-ad-model-builder-glmmadmb" class="section level2">
<h2 class="hasAnchor">
<a href="#generalized-linear-mixed-models-using-ad-model-builder-glmmadmb" class="anchor"></a>generalized linear mixed models using AD Model Builder (<code>glmmadmb</code>)</h2>
<p>Another option is to use <code>glmmadmb</code> package.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="co"># setup</span></span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(glmmADMB)</span>
<span id="cb30-3"><a href="#cb30-3"></a></span>
<span id="cb30-4"><a href="#cb30-4"></a><span class="co"># simulate values</span></span>
<span id="cb30-5"><a href="#cb30-5"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">101</span>)</span>
<span id="cb30-6"><a href="#cb30-6"></a>d &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">f =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>], <span class="dt">each =</span> <span class="dv">10</span>)), <span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="dv">100</span>))</span>
<span id="cb30-7"><a href="#cb30-7"></a>u &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dv">10</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</span>
<span id="cb30-8"><a href="#cb30-8"></a>d<span class="op">$</span>eta &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/with.html">with</a></span>(d, u[f] <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span>x)</span>
<span id="cb30-9"><a href="#cb30-9"></a>pz &lt;-<span class="st"> </span><span class="fl">0.3</span></span>
<span id="cb30-10"><a href="#cb30-10"></a>zi &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(<span class="dv">100</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> pz)</span>
<span id="cb30-11"><a href="#cb30-11"></a>d<span class="op">$</span>y &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(zi, <span class="dv">0</span>, <span class="kw"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span>(<span class="dv">100</span>, <span class="dt">lambda =</span> <span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(d<span class="op">$</span>eta)))</span>
<span id="cb30-12"><a href="#cb30-12"></a></span>
<span id="cb30-13"><a href="#cb30-13"></a><span class="co"># fit</span></span>
<span id="cb30-14"><a href="#cb30-14"></a>zipmodel &lt;-</span>
<span id="cb30-15"><a href="#cb30-15"></a><span class="st">  </span>glmmADMB<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/glmmADMB/man/glmm.admb.html">glmmadmb</a></span>(</span>
<span id="cb30-16"><a href="#cb30-16"></a>    <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>f),</span>
<span id="cb30-17"><a href="#cb30-17"></a>    <span class="dt">data =</span> d,</span>
<span id="cb30-18"><a href="#cb30-18"></a>    <span class="dt">family =</span> <span class="st">"poisson"</span>,</span>
<span id="cb30-19"><a href="#cb30-19"></a>    <span class="dt">zeroInflation =</span> <span class="ot">TRUE</span></span>
<span id="cb30-20"><a href="#cb30-20"></a>  )</span>
<span id="cb30-21"><a href="#cb30-21"></a></span>
<span id="cb30-22"><a href="#cb30-22"></a><span class="co"># plotting the model</span></span>
<span id="cb30-23"><a href="#cb30-23"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb30-24"><a href="#cb30-24"></a>  <span class="dt">x =</span> zipmodel,</span>
<span id="cb30-25"><a href="#cb30-25"></a>  <span class="dt">title =</span> <span class="st">"generalized linear mixed models </span><span class="ch">\n</span><span class="st">using AD Model Builder"</span></span>
<span id="cb30-26"><a href="#cb30-26"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/glmmadmb-1.png" width="480"></p>
</div>
<div id="cumulative-link-models-clm" class="section level2">
<h2 class="hasAnchor">
<a href="#cumulative-link-models-clm" class="anchor"></a>cumulative link models (<code>clm</code>)</h2>
<p>So far we have dealt either with continuous or nominal/factor responses (or output variables), but sometimes we will encounter <strong>ordinal</strong> data (e.g., Likert scale measurement in behavioral sciences). In these cases, ordinal regression models are more suitable. To study these models, we will use <code>intent_morality</code> dataset included in the <code>ggstatsplot</code> package. This dataset contains moral judgments (“how wrong was this behavior?”, “how much punishment does the agent deserve?”; on a Likert scale of 1-7) by participants about third-party actors who harmed someone. There are four different conditions formed out of belief (neutral, negative) and outcome (neutral, negative) for four different vignettes, each featuring a different type of harm. The question we are interested in is what explains variation in participants’ rating: information about intentionality, consequences, or their interaction?</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb31-3"><a href="#cb31-3"></a></span>
<span id="cb31-4"><a href="#cb31-4"></a><span class="co"># model (to speed up calculations, we will use just 10% of the dataset)</span></span>
<span id="cb31-5"><a href="#cb31-5"></a>mod &lt;-<span class="st"> </span>ordinal<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ordinal/man/clm.html">clm</a></span>(</span>
<span id="cb31-6"><a href="#cb31-6"></a>  <span class="dt">formula =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(rating) <span class="op">~</span><span class="st"> </span>belief <span class="op">*</span><span class="st"> </span>outcome,</span>
<span id="cb31-7"><a href="#cb31-7"></a>  <span class="dt">link =</span> <span class="st">"logit"</span>,</span>
<span id="cb31-8"><a href="#cb31-8"></a>  <span class="dt">data =</span> dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/sample.html">sample_frac</a></span>(<span class="dt">tbl =</span> ggstatsplot<span class="op">::</span>intent_morality, <span class="dt">size =</span> <span class="fl">0.10</span>),</span>
<span id="cb31-9"><a href="#cb31-9"></a>  <span class="dt">control =</span> ordinal<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ordinal/man/clm.control.html">clm.control</a></span>(</span>
<span id="cb31-10"><a href="#cb31-10"></a>    <span class="dt">maxIter =</span> <span class="dv">50</span>,</span>
<span id="cb31-11"><a href="#cb31-11"></a>    <span class="dt">convergence =</span> <span class="st">"silent"</span></span>
<span id="cb31-12"><a href="#cb31-12"></a>  )</span>
<span id="cb31-13"><a href="#cb31-13"></a>)</span>
<span id="cb31-14"><a href="#cb31-14"></a></span>
<span id="cb31-15"><a href="#cb31-15"></a><span class="co"># plot</span></span>
<span id="cb31-16"><a href="#cb31-16"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb31-17"><a href="#cb31-17"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb31-18"><a href="#cb31-18"></a>  <span class="dt">stats.label.color =</span> <span class="st">"black"</span>,</span>
<span id="cb31-19"><a href="#cb31-19"></a>  <span class="dt">title =</span> <span class="st">"cumulative link model (clm)"</span>,</span>
<span id="cb31-20"><a href="#cb31-20"></a>  <span class="dt">subtitle =</span> <span class="st">"(using `ordinal` package)"</span></span>
<span id="cb31-21"><a href="#cb31-21"></a>) <span class="op">+</span></span>
<span id="cb31-22"><a href="#cb31-22"></a><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">x =</span> <span class="st">"logit regression coefficient"</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/clm-1.png" width="768"></p>
<p>As can be seen from this plot, both factors (intentionality and consequences) were significant, and so was their interaction.</p>
</div>
<div id="cumulative-link-models-clm2" class="section level2">
<h2 class="hasAnchor">
<a href="#cumulative-link-models-clm2" class="anchor"></a>cumulative link models (<code>clm2</code>)</h2>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ordinal)</span>
<span id="cb32-4"><a href="#cb32-4"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(MASS)</span>
<span id="cb32-5"><a href="#cb32-5"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(housing, <span class="dt">package =</span> <span class="st">"MASS"</span>)</span>
<span id="cb32-6"><a href="#cb32-6"></a></span>
<span id="cb32-7"><a href="#cb32-7"></a><span class="co"># data</span></span>
<span id="cb32-8"><a href="#cb32-8"></a>tab26 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/with.html">with</a></span>(soup, <span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="st">"Product"</span> =<span class="st"> </span>PROD, <span class="st">"Response"</span> =<span class="st"> </span>SURENESS))</span>
<span id="cb32-9"><a href="#cb32-9"></a><span class="kw"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span>(tab26)[[<span class="dv">2</span>]] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Sure"</span>, <span class="st">"Not Sure"</span>, <span class="st">"Guess"</span>, <span class="st">"Guess"</span>, <span class="st">"Not Sure"</span>, <span class="st">"Sure"</span>)</span>
<span id="cb32-10"><a href="#cb32-10"></a>dat26 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span>(<span class="dt">sureness =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">prod =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Ref"</span>, <span class="st">"Test"</span>))</span>
<span id="cb32-11"><a href="#cb32-11"></a>dat26<span class="op">$</span>wghts &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(tab26))</span>
<span id="cb32-12"><a href="#cb32-12"></a></span>
<span id="cb32-13"><a href="#cb32-13"></a><span class="co"># model</span></span>
<span id="cb32-14"><a href="#cb32-14"></a>mod &lt;-</span>
<span id="cb32-15"><a href="#cb32-15"></a><span class="st">  </span><span class="kw">clm2</span>(</span>
<span id="cb32-16"><a href="#cb32-16"></a>    <span class="dt">location =</span> sureness <span class="op">~</span><span class="st"> </span>prod,</span>
<span id="cb32-17"><a href="#cb32-17"></a>    <span class="dt">scale =</span> <span class="op">~</span>prod,</span>
<span id="cb32-18"><a href="#cb32-18"></a>    <span class="dt">data =</span> dat26,</span>
<span id="cb32-19"><a href="#cb32-19"></a>    <span class="dt">weights =</span> wghts,</span>
<span id="cb32-20"><a href="#cb32-20"></a>    <span class="dt">link =</span> <span class="st">"logistic"</span></span>
<span id="cb32-21"><a href="#cb32-21"></a>  )</span>
<span id="cb32-22"><a href="#cb32-22"></a></span>
<span id="cb32-23"><a href="#cb32-23"></a><span class="co"># plot</span></span>
<span id="cb32-24"><a href="#cb32-24"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb32-25"><a href="#cb32-25"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb32-26"><a href="#cb32-26"></a>  <span class="dt">title =</span> <span class="st">"older version of `clm`"</span></span>
<span id="cb32-27"><a href="#cb32-27"></a>)</span></code></pre></div>
</div>
<div id="cumulative-link-mixed-models-clmm" class="section level2">
<h2 class="hasAnchor">
<a href="#cumulative-link-mixed-models-clmm" class="anchor"></a>cumulative link mixed models (<code>clmm</code>)</h2>
<p>In the previous analysis, we carried out a single ordinal regression models to see the effects intent and outcome information on moral judgments. But what if we also want to account for item level differences (since different items had different types of harm)? For this, we can use ordinal mixed-effects regression model (with random effects for type of harm) to see how intent and outcome contribute towards variation in moral judgment ratings-</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb33-3"><a href="#cb33-3"></a></span>
<span id="cb33-4"><a href="#cb33-4"></a><span class="co"># to speed up calculations, we will use just 10% of the dataset</span></span>
<span id="cb33-5"><a href="#cb33-5"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb33-6"><a href="#cb33-6"></a>  <span class="dt">x =</span> ordinal<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ordinal/man/clmm.html">clmm</a></span>(</span>
<span id="cb33-7"><a href="#cb33-7"></a>    <span class="dt">formula =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(rating) <span class="op">~</span><span class="st"> </span>belief <span class="op">*</span><span class="st"> </span>outcome <span class="op">+</span><span class="st"> </span>(belief <span class="op">+</span><span class="st"> </span>outcome <span class="op">|</span></span>
<span id="cb33-8"><a href="#cb33-8"></a><span class="st">      </span>harm),</span>
<span id="cb33-9"><a href="#cb33-9"></a>    <span class="dt">data =</span> dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/sample.html">sample_frac</a></span>(<span class="dt">tbl =</span> ggstatsplot<span class="op">::</span>intent_morality, <span class="dt">size =</span> <span class="fl">0.10</span>),</span>
<span id="cb33-10"><a href="#cb33-10"></a>    <span class="dt">control =</span> ordinal<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ordinal/man/clmm.control.html">clmm.control</a></span>(</span>
<span id="cb33-11"><a href="#cb33-11"></a>      <span class="dt">method =</span> <span class="st">"nlminb"</span>,</span>
<span id="cb33-12"><a href="#cb33-12"></a>      <span class="dt">maxIter =</span> <span class="dv">50</span>,</span>
<span id="cb33-13"><a href="#cb33-13"></a>      <span class="dt">gradTol =</span> <span class="fl">1e-4</span>,</span>
<span id="cb33-14"><a href="#cb33-14"></a>      <span class="dt">innerCtrl =</span> <span class="st">"noWarn"</span></span>
<span id="cb33-15"><a href="#cb33-15"></a>    )</span>
<span id="cb33-16"><a href="#cb33-16"></a>  ),</span>
<span id="cb33-17"><a href="#cb33-17"></a>  <span class="dt">title =</span> <span class="st">"cumulative link mixed model (clmm)"</span>,</span>
<span id="cb33-18"><a href="#cb33-18"></a>  <span class="dt">subtitle =</span> <span class="st">"(using `ordinal` package)"</span></span>
<span id="cb33-19"><a href="#cb33-19"></a>) <span class="op">+</span></span>
<span id="cb33-20"><a href="#cb33-20"></a><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(</span>
<span id="cb33-21"><a href="#cb33-21"></a>    <span class="dt">x =</span> <span class="st">"coefficient from ordinal mixed-effects regression"</span>,</span>
<span id="cb33-22"><a href="#cb33-22"></a>    <span class="dt">y =</span> <span class="st">"fixed effects"</span></span>
<span id="cb33-23"><a href="#cb33-23"></a>  )</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/clmm1-1.png" width="576"></p>
<p>Mixed effects regression didn’t reveal any interaction effect. That is, most of the variance was accounted for by the information about whether there was harmful intent and whether there was harm, at least this is the effect we found with these four types of (minor) harms.</p>
<p>Note that, by default, <code>beta</code> parameters are shown for <code>clm</code> and <code>clmm</code> models, but you can also plot either just <code>alpha</code> or <code>both</code> using <code>ggcoefstats</code>.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb34-3"><a href="#cb34-3"></a></span>
<span id="cb34-4"><a href="#cb34-4"></a><span class="co"># model</span></span>
<span id="cb34-5"><a href="#cb34-5"></a>mod &lt;-</span>
<span id="cb34-6"><a href="#cb34-6"></a><span class="st">  </span>ordinal<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ordinal/man/clmm.html">clmm</a></span>(</span>
<span id="cb34-7"><a href="#cb34-7"></a>    <span class="dt">formula =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(rating) <span class="op">~</span><span class="st"> </span>belief <span class="op">*</span><span class="st"> </span>outcome <span class="op">+</span><span class="st"> </span>(belief <span class="op">+</span><span class="st"> </span>outcome <span class="op">|</span><span class="st"> </span>harm),</span>
<span id="cb34-8"><a href="#cb34-8"></a>    <span class="dt">link =</span> <span class="st">"logit"</span>,</span>
<span id="cb34-9"><a href="#cb34-9"></a>    <span class="dt">data =</span> dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/sample.html">sample_frac</a></span>(<span class="dt">tbl =</span> ggstatsplot<span class="op">::</span>intent_morality, <span class="dt">size =</span> <span class="fl">0.10</span>),</span>
<span id="cb34-10"><a href="#cb34-10"></a>    <span class="dt">control =</span> ordinal<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ordinal/man/clmm.control.html">clmm.control</a></span>(</span>
<span id="cb34-11"><a href="#cb34-11"></a>      <span class="dt">maxIter =</span> <span class="dv">50</span>,</span>
<span id="cb34-12"><a href="#cb34-12"></a>      <span class="dt">gradTol =</span> <span class="fl">1e-4</span>,</span>
<span id="cb34-13"><a href="#cb34-13"></a>      <span class="dt">innerCtrl =</span> <span class="st">"noWarn"</span></span>
<span id="cb34-14"><a href="#cb34-14"></a>    )</span>
<span id="cb34-15"><a href="#cb34-15"></a>  )</span>
<span id="cb34-16"><a href="#cb34-16"></a></span>
<span id="cb34-17"><a href="#cb34-17"></a><span class="co"># plot</span></span>
<span id="cb34-18"><a href="#cb34-18"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(mod) <span class="op">+</span></span>
<span id="cb34-19"><a href="#cb34-19"></a><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(</span>
<span id="cb34-20"><a href="#cb34-20"></a>    <span class="dt">x =</span> <span class="st">"logit regression coefficients"</span>,</span>
<span id="cb34-21"><a href="#cb34-21"></a>    <span class="dt">y =</span> <span class="st">"threshold parameters"</span>,</span>
<span id="cb34-22"><a href="#cb34-22"></a>    <span class="dt">title =</span> <span class="st">"cumulative link mixed models"</span></span>
<span id="cb34-23"><a href="#cb34-23"></a>  )</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/clmm2-1.png" width="576"></p>
</div>
<div id="mixed-effects-ordinal-regression-analysis-mixor" class="section level2">
<h2 class="hasAnchor">
<a href="#mixed-effects-ordinal-regression-analysis-mixor" class="anchor"></a>Mixed-Effects Ordinal Regression Analysis (<code>mixor</code>)</h2>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co"># setup</span></span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(mixor)</span>
<span id="cb35-4"><a href="#cb35-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"SmokingPrevention"</span>)</span>
<span id="cb35-5"><a href="#cb35-5"></a></span>
<span id="cb35-6"><a href="#cb35-6"></a><span class="co"># data frame must be sorted by id variable</span></span>
<span id="cb35-7"><a href="#cb35-7"></a>SmokingPrevention &lt;-<span class="st"> </span>SmokingPrevention[<span class="kw"><a href="https://rdrr.io/r/base/order.html">order</a></span>(SmokingPrevention<span class="op">$</span>class), ]</span>
<span id="cb35-8"><a href="#cb35-8"></a></span>
<span id="cb35-9"><a href="#cb35-9"></a><span class="co"># school model</span></span>
<span id="cb35-10"><a href="#cb35-10"></a>mod &lt;-</span>
<span id="cb35-11"><a href="#cb35-11"></a><span class="st">  </span><span class="kw">mixor</span>(</span>
<span id="cb35-12"><a href="#cb35-12"></a>    <span class="dt">formula =</span> thksord <span class="op">~</span><span class="st"> </span>thkspre <span class="op">+</span><span class="st"> </span>cc <span class="op">+</span><span class="st"> </span>tv <span class="op">+</span><span class="st"> </span>cctv,</span>
<span id="cb35-13"><a href="#cb35-13"></a>    <span class="dt">data =</span> SmokingPrevention,</span>
<span id="cb35-14"><a href="#cb35-14"></a>    <span class="dt">id =</span> school,</span>
<span id="cb35-15"><a href="#cb35-15"></a>    <span class="dt">link =</span> <span class="st">"logit"</span></span>
<span id="cb35-16"><a href="#cb35-16"></a>  )</span>
<span id="cb35-17"><a href="#cb35-17"></a></span>
<span id="cb35-18"><a href="#cb35-18"></a><span class="co"># plot</span></span>
<span id="cb35-19"><a href="#cb35-19"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb35-20"><a href="#cb35-20"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb35-21"><a href="#cb35-21"></a>  <span class="dt">title =</span> <span class="st">"Mixed-Effects Ordinal Regression Analysis"</span>,</span>
<span id="cb35-22"><a href="#cb35-22"></a>  <span class="dt">exclude.intercept =</span> <span class="ot">FALSE</span></span>
<span id="cb35-23"><a href="#cb35-23"></a>)</span>
<span id="cb35-24"><a href="#cb35-24"></a><span class="co">#&gt; </span></span>
<span id="cb35-25"><a href="#cb35-25"></a><span class="co">#&gt; Call:</span></span>
<span id="cb35-26"><a href="#cb35-26"></a><span class="co">#&gt; mixor(formula = thksord ~ thkspre + cc + tv + cctv, data = SmokingPrevention, </span></span>
<span id="cb35-27"><a href="#cb35-27"></a><span class="co">#&gt;     id = school, link = "logit")</span></span>
<span id="cb35-28"><a href="#cb35-28"></a><span class="co">#&gt; </span></span>
<span id="cb35-29"><a href="#cb35-29"></a><span class="co">#&gt; Deviance =         4239.486 </span></span>
<span id="cb35-30"><a href="#cb35-30"></a><span class="co">#&gt; Log-likelihood =  -2119.743 </span></span>
<span id="cb35-31"><a href="#cb35-31"></a><span class="co">#&gt; RIDGEMAX =         0.2 </span></span>
<span id="cb35-32"><a href="#cb35-32"></a><span class="co">#&gt; AIC =             -2127.743 </span></span>
<span id="cb35-33"><a href="#cb35-33"></a><span class="co">#&gt; SBC =             -2133.072 </span></span>
<span id="cb35-34"><a href="#cb35-34"></a><span class="co">#&gt; </span></span>
<span id="cb35-35"><a href="#cb35-35"></a><span class="co">#&gt;                     Estimate Std. Error z value P(&gt;|z|)    </span></span>
<span id="cb35-36"><a href="#cb35-36"></a><span class="co">#&gt; (Intercept)         0.088180   0.313111  0.2816 0.77823    </span></span>
<span id="cb35-37"><a href="#cb35-37"></a><span class="co">#&gt; thkspre             0.403280   0.042928  9.3944 &lt; 2e-16 ***</span></span>
<span id="cb35-38"><a href="#cb35-38"></a><span class="co">#&gt; cc                  0.924101   0.371345  2.4885 0.01283 *  </span></span>
<span id="cb35-39"><a href="#cb35-39"></a><span class="co">#&gt; tv                  0.275213   0.315155  0.8733 0.38252    </span></span>
<span id="cb35-40"><a href="#cb35-40"></a><span class="co">#&gt; cctv               -0.466194   0.406211 -1.1477 0.25111    </span></span>
<span id="cb35-41"><a href="#cb35-41"></a><span class="co">#&gt; Random.(Intercept)  0.073498   0.049480  1.4854 0.13743    </span></span>
<span id="cb35-42"><a href="#cb35-42"></a><span class="co">#&gt; Threshold2          1.241768   0.088310 14.0614 &lt; 2e-16 ***</span></span>
<span id="cb35-43"><a href="#cb35-43"></a><span class="co">#&gt; Threshold3          2.420359   0.083617 28.9456 &lt; 2e-16 ***</span></span>
<span id="cb35-44"><a href="#cb35-44"></a><span class="co">#&gt; ---</span></span>
<span id="cb35-45"><a href="#cb35-45"></a><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/mixor-1.png" width="576"></p>
</div>
<div id="bias-reduction-in-generalized-linear-models-brglm2" class="section level2">
<h2 class="hasAnchor">
<a href="#bias-reduction-in-generalized-linear-models-brglm2" class="anchor"></a>bias reduction in generalized linear models (<code>brglm2</code>)</h2>
<p>Note that we can also choose to display labels only for the significant effects. This can be helpful when a large number of regression coefficients are to be displayed in a single plot and we would like to focus only on the significant ones.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="co"># setup</span></span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb36-3"><a href="#cb36-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(brglm2)</span>
<span id="cb36-4"><a href="#cb36-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"lizards"</span>)</span>
<span id="cb36-5"><a href="#cb36-5"></a></span>
<span id="cb36-6"><a href="#cb36-6"></a><span class="co"># fit the model using maximum likelihood mean bias-reduced fit:</span></span>
<span id="cb36-7"><a href="#cb36-7"></a>lizardsBR_mean &lt;-</span>
<span id="cb36-8"><a href="#cb36-8"></a><span class="st">  </span>stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span>(</span>
<span id="cb36-9"><a href="#cb36-9"></a>    <span class="dt">formula =</span> <span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(grahami, opalinus) <span class="op">~</span><span class="st"> </span>height <span class="op">+</span><span class="st"> </span>diameter <span class="op">+</span><span class="st"> </span>light <span class="op">+</span><span class="st"> </span>time,</span>
<span id="cb36-10"><a href="#cb36-10"></a>    <span class="dt">family =</span> <span class="kw"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span>(logit),</span>
<span id="cb36-11"><a href="#cb36-11"></a>    <span class="dt">data =</span> lizards,</span>
<span id="cb36-12"><a href="#cb36-12"></a>    <span class="dt">method =</span> <span class="st">"brglmFit"</span></span>
<span id="cb36-13"><a href="#cb36-13"></a>  )</span>
<span id="cb36-14"><a href="#cb36-14"></a></span>
<span id="cb36-15"><a href="#cb36-15"></a><span class="co"># plot</span></span>
<span id="cb36-16"><a href="#cb36-16"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb36-17"><a href="#cb36-17"></a>  <span class="dt">x =</span> lizardsBR_mean,</span>
<span id="cb36-18"><a href="#cb36-18"></a>  <span class="dt">only.significant =</span> <span class="ot">TRUE</span>,</span>
<span id="cb36-19"><a href="#cb36-19"></a>  <span class="dt">title =</span> <span class="st">"bias reduction in generalized linear models"</span></span>
<span id="cb36-20"><a href="#cb36-20"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/brglm-1.png" width="480"></p>
</div>
<div id="bias-reduction-for-adjacent-category-logit-models-bracl" class="section level2">
<h2 class="hasAnchor">
<a href="#bias-reduction-for-adjacent-category-logit-models-bracl" class="anchor"></a>bias reduction for adjacent category logit models (<code>bracl</code>)</h2>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="co"># setup</span></span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb37-3"><a href="#cb37-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(brglm2)</span>
<span id="cb37-4"><a href="#cb37-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"stemcell"</span>)</span>
<span id="cb37-5"><a href="#cb37-5"></a></span>
<span id="cb37-6"><a href="#cb37-6"></a><span class="co"># bias reduction for adjacent category logit models</span></span>
<span id="cb37-7"><a href="#cb37-7"></a><span class="co"># for ordinal responses using the Poisson trick</span></span>
<span id="cb37-8"><a href="#cb37-8"></a>fit_bracl &lt;-</span>
<span id="cb37-9"><a href="#cb37-9"></a><span class="st">  </span>brglm2<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/brglm2/man/bracl.html">bracl</a></span>(</span>
<span id="cb37-10"><a href="#cb37-10"></a>    <span class="dt">formula =</span> research <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(religion) <span class="op">+</span><span class="st"> </span>gender,</span>
<span id="cb37-11"><a href="#cb37-11"></a>    <span class="dt">weights =</span> frequency,</span>
<span id="cb37-12"><a href="#cb37-12"></a>    <span class="dt">data =</span> stemcell,</span>
<span id="cb37-13"><a href="#cb37-13"></a>    <span class="dt">type =</span> <span class="st">"ML"</span></span>
<span id="cb37-14"><a href="#cb37-14"></a>  )</span>
<span id="cb37-15"><a href="#cb37-15"></a></span>
<span id="cb37-16"><a href="#cb37-16"></a><span class="co"># plot</span></span>
<span id="cb37-17"><a href="#cb37-17"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb37-18"><a href="#cb37-18"></a>  <span class="dt">x =</span> fit_bracl,</span>
<span id="cb37-19"><a href="#cb37-19"></a>  <span class="dt">conf.int =</span> <span class="ot">FALSE</span>,</span>
<span id="cb37-20"><a href="#cb37-20"></a>  <span class="dt">title =</span> <span class="st">"bias reduction for adjacent category logit models"</span></span>
<span id="cb37-21"><a href="#cb37-21"></a>)</span>
<span id="cb37-22"><a href="#cb37-22"></a><span class="co">#&gt; Can't calculate proper scoring rules for ordinal, multinomial or cumulative link models.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/bracl-1.png" width="672"></p>
</div>
<div id="generalized-linear-models-subject-to-population-constraints" class="section level2">
<h2 class="hasAnchor">
<a href="#generalized-linear-models-subject-to-population-constraints" class="anchor"></a>generalized linear models subject to population constraints</h2>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="co"># setup</span></span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb38-3"><a href="#cb38-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(glmc)</span>
<span id="cb38-4"><a href="#cb38-4"></a></span>
<span id="cb38-5"><a href="#cb38-5"></a><span class="co"># data</span></span>
<span id="cb38-6"><a href="#cb38-6"></a>n &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">5903</span>, <span class="dv">230</span>), <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">5157</span>, <span class="dv">350</span>))</span>
<span id="cb38-7"><a href="#cb38-7"></a>mat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="dv">0</span>, <span class="dt">nrow =</span> <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(n), <span class="dt">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb38-8"><a href="#cb38-8"></a>mat &lt;-</span>
<span id="cb38-9"><a href="#cb38-9"></a><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(</span>
<span id="cb38-10"><a href="#cb38-10"></a>    <span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="dv">1</span>, <span class="dt">nrow =</span> n[<span class="dv">1</span>, <span class="dv">1</span>], <span class="dt">ncol =</span> <span class="dv">1</span>) <span class="op">%*%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb38-11"><a href="#cb38-11"></a>    <span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="dv">1</span>, <span class="dt">nrow =</span> n[<span class="dv">1</span>, <span class="dv">2</span>], <span class="dt">ncol =</span> <span class="dv">1</span>) <span class="op">%*%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb38-12"><a href="#cb38-12"></a>    <span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="dv">1</span>, <span class="dt">nrow =</span> n[<span class="dv">2</span>, <span class="dv">1</span>], <span class="dt">ncol =</span> <span class="dv">1</span>) <span class="op">%*%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb38-13"><a href="#cb38-13"></a>    <span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="dv">1</span>, <span class="dt">nrow =</span> n[<span class="dv">2</span>, <span class="dv">2</span>], <span class="dt">ncol =</span> <span class="dv">1</span>) <span class="op">%*%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb38-14"><a href="#cb38-14"></a>  )</span>
<span id="cb38-15"><a href="#cb38-15"></a></span>
<span id="cb38-16"><a href="#cb38-16"></a><span class="co"># specifying the population constraints</span></span>
<span id="cb38-17"><a href="#cb38-17"></a>gfr &lt;-<span class="st"> </span><span class="fl">.06179</span> <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="dv">1</span>, <span class="dt">nrow =</span> <span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(mat), <span class="dt">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb38-18"><a href="#cb38-18"></a>g &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="dv">1</span>, <span class="dt">nrow =</span> <span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(mat), <span class="dt">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb38-19"><a href="#cb38-19"></a>amat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(mat[, <span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>g <span class="op">-</span><span class="st"> </span>gfr, <span class="dt">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb38-20"><a href="#cb38-20"></a></span>
<span id="cb38-21"><a href="#cb38-21"></a><span class="co"># defining constraints in the data frame.</span></span>
<span id="cb38-22"><a href="#cb38-22"></a>hrh &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">birth =</span> mat[, <span class="dv">2</span>], <span class="dt">child =</span> mat[, <span class="dv">1</span>], <span class="dt">constraints =</span> amat)</span>
<span id="cb38-23"><a href="#cb38-23"></a></span>
<span id="cb38-24"><a href="#cb38-24"></a><span class="co"># model</span></span>
<span id="cb38-25"><a href="#cb38-25"></a>gfit &lt;-</span>
<span id="cb38-26"><a href="#cb38-26"></a><span class="st">  </span>glmc<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/glmc/man/glmc.html">glmc</a></span>(</span>
<span id="cb38-27"><a href="#cb38-27"></a>    <span class="dt">formula =</span> birth <span class="op">~</span><span class="st"> </span>child,</span>
<span id="cb38-28"><a href="#cb38-28"></a>    <span class="dt">data =</span> hrh,</span>
<span id="cb38-29"><a href="#cb38-29"></a>    <span class="dt">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb38-30"><a href="#cb38-30"></a>    <span class="dt">emplik.method =</span> <span class="st">"Owen"</span>,</span>
<span id="cb38-31"><a href="#cb38-31"></a>    <span class="dt">control =</span> glmc<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/glmc/man/glmc.control.html">glmc.control</a></span>(</span>
<span id="cb38-32"><a href="#cb38-32"></a>      <span class="dt">trace.optim =</span> <span class="dv">0</span>,</span>
<span id="cb38-33"><a href="#cb38-33"></a>      <span class="dt">trace.glm =</span> <span class="ot">FALSE</span>,</span>
<span id="cb38-34"><a href="#cb38-34"></a>      <span class="dt">maxit.glm =</span> <span class="dv">10</span>,</span>
<span id="cb38-35"><a href="#cb38-35"></a>      <span class="dt">maxit.weights =</span> <span class="dv">200</span>,</span>
<span id="cb38-36"><a href="#cb38-36"></a>      <span class="dt">itertrace.weights =</span> <span class="ot">TRUE</span>,</span>
<span id="cb38-37"><a href="#cb38-37"></a>      <span class="dt">gradtol.weights =</span> <span class="dv">10</span><span class="op">^</span>(<span class="op">-</span><span class="dv">6</span>)</span>
<span id="cb38-38"><a href="#cb38-38"></a>    )</span>
<span id="cb38-39"><a href="#cb38-39"></a>  )</span>
<span id="cb38-40"><a href="#cb38-40"></a><span class="co">#&gt; [1]   -0.02656434  -14.43904679 1320.26413390    1.00000000</span></span>
<span id="cb38-41"><a href="#cb38-41"></a><span class="co">#&gt; [1]  -0.0220031 -15.3239529 375.8086391   1.0000000</span></span>
<span id="cb38-42"><a href="#cb38-42"></a><span class="co">#&gt; [1]  -0.0217611 -15.3261430  18.0697997   1.0000000</span></span>
<span id="cb38-43"><a href="#cb38-43"></a><span class="co">#&gt; [1]  -0.02176048 -15.32614305   0.04572550   1.00000000</span></span>
<span id="cb38-44"><a href="#cb38-44"></a><span class="co">#&gt; [1] -2.176048e-02 -1.532614e+01  2.958267e-07  9.000000e+00</span></span>
<span id="cb38-45"><a href="#cb38-45"></a></span>
<span id="cb38-46"><a href="#cb38-46"></a><span class="co"># plot</span></span>
<span id="cb38-47"><a href="#cb38-47"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb38-48"><a href="#cb38-48"></a>  <span class="dt">x =</span> gfit,</span>
<span id="cb38-49"><a href="#cb38-49"></a>  <span class="dt">title =</span> <span class="st">"generalized linear models </span><span class="ch">\n</span><span class="st">subject to population constraints"</span>,</span>
<span id="cb38-50"><a href="#cb38-50"></a>  <span class="dt">conf.int =</span> <span class="ot">FALSE</span>,</span>
<span id="cb38-51"><a href="#cb38-51"></a>  <span class="dt">exclude.intercept =</span> <span class="ot">FALSE</span></span>
<span id="cb38-52"><a href="#cb38-52"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/glmc-1.png" width="576"></p>
</div>
<div id="bayesian-linear-linear-mixed-effects-models-blmermod" class="section level2">
<h2 class="hasAnchor">
<a href="#bayesian-linear-linear-mixed-effects-models-blmermod" class="anchor"></a>Bayesian linear linear mixed-effects models (<code>blmerMod</code>)</h2>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(blme)</span>
<span id="cb39-4"><a href="#cb39-4"></a></span>
<span id="cb39-5"><a href="#cb39-5"></a><span class="co"># data</span></span>
<span id="cb39-6"><a href="#cb39-6"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(sleepstudy)</span>
<span id="cb39-7"><a href="#cb39-7"></a>sleepstudy<span class="op">$</span>mygrp &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">size =</span> <span class="dv">180</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb39-8"><a href="#cb39-8"></a>sleepstudy<span class="op">$</span>mysubgrp &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb39-9"><a href="#cb39-9"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) {</span>
<span id="cb39-10"><a href="#cb39-10"></a>  filter_group &lt;-<span class="st"> </span>sleepstudy<span class="op">$</span>mygrp <span class="op">==</span><span class="st"> </span>i</span>
<span id="cb39-11"><a href="#cb39-11"></a>  sleepstudy<span class="op">$</span>mysubgrp[filter_group] &lt;-</span>
<span id="cb39-12"><a href="#cb39-12"></a><span class="st">    </span><span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>, <span class="dt">size =</span> <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(filter_group), <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb39-13"><a href="#cb39-13"></a>}</span>
<span id="cb39-14"><a href="#cb39-14"></a></span>
<span id="cb39-15"><a href="#cb39-15"></a><span class="co"># model</span></span>
<span id="cb39-16"><a href="#cb39-16"></a>mod &lt;-</span>
<span id="cb39-17"><a href="#cb39-17"></a><span class="st">  </span>blme<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/blme/man/blmer.html">blmer</a></span>(</span>
<span id="cb39-18"><a href="#cb39-18"></a>    <span class="dt">formula =</span> <span class="kw"><a href="https://rdrr.io/r/base/scale.html">scale</a></span>(Reaction) <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/scale.html">scale</a></span>(Days) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Days <span class="op">|</span><span class="st"> </span>Subject),</span>
<span id="cb39-19"><a href="#cb39-19"></a>    <span class="dt">data =</span> sleepstudy,</span>
<span id="cb39-20"><a href="#cb39-20"></a>    <span class="dt">cov.prior =</span> <span class="ot">NULL</span>,</span>
<span id="cb39-21"><a href="#cb39-21"></a>    <span class="dt">REML =</span> <span class="ot">FALSE</span></span>
<span id="cb39-22"><a href="#cb39-22"></a>  )</span>
<span id="cb39-23"><a href="#cb39-23"></a></span>
<span id="cb39-24"><a href="#cb39-24"></a><span class="co"># plot</span></span>
<span id="cb39-25"><a href="#cb39-25"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb39-26"><a href="#cb39-26"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb39-27"><a href="#cb39-27"></a>  <span class="dt">title =</span> <span class="st">"Bayesian linear mixed-effects models"</span>,</span>
<span id="cb39-28"><a href="#cb39-28"></a>  <span class="dt">exclude.intercept =</span> <span class="ot">FALSE</span></span>
<span id="cb39-29"><a href="#cb39-29"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/blmerMod-1.png" width="480"></p>
</div>
<div id="bayesian-generalized-linear-mixed-effects-models-bglmermod" class="section level2">
<h2 class="hasAnchor">
<a href="#bayesian-generalized-linear-mixed-effects-models-bglmermod" class="anchor"></a>Bayesian generalized linear mixed-effects models (<code>bglmerMod</code>)</h2>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb40-3"><a href="#cb40-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(blme)</span>
<span id="cb40-4"><a href="#cb40-4"></a></span>
<span id="cb40-5"><a href="#cb40-5"></a><span class="co"># model</span></span>
<span id="cb40-6"><a href="#cb40-6"></a>mod &lt;-</span>
<span id="cb40-7"><a href="#cb40-7"></a><span class="st">  </span>blme<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/blme/man/blmer.html">bglmer</a></span>(</span>
<span id="cb40-8"><a href="#cb40-8"></a>    <span class="dt">formula =</span> Survived <span class="op">~</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>(Sex <span class="op">+</span><span class="st"> </span>Age <span class="op">|</span><span class="st"> </span>Class),</span>
<span id="cb40-9"><a href="#cb40-9"></a>    <span class="co"># select 20% of the sample to reduce the time of execution</span></span>
<span id="cb40-10"><a href="#cb40-10"></a>    <span class="dt">data =</span> dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/sample.html">sample_frac</a></span>(<span class="dt">tbl =</span> ggstatsplot<span class="op">::</span>Titanic_full, <span class="dt">size =</span> <span class="fl">0.2</span>),</span>
<span id="cb40-11"><a href="#cb40-11"></a>    <span class="dt">family =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span>(<span class="dt">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb40-12"><a href="#cb40-12"></a>    <span class="dt">control =</span> lme4<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html">glmerControl</a></span>(</span>
<span id="cb40-13"><a href="#cb40-13"></a>      <span class="dt">optimizer =</span> <span class="st">"Nelder_Mead"</span>,</span>
<span id="cb40-14"><a href="#cb40-14"></a>      <span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>,</span>
<span id="cb40-15"><a href="#cb40-15"></a>      <span class="dt">boundary.tol =</span> <span class="fl">1e-7</span></span>
<span id="cb40-16"><a href="#cb40-16"></a>    )</span>
<span id="cb40-17"><a href="#cb40-17"></a>  )</span>
<span id="cb40-18"><a href="#cb40-18"></a></span>
<span id="cb40-19"><a href="#cb40-19"></a><span class="co"># plot</span></span>
<span id="cb40-20"><a href="#cb40-20"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb40-21"><a href="#cb40-21"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb40-22"><a href="#cb40-22"></a>  <span class="dt">title =</span> <span class="st">"Bayesian generalized linear mixed-effects models"</span></span>
<span id="cb40-23"><a href="#cb40-23"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/bglmerMod-1.png" width="576"></p>
</div>
<div id="ordered-logistic-or-probit-regression-polr" class="section level2">
<h2 class="hasAnchor">
<a href="#ordered-logistic-or-probit-regression-polr" class="anchor"></a>ordered logistic or probit regression (<code>polr</code>)</h2>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="co"># polr model</span></span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb41-3"><a href="#cb41-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(MASS)</span>
<span id="cb41-4"><a href="#cb41-4"></a>polr.mod &lt;-</span>
<span id="cb41-5"><a href="#cb41-5"></a><span class="st">  </span>MASS<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/MASS/man/polr.html">polr</a></span>(</span>
<span id="cb41-6"><a href="#cb41-6"></a>    <span class="dt">formula =</span> Sat <span class="op">~</span><span class="st"> </span>Infl <span class="op">+</span><span class="st"> </span>Type <span class="op">+</span><span class="st"> </span>Cont,</span>
<span id="cb41-7"><a href="#cb41-7"></a>    <span class="dt">weights =</span> Freq,</span>
<span id="cb41-8"><a href="#cb41-8"></a>    <span class="dt">data =</span> housing</span>
<span id="cb41-9"><a href="#cb41-9"></a>  )</span>
<span id="cb41-10"><a href="#cb41-10"></a></span>
<span id="cb41-11"><a href="#cb41-11"></a><span class="co"># plot</span></span>
<span id="cb41-12"><a href="#cb41-12"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb41-13"><a href="#cb41-13"></a>  <span class="dt">x =</span> polr.mod,</span>
<span id="cb41-14"><a href="#cb41-14"></a>  <span class="dt">coefficient.type =</span> <span class="st">"both"</span>,</span>
<span id="cb41-15"><a href="#cb41-15"></a>  <span class="dt">title =</span> <span class="st">"ordered logistic or probit regression"</span>,</span>
<span id="cb41-16"><a href="#cb41-16"></a>  <span class="dt">subtitle =</span> <span class="st">"using `MASS` package"</span></span>
<span id="cb41-17"><a href="#cb41-17"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/polr-1.png" width="768"></p>
</div>
<div id="multiple-linear-regression-models-mlm" class="section level2">
<h2 class="hasAnchor">
<a href="#multiple-linear-regression-models-mlm" class="anchor"></a>multiple linear regression models (<code>mlm</code>)</h2>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="co"># model (converting all numeric columns in data to z-scores)</span></span>
<span id="cb42-2"><a href="#cb42-2"></a>mod &lt;-</span>
<span id="cb42-3"><a href="#cb42-3"></a><span class="st">  </span>stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(</span>
<span id="cb42-4"><a href="#cb42-4"></a>    <span class="dt">formula =</span> <span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(mpg, disp) <span class="op">~</span><span class="st"> </span>wt,</span>
<span id="cb42-5"><a href="#cb42-5"></a>    <span class="dt">data =</span> purrr<span class="op">::</span><span class="kw"><a href="https://purrr.tidyverse.org/reference/modify.html">modify_if</a></span>(<span class="dt">.x =</span> mtcars, <span class="dt">.p =</span> is.numeric, <span class="dt">.f =</span> scale)</span>
<span id="cb42-6"><a href="#cb42-6"></a>  )</span>
<span id="cb42-7"><a href="#cb42-7"></a></span>
<span id="cb42-8"><a href="#cb42-8"></a><span class="co"># plot</span></span>
<span id="cb42-9"><a href="#cb42-9"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb42-10"><a href="#cb42-10"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb42-11"><a href="#cb42-11"></a>  <span class="dt">exclude.intercept =</span> <span class="ot">FALSE</span></span>
<span id="cb42-12"><a href="#cb42-12"></a>)</span>
<span id="cb42-13"><a href="#cb42-13"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/mlm-1.png" width="480"></p>
</div>
<div id="multinomial-logistic-regression-models-multinom" class="section level2">
<h2 class="hasAnchor">
<a href="#multinomial-logistic-regression-models-multinom" class="anchor"></a>multinomial logistic regression models (<code>multinom</code>)</h2>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="co"># model</span></span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(nnet)</span>
<span id="cb43-4"><a href="#cb43-4"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(MASS)</span>
<span id="cb43-5"><a href="#cb43-5"></a>utils<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/utils/example.html">example</a></span>(<span class="dt">topic =</span> birthwt, <span class="dt">echo =</span> <span class="ot">FALSE</span>)</span>
<span id="cb43-6"><a href="#cb43-6"></a>bwt.mu &lt;-<span class="st"> </span>nnet<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/nnet/man/multinom.html">multinom</a></span>(<span class="dt">formula =</span> low <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> bwt, <span class="dt">trace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb43-7"><a href="#cb43-7"></a></span>
<span id="cb43-8"><a href="#cb43-8"></a><span class="co"># plot</span></span>
<span id="cb43-9"><a href="#cb43-9"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb43-10"><a href="#cb43-10"></a>  <span class="dt">x =</span> bwt.mu,</span>
<span id="cb43-11"><a href="#cb43-11"></a>  <span class="dt">title =</span> <span class="st">"multinomial logistic regression models"</span>,</span>
<span id="cb43-12"><a href="#cb43-12"></a>  <span class="dt">package =</span> <span class="st">"ggsci"</span>,</span>
<span id="cb43-13"><a href="#cb43-13"></a>  <span class="dt">palette =</span> <span class="st">"default_ucscgb"</span></span>
<span id="cb43-14"><a href="#cb43-14"></a>)</span>
<span id="cb43-15"><a href="#cb43-15"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/multinom-1.png" width="576"></p>
</div>
<div id="multilevel-mediation-model-bmlm" class="section level2">
<h2 class="hasAnchor">
<a href="#multilevel-mediation-model-bmlm" class="anchor"></a>multilevel mediation model (<code>bmlm</code>)</h2>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="co"># setup</span></span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb44-3"><a href="#cb44-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(bmlm)</span>
<span id="cb44-4"><a href="#cb44-4"></a></span>
<span id="cb44-5"><a href="#cb44-5"></a><span class="co"># model</span></span>
<span id="cb44-6"><a href="#cb44-6"></a>fit &lt;-<span class="st"> </span>bmlm<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/bmlm/man/mlm.html">mlm</a></span>(BLch9, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span>
<span id="cb44-7"><a href="#cb44-7"></a><span class="co">#&gt; </span></span>
<span id="cb44-8"><a href="#cb44-8"></a><span class="co">#&gt; SAMPLING FOR MODEL 'bmlm' NOW (CHAIN 1).</span></span>
<span id="cb44-9"><a href="#cb44-9"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb44-10"><a href="#cb44-10"></a><span class="co">#&gt; Chain 1: Gradient evaluation took 0.001 seconds</span></span>
<span id="cb44-11"><a href="#cb44-11"></a><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 10 seconds.</span></span>
<span id="cb44-12"><a href="#cb44-12"></a><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span id="cb44-13"><a href="#cb44-13"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb44-14"><a href="#cb44-14"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb44-15"><a href="#cb44-15"></a><span class="co">#&gt; Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span id="cb44-16"><a href="#cb44-16"></a><span class="co">#&gt; Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span id="cb44-17"><a href="#cb44-17"></a><span class="co">#&gt; Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span id="cb44-18"><a href="#cb44-18"></a><span class="co">#&gt; Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span id="cb44-19"><a href="#cb44-19"></a><span class="co">#&gt; Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span id="cb44-20"><a href="#cb44-20"></a><span class="co">#&gt; Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span id="cb44-21"><a href="#cb44-21"></a><span class="co">#&gt; Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span id="cb44-22"><a href="#cb44-22"></a><span class="co">#&gt; Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span id="cb44-23"><a href="#cb44-23"></a><span class="co">#&gt; Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span id="cb44-24"><a href="#cb44-24"></a><span class="co">#&gt; Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span id="cb44-25"><a href="#cb44-25"></a><span class="co">#&gt; Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span id="cb44-26"><a href="#cb44-26"></a><span class="co">#&gt; Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span id="cb44-27"><a href="#cb44-27"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb44-28"><a href="#cb44-28"></a><span class="co">#&gt; Chain 1:  Elapsed Time: 46.199 seconds (Warm-up)</span></span>
<span id="cb44-29"><a href="#cb44-29"></a><span class="co">#&gt; Chain 1:                27.907 seconds (Sampling)</span></span>
<span id="cb44-30"><a href="#cb44-30"></a><span class="co">#&gt; Chain 1:                74.106 seconds (Total)</span></span>
<span id="cb44-31"><a href="#cb44-31"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb44-32"><a href="#cb44-32"></a><span class="co">#&gt; </span></span>
<span id="cb44-33"><a href="#cb44-33"></a><span class="co">#&gt; SAMPLING FOR MODEL 'bmlm' NOW (CHAIN 2).</span></span>
<span id="cb44-34"><a href="#cb44-34"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb44-35"><a href="#cb44-35"></a><span class="co">#&gt; Chain 2: Gradient evaluation took 0 seconds</span></span>
<span id="cb44-36"><a href="#cb44-36"></a><span class="co">#&gt; Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.</span></span>
<span id="cb44-37"><a href="#cb44-37"></a><span class="co">#&gt; Chain 2: Adjust your expectations accordingly!</span></span>
<span id="cb44-38"><a href="#cb44-38"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb44-39"><a href="#cb44-39"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb44-40"><a href="#cb44-40"></a><span class="co">#&gt; Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span id="cb44-41"><a href="#cb44-41"></a><span class="co">#&gt; Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span id="cb44-42"><a href="#cb44-42"></a><span class="co">#&gt; Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span id="cb44-43"><a href="#cb44-43"></a><span class="co">#&gt; Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span id="cb44-44"><a href="#cb44-44"></a><span class="co">#&gt; Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span id="cb44-45"><a href="#cb44-45"></a><span class="co">#&gt; Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span id="cb44-46"><a href="#cb44-46"></a><span class="co">#&gt; Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span id="cb44-47"><a href="#cb44-47"></a><span class="co">#&gt; Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span id="cb44-48"><a href="#cb44-48"></a><span class="co">#&gt; Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span id="cb44-49"><a href="#cb44-49"></a><span class="co">#&gt; Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span id="cb44-50"><a href="#cb44-50"></a><span class="co">#&gt; Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span id="cb44-51"><a href="#cb44-51"></a><span class="co">#&gt; Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span id="cb44-52"><a href="#cb44-52"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb44-53"><a href="#cb44-53"></a><span class="co">#&gt; Chain 2:  Elapsed Time: 46.469 seconds (Warm-up)</span></span>
<span id="cb44-54"><a href="#cb44-54"></a><span class="co">#&gt; Chain 2:                27.276 seconds (Sampling)</span></span>
<span id="cb44-55"><a href="#cb44-55"></a><span class="co">#&gt; Chain 2:                73.745 seconds (Total)</span></span>
<span id="cb44-56"><a href="#cb44-56"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb44-57"><a href="#cb44-57"></a><span class="co">#&gt; </span></span>
<span id="cb44-58"><a href="#cb44-58"></a><span class="co">#&gt; SAMPLING FOR MODEL 'bmlm' NOW (CHAIN 3).</span></span>
<span id="cb44-59"><a href="#cb44-59"></a><span class="co">#&gt; Chain 3: </span></span>
<span id="cb44-60"><a href="#cb44-60"></a><span class="co">#&gt; Chain 3: Gradient evaluation took 0.001 seconds</span></span>
<span id="cb44-61"><a href="#cb44-61"></a><span class="co">#&gt; Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 10 seconds.</span></span>
<span id="cb44-62"><a href="#cb44-62"></a><span class="co">#&gt; Chain 3: Adjust your expectations accordingly!</span></span>
<span id="cb44-63"><a href="#cb44-63"></a><span class="co">#&gt; Chain 3: </span></span>
<span id="cb44-64"><a href="#cb44-64"></a><span class="co">#&gt; Chain 3: </span></span>
<span id="cb44-65"><a href="#cb44-65"></a><span class="co">#&gt; Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span id="cb44-66"><a href="#cb44-66"></a><span class="co">#&gt; Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span id="cb44-67"><a href="#cb44-67"></a><span class="co">#&gt; Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span id="cb44-68"><a href="#cb44-68"></a><span class="co">#&gt; Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span id="cb44-69"><a href="#cb44-69"></a><span class="co">#&gt; Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span id="cb44-70"><a href="#cb44-70"></a><span class="co">#&gt; Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span id="cb44-71"><a href="#cb44-71"></a><span class="co">#&gt; Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span id="cb44-72"><a href="#cb44-72"></a><span class="co">#&gt; Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span id="cb44-73"><a href="#cb44-73"></a><span class="co">#&gt; Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span id="cb44-74"><a href="#cb44-74"></a><span class="co">#&gt; Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span id="cb44-75"><a href="#cb44-75"></a><span class="co">#&gt; Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span id="cb44-76"><a href="#cb44-76"></a><span class="co">#&gt; Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span id="cb44-77"><a href="#cb44-77"></a><span class="co">#&gt; Chain 3: </span></span>
<span id="cb44-78"><a href="#cb44-78"></a><span class="co">#&gt; Chain 3:  Elapsed Time: 46.731 seconds (Warm-up)</span></span>
<span id="cb44-79"><a href="#cb44-79"></a><span class="co">#&gt; Chain 3:                29.365 seconds (Sampling)</span></span>
<span id="cb44-80"><a href="#cb44-80"></a><span class="co">#&gt; Chain 3:                76.096 seconds (Total)</span></span>
<span id="cb44-81"><a href="#cb44-81"></a><span class="co">#&gt; Chain 3: </span></span>
<span id="cb44-82"><a href="#cb44-82"></a><span class="co">#&gt; </span></span>
<span id="cb44-83"><a href="#cb44-83"></a><span class="co">#&gt; SAMPLING FOR MODEL 'bmlm' NOW (CHAIN 4).</span></span>
<span id="cb44-84"><a href="#cb44-84"></a><span class="co">#&gt; Chain 4: </span></span>
<span id="cb44-85"><a href="#cb44-85"></a><span class="co">#&gt; Chain 4: Gradient evaluation took 0.002 seconds</span></span>
<span id="cb44-86"><a href="#cb44-86"></a><span class="co">#&gt; Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 20 seconds.</span></span>
<span id="cb44-87"><a href="#cb44-87"></a><span class="co">#&gt; Chain 4: Adjust your expectations accordingly!</span></span>
<span id="cb44-88"><a href="#cb44-88"></a><span class="co">#&gt; Chain 4: </span></span>
<span id="cb44-89"><a href="#cb44-89"></a><span class="co">#&gt; Chain 4: </span></span>
<span id="cb44-90"><a href="#cb44-90"></a><span class="co">#&gt; Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span id="cb44-91"><a href="#cb44-91"></a><span class="co">#&gt; Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span id="cb44-92"><a href="#cb44-92"></a><span class="co">#&gt; Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span id="cb44-93"><a href="#cb44-93"></a><span class="co">#&gt; Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span id="cb44-94"><a href="#cb44-94"></a><span class="co">#&gt; Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span id="cb44-95"><a href="#cb44-95"></a><span class="co">#&gt; Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span id="cb44-96"><a href="#cb44-96"></a><span class="co">#&gt; Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span id="cb44-97"><a href="#cb44-97"></a><span class="co">#&gt; Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span id="cb44-98"><a href="#cb44-98"></a><span class="co">#&gt; Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span id="cb44-99"><a href="#cb44-99"></a><span class="co">#&gt; Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span id="cb44-100"><a href="#cb44-100"></a><span class="co">#&gt; Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span id="cb44-101"><a href="#cb44-101"></a><span class="co">#&gt; Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span id="cb44-102"><a href="#cb44-102"></a><span class="co">#&gt; Chain 4: </span></span>
<span id="cb44-103"><a href="#cb44-103"></a><span class="co">#&gt; Chain 4:  Elapsed Time: 45.308 seconds (Warm-up)</span></span>
<span id="cb44-104"><a href="#cb44-104"></a><span class="co">#&gt; Chain 4:                29.652 seconds (Sampling)</span></span>
<span id="cb44-105"><a href="#cb44-105"></a><span class="co">#&gt; Chain 4:                74.96 seconds (Total)</span></span>
<span id="cb44-106"><a href="#cb44-106"></a><span class="co">#&gt; Chain 4:</span></span>
<span id="cb44-107"><a href="#cb44-107"></a></span>
<span id="cb44-108"><a href="#cb44-108"></a><span class="co"># exctrating summary</span></span>
<span id="cb44-109"><a href="#cb44-109"></a>df_summary &lt;-</span>
<span id="cb44-110"><a href="#cb44-110"></a><span class="st">  </span>bmlm<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/bmlm/man/mlm_summary.html">mlm_summary</a></span>(fit) <span class="op">%&gt;%</span></span>
<span id="cb44-111"><a href="#cb44-111"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">rename</a></span>(</span>
<span id="cb44-112"><a href="#cb44-112"></a>    <span class="dt">.data =</span> .,</span>
<span id="cb44-113"><a href="#cb44-113"></a>    <span class="dt">estimate =</span> Mean,</span>
<span id="cb44-114"><a href="#cb44-114"></a>    <span class="dt">term =</span> Parameter,</span>
<span id="cb44-115"><a href="#cb44-115"></a>    <span class="dt">std.error =</span> SE,</span>
<span id="cb44-116"><a href="#cb44-116"></a>    <span class="dt">conf.low =</span> <span class="st">`</span><span class="dt">2.5%</span><span class="st">`</span>,</span>
<span id="cb44-117"><a href="#cb44-117"></a>    <span class="dt">conf.high =</span> <span class="st">`</span><span class="dt">97.5%</span><span class="st">`</span></span>
<span id="cb44-118"><a href="#cb44-118"></a>  )</span>
<span id="cb44-119"><a href="#cb44-119"></a></span>
<span id="cb44-120"><a href="#cb44-120"></a><span class="co"># plot</span></span>
<span id="cb44-121"><a href="#cb44-121"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb44-122"><a href="#cb44-122"></a>  <span class="dt">x =</span> df_summary,</span>
<span id="cb44-123"><a href="#cb44-123"></a>  <span class="dt">title =</span> <span class="st">"Bayesian multilevel mediation models with Stan"</span></span>
<span id="cb44-124"><a href="#cb44-124"></a>)</span>
<span id="cb44-125"><a href="#cb44-125"></a><span class="co">#&gt; Note: For the object of classdata.frame, the argument `statistic` must be specified ('t', 'z', or 'f').</span></span>
<span id="cb44-126"><a href="#cb44-126"></a><span class="co">#&gt; Statistical labels will therefore be skipped.</span></span>
<span id="cb44-127"><a href="#cb44-127"></a><span class="co">#&gt; Note: No p-values and/or statistic available for the model object;</span></span>
<span id="cb44-128"><a href="#cb44-128"></a><span class="co">#&gt; skipping labels with statistical details.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/bmlm-1.png" width="480"></p>
</div>
<div id="proportional-odds-and-related-models-svyolr" class="section level2">
<h2 class="hasAnchor">
<a href="#proportional-odds-and-related-models-svyolr" class="anchor"></a>proportional odds and related models (<code>svyolr</code>)</h2>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="co"># setup</span></span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb45-3"><a href="#cb45-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(survey)</span>
<span id="cb45-4"><a href="#cb45-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(api)</span>
<span id="cb45-5"><a href="#cb45-5"></a></span>
<span id="cb45-6"><a href="#cb45-6"></a><span class="co"># preparing data</span></span>
<span id="cb45-7"><a href="#cb45-7"></a>dclus1 &lt;-</span>
<span id="cb45-8"><a href="#cb45-8"></a><span class="st">  </span>survey<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/survey/man/svydesign.html">svydesign</a></span>(</span>
<span id="cb45-9"><a href="#cb45-9"></a>    <span class="dt">id =</span> <span class="op">~</span>dnum,</span>
<span id="cb45-10"><a href="#cb45-10"></a>    <span class="dt">weights =</span> <span class="op">~</span>pw,</span>
<span id="cb45-11"><a href="#cb45-11"></a>    <span class="dt">data =</span> apiclus1,</span>
<span id="cb45-12"><a href="#cb45-12"></a>    <span class="dt">fpc =</span> <span class="op">~</span>fpc</span>
<span id="cb45-13"><a href="#cb45-13"></a>  )</span>
<span id="cb45-14"><a href="#cb45-14"></a></span>
<span id="cb45-15"><a href="#cb45-15"></a><span class="co"># update</span></span>
<span id="cb45-16"><a href="#cb45-16"></a>dclus1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(dclus1, <span class="dt">mealcat =</span> <span class="kw"><a href="https://rdrr.io/r/base/cut.html">cut</a></span>(meals, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>)))</span>
<span id="cb45-17"><a href="#cb45-17"></a></span>
<span id="cb45-18"><a href="#cb45-18"></a><span class="co"># model</span></span>
<span id="cb45-19"><a href="#cb45-19"></a>m &lt;-</span>
<span id="cb45-20"><a href="#cb45-20"></a><span class="st">  </span>survey<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/survey/man/svyolr.html">svyolr</a></span>(</span>
<span id="cb45-21"><a href="#cb45-21"></a>    <span class="dt">formula =</span> mealcat <span class="op">~</span><span class="st"> </span>avg.ed <span class="op">+</span><span class="st"> </span>mobility <span class="op">+</span><span class="st"> </span>stype,</span>
<span id="cb45-22"><a href="#cb45-22"></a>    <span class="dt">design =</span> dclus1</span>
<span id="cb45-23"><a href="#cb45-23"></a>  )</span>
<span id="cb45-24"><a href="#cb45-24"></a></span>
<span id="cb45-25"><a href="#cb45-25"></a><span class="co"># plot</span></span>
<span id="cb45-26"><a href="#cb45-26"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb45-27"><a href="#cb45-27"></a>  <span class="dt">x =</span> m,</span>
<span id="cb45-28"><a href="#cb45-28"></a>  <span class="dt">title =</span> <span class="st">"proportional odds and related models"</span>,</span>
<span id="cb45-29"><a href="#cb45-29"></a>  <span class="dt">coefficient.type =</span> <span class="st">"both"</span></span>
<span id="cb45-30"><a href="#cb45-30"></a>)</span>
<span id="cb45-31"><a href="#cb45-31"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/svyolr-1.png" width="576"></p>
</div>
<div id="survey-weighted-generalized-linear-models-svyglm" class="section level2">
<h2 class="hasAnchor">
<a href="#survey-weighted-generalized-linear-models-svyglm" class="anchor"></a>survey-weighted generalized linear models (<code>svyglm</code>)</h2>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="co"># data</span></span>
<span id="cb46-2"><a href="#cb46-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(survey)</span>
<span id="cb46-3"><a href="#cb46-3"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb46-4"><a href="#cb46-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(api)</span>
<span id="cb46-5"><a href="#cb46-5"></a>dstrat &lt;-</span>
<span id="cb46-6"><a href="#cb46-6"></a><span class="st">  </span>survey<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/survey/man/svydesign.html">svydesign</a></span>(</span>
<span id="cb46-7"><a href="#cb46-7"></a>    <span class="dt">id =</span> <span class="op">~</span><span class="dv">1</span>,</span>
<span id="cb46-8"><a href="#cb46-8"></a>    <span class="dt">strata =</span> <span class="op">~</span>stype,</span>
<span id="cb46-9"><a href="#cb46-9"></a>    <span class="dt">weights =</span> <span class="op">~</span>pw,</span>
<span id="cb46-10"><a href="#cb46-10"></a>    <span class="dt">data =</span> apistrat,</span>
<span id="cb46-11"><a href="#cb46-11"></a>    <span class="dt">fpc =</span> <span class="op">~</span>fpc</span>
<span id="cb46-12"><a href="#cb46-12"></a>  )</span>
<span id="cb46-13"><a href="#cb46-13"></a></span>
<span id="cb46-14"><a href="#cb46-14"></a><span class="co"># model</span></span>
<span id="cb46-15"><a href="#cb46-15"></a>mod &lt;-</span>
<span id="cb46-16"><a href="#cb46-16"></a><span class="st">  </span>survey<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/survey/man/svyglm.html">svyglm</a></span>(</span>
<span id="cb46-17"><a href="#cb46-17"></a>    <span class="dt">formula =</span> sch.wide <span class="op">~</span><span class="st"> </span>ell <span class="op">+</span><span class="st"> </span>meals <span class="op">+</span><span class="st"> </span>mobility,</span>
<span id="cb46-18"><a href="#cb46-18"></a>    <span class="dt">design =</span> dstrat,</span>
<span id="cb46-19"><a href="#cb46-19"></a>    <span class="dt">family =</span> <span class="kw"><a href="https://rdrr.io/r/stats/family.html">quasibinomial</a></span>()</span>
<span id="cb46-20"><a href="#cb46-20"></a>  )</span>
<span id="cb46-21"><a href="#cb46-21"></a></span>
<span id="cb46-22"><a href="#cb46-22"></a><span class="co"># plot</span></span>
<span id="cb46-23"><a href="#cb46-23"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb46-24"><a href="#cb46-24"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb46-25"><a href="#cb46-25"></a>  <span class="dt">title =</span> <span class="st">"survey-weighted generalized linear model"</span></span>
<span id="cb46-26"><a href="#cb46-26"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/svyglm-1.png" width="480"></p>
</div>
<div id="repeated-measures-anova-aovlist" class="section level2">
<h2 class="hasAnchor">
<a href="#repeated-measures-anova-aovlist" class="anchor"></a>repeated measures ANOVA (<code>aovlist</code>)</h2>
<p>Let’s now consider an example of a repeated measures design where we want to run omnibus ANOVA with a specific error structure. To carry out this analysis, we will first have to convert the iris dataset from wide to long format such that there is one column corresponding to <code>attribute</code> (which part of the calyx of a flower is being measured: <code>sepal</code> or <code>petal</code>?) and one column corresponding to <code>measure</code> used (<code>length</code> or <code>width</code>?). Note that this is within-subjects design since the same flower has both measures for both attributes. The question we are interested in is how much of the variance in measurements is explained by both of these factors and their interaction.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb47-2"><a href="#cb47-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb47-3"><a href="#cb47-3"></a></span>
<span id="cb47-4"><a href="#cb47-4"></a><span class="co"># having a look at iris before converting to long format</span></span>
<span id="cb47-5"><a href="#cb47-5"></a>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">glimpse</a></span>(ggstatsplot<span class="op">::</span>iris_long)</span>
<span id="cb47-6"><a href="#cb47-6"></a><span class="co">#&gt; Observations: 600</span></span>
<span id="cb47-7"><a href="#cb47-7"></a><span class="co">#&gt; Variables: 6</span></span>
<span id="cb47-8"><a href="#cb47-8"></a><span class="co">#&gt; $ id        &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17...</span></span>
<span id="cb47-9"><a href="#cb47-9"></a><span class="co">#&gt; $ Species   &lt;fct&gt; setosa, setosa, setosa, setosa, setosa, setosa, setosa, s...</span></span>
<span id="cb47-10"><a href="#cb47-10"></a><span class="co">#&gt; $ condition &lt;fct&gt; Sepal.Length, Sepal.Length, Sepal.Length, Sepal.Length, S...</span></span>
<span id="cb47-11"><a href="#cb47-11"></a><span class="co">#&gt; $ attribute &lt;fct&gt; Sepal, Sepal, Sepal, Sepal, Sepal, Sepal, Sepal, Sepal, S...</span></span>
<span id="cb47-12"><a href="#cb47-12"></a><span class="co">#&gt; $ measure   &lt;fct&gt; Length, Length, Length, Length, Length, Length, Length, L...</span></span>
<span id="cb47-13"><a href="#cb47-13"></a><span class="co">#&gt; $ value     &lt;dbl&gt; 5.1, 4.9, 4.7, 4.6, 5.0, 5.4, 4.6, 5.0, 4.4, 4.9, 5.4, 4....</span></span>
<span id="cb47-14"><a href="#cb47-14"></a></span>
<span id="cb47-15"><a href="#cb47-15"></a><span class="co"># let's use 20% of the sample to speed up the analysis</span></span>
<span id="cb47-16"><a href="#cb47-16"></a>iris_long_<span class="dv">20</span> &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/sample.html">sample_frac</a></span>(<span class="dt">tbl =</span> ggstatsplot<span class="op">::</span>iris_long, <span class="dt">size =</span> <span class="fl">0.20</span>)</span>
<span id="cb47-17"><a href="#cb47-17"></a></span>
<span id="cb47-18"><a href="#cb47-18"></a><span class="co"># specifying the model (note the error structure)</span></span>
<span id="cb47-19"><a href="#cb47-19"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb47-20"><a href="#cb47-20"></a>  <span class="dt">x =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span>(</span>
<span id="cb47-21"><a href="#cb47-21"></a>    <span class="dt">formula =</span> value <span class="op">~</span><span class="st"> </span>attribute <span class="op">*</span><span class="st"> </span>measure <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/aov.html">Error</a></span>(id <span class="op">/</span><span class="st"> </span>(attribute <span class="op">*</span><span class="st"> </span>measure)),</span>
<span id="cb47-22"><a href="#cb47-22"></a>    <span class="dt">data =</span> iris_long_<span class="dv">20</span></span>
<span id="cb47-23"><a href="#cb47-23"></a>  ),</span>
<span id="cb47-24"><a href="#cb47-24"></a>  <span class="dt">effsize =</span> <span class="st">"eta"</span>,</span>
<span id="cb47-25"><a href="#cb47-25"></a>  <span class="dt">partial =</span> <span class="ot">FALSE</span>,</span>
<span id="cb47-26"><a href="#cb47-26"></a>  <span class="dt">nboot =</span> <span class="dv">50</span>,</span>
<span id="cb47-27"><a href="#cb47-27"></a>  <span class="dt">ggtheme =</span> ggthemes<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ggthemes/man/theme_fivethirtyeight.html">theme_fivethirtyeight</a></span>(),</span>
<span id="cb47-28"><a href="#cb47-28"></a>  <span class="dt">ggstatsplot.layer =</span> <span class="ot">FALSE</span>,</span>
<span id="cb47-29"><a href="#cb47-29"></a>  <span class="dt">stats.label.color =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"darkgreen"</span>),</span>
<span id="cb47-30"><a href="#cb47-30"></a>  <span class="dt">title =</span> <span class="st">"Variation in measurements for Iris species"</span>,</span>
<span id="cb47-31"><a href="#cb47-31"></a>  <span class="dt">subtitle =</span> <span class="st">"Source: Iris data set (by Fisher or Anderson)"</span>,</span>
<span id="cb47-32"><a href="#cb47-32"></a>  <span class="dt">caption =</span> <span class="st">"Results from 2 by 2 RM ANOVA"</span></span>
<span id="cb47-33"><a href="#cb47-33"></a>) <span class="op">+</span></span>
<span id="cb47-34"><a href="#cb47-34"></a><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">plot.subtitle =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">face =</span> <span class="st">"plain"</span>))</span>
<span id="cb47-35"><a href="#cb47-35"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/aovlist1-1.png" width="768"></p>
<p>As revealed by this analysis, all effects of this model are significant. But most of the variance is explained by the <code>attribute</code>, with the next important explanatory factor being the <code>measure</code> used. A very little amount of variation in measurement is accounted for by the interaction between these two factors.</p>
</div>
<div id="robust-regression-with-robust-package-lmrob-glmrob" class="section level2">
<h2 class="hasAnchor">
<a href="#robust-regression-with-robust-package-lmrob-glmrob" class="anchor"></a>robust regression with <code>robust</code> package (<code>lmRob</code>, <code>glmRob</code>)</h2>
<p>The robust regression models, as implemented in the <code>robust</code> package are also supported.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/combine_plots.html">combine_plots</a></span>(</span>
<span id="cb48-2"><a href="#cb48-2"></a>  <span class="co"># plot 1: glmRob</span></span>
<span id="cb48-3"><a href="#cb48-3"></a>  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb48-4"><a href="#cb48-4"></a>    <span class="dt">x =</span> robust<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/robust/man/glmRob.html">glmRob</a></span>(</span>
<span id="cb48-5"><a href="#cb48-5"></a>      <span class="dt">formula =</span> Survived <span class="op">~</span><span class="st"> </span>Sex,</span>
<span id="cb48-6"><a href="#cb48-6"></a>      <span class="dt">data =</span> dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/sample.html">sample_frac</a></span>(<span class="dt">tbl =</span> ggstatsplot<span class="op">::</span>Titanic_full, <span class="dt">size =</span> <span class="fl">0.20</span>),</span>
<span id="cb48-7"><a href="#cb48-7"></a>      <span class="dt">family =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span>(<span class="dt">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb48-8"><a href="#cb48-8"></a>    ),</span>
<span id="cb48-9"><a href="#cb48-9"></a>    <span class="dt">title =</span> <span class="st">"generalized robust linear model"</span>,</span>
<span id="cb48-10"><a href="#cb48-10"></a>    <span class="dt">package =</span> <span class="st">"dichromat"</span>,</span>
<span id="cb48-11"><a href="#cb48-11"></a>    <span class="dt">palette =</span> <span class="st">"BrowntoBlue.10"</span>,</span>
<span id="cb48-12"><a href="#cb48-12"></a>    <span class="dt">ggtheme =</span> ggthemes<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ggthemes/man/theme_fivethirtyeight.html">theme_fivethirtyeight</a></span>(),</span>
<span id="cb48-13"><a href="#cb48-13"></a>    <span class="dt">ggstatsplot.layer =</span> <span class="ot">FALSE</span></span>
<span id="cb48-14"><a href="#cb48-14"></a>  ),</span>
<span id="cb48-15"><a href="#cb48-15"></a>  <span class="co"># plot 2: lmRob</span></span>
<span id="cb48-16"><a href="#cb48-16"></a>  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb48-17"><a href="#cb48-17"></a>    <span class="dt">x =</span> robust<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/robust/man/lmRob.html">lmRob</a></span>(</span>
<span id="cb48-18"><a href="#cb48-18"></a>      <span class="dt">formula =</span> Sepal.Length <span class="op">~</span><span class="st"> </span>Sepal.Width <span class="op">*</span><span class="st"> </span>Species,</span>
<span id="cb48-19"><a href="#cb48-19"></a>      <span class="dt">data =</span> iris</span>
<span id="cb48-20"><a href="#cb48-20"></a>    ),</span>
<span id="cb48-21"><a href="#cb48-21"></a>    <span class="dt">title =</span> <span class="st">"robust linear model"</span>,</span>
<span id="cb48-22"><a href="#cb48-22"></a>    <span class="dt">package =</span> <span class="st">"awtools"</span>,</span>
<span id="cb48-23"><a href="#cb48-23"></a>    <span class="dt">palette =</span> <span class="st">"a_palette"</span>,</span>
<span id="cb48-24"><a href="#cb48-24"></a>    <span class="dt">ggtheme =</span> ggthemes<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ggthemes/man/theme_tufte.html">theme_tufte</a></span>(),</span>
<span id="cb48-25"><a href="#cb48-25"></a>    <span class="dt">ggstatsplot.layer =</span> <span class="ot">FALSE</span></span>
<span id="cb48-26"><a href="#cb48-26"></a>  ),</span>
<span id="cb48-27"><a href="#cb48-27"></a>  <span class="co"># arguments relevant for `combine_plots` function</span></span>
<span id="cb48-28"><a href="#cb48-28"></a>  <span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"(a)"</span>, <span class="st">"(b)"</span>),</span>
<span id="cb48-29"><a href="#cb48-29"></a>  <span class="dt">title.text =</span> <span class="st">"Robust variants of `lmRob` and `glmRob` </span><span class="ch">\n</span><span class="st">(from`robust` package)"</span>,</span>
<span id="cb48-30"><a href="#cb48-30"></a>  <span class="dt">nrow =</span> <span class="dv">2</span></span>
<span id="cb48-31"><a href="#cb48-31"></a>)</span>
<span id="cb48-32"><a href="#cb48-32"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span>
<span id="cb48-33"><a href="#cb48-33"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/robust-1.png" width="576"></p>
</div>
<div id="robust-regression-with-robustbase-package-lmrob-glmrob" class="section level2">
<h2 class="hasAnchor">
<a href="#robust-regression-with-robustbase-package-lmrob-glmrob" class="anchor"></a>robust regression with <code>robustbase</code> package (<code>lmrob</code>, <code>glmrob</code>)</h2>
<p>Another alternative is to use robust models, as implemented in the <code>robustbase</code> package.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="co"># setup</span></span>
<span id="cb49-2"><a href="#cb49-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb49-3"><a href="#cb49-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(robustbase)</span>
<span id="cb49-4"><a href="#cb49-4"></a></span>
<span id="cb49-5"><a href="#cb49-5"></a><span class="co"># dataframe</span></span>
<span id="cb49-6"><a href="#cb49-6"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(coleman)</span>
<span id="cb49-7"><a href="#cb49-7"></a>clotting &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(</span>
<span id="cb49-8"><a href="#cb49-8"></a>  <span class="dt">u =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">100</span>),</span>
<span id="cb49-9"><a href="#cb49-9"></a>  <span class="dt">lot1 =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">118</span>, <span class="dv">58</span>, <span class="dv">42</span>, <span class="dv">35</span>, <span class="dv">27</span>, <span class="dv">25</span>, <span class="dv">21</span>, <span class="dv">19</span>, <span class="dv">18</span>),</span>
<span id="cb49-10"><a href="#cb49-10"></a>  <span class="dt">lot2 =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">69</span>, <span class="dv">35</span>, <span class="dv">26</span>, <span class="dv">21</span>, <span class="dv">18</span>, <span class="dv">16</span>, <span class="dv">13</span>, <span class="dv">12</span>, <span class="dv">12</span>)</span>
<span id="cb49-11"><a href="#cb49-11"></a>)</span>
<span id="cb49-12"><a href="#cb49-12"></a></span>
<span id="cb49-13"><a href="#cb49-13"></a><span class="co"># combined plot for both generalized and simple robust models</span></span>
<span id="cb49-14"><a href="#cb49-14"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/combine_plots.html">combine_plots</a></span>(</span>
<span id="cb49-15"><a href="#cb49-15"></a>  <span class="co"># plot 1: glmrob</span></span>
<span id="cb49-16"><a href="#cb49-16"></a>  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb49-17"><a href="#cb49-17"></a>    <span class="dt">x =</span> robustbase<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/robustbase/man/glmrob.html">glmrob</a></span>(</span>
<span id="cb49-18"><a href="#cb49-18"></a>      <span class="dt">formula =</span> lot1 <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(u),</span>
<span id="cb49-19"><a href="#cb49-19"></a>      <span class="dt">data =</span> clotting,</span>
<span id="cb49-20"><a href="#cb49-20"></a>      <span class="dt">family =</span> Gamma</span>
<span id="cb49-21"><a href="#cb49-21"></a>    ),</span>
<span id="cb49-22"><a href="#cb49-22"></a>    <span class="dt">title =</span> <span class="st">"generalized robust linear model"</span></span>
<span id="cb49-23"><a href="#cb49-23"></a>  ),</span>
<span id="cb49-24"><a href="#cb49-24"></a>  <span class="co"># plot 2: lmrob</span></span>
<span id="cb49-25"><a href="#cb49-25"></a>  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb49-26"><a href="#cb49-26"></a>    <span class="dt">x =</span> robustbase<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/robustbase/man/lmrob.html">lmrob</a></span>(<span class="dt">formula =</span> Y <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> coleman),</span>
<span id="cb49-27"><a href="#cb49-27"></a>    <span class="dt">title =</span> <span class="st">"robust linear model"</span></span>
<span id="cb49-28"><a href="#cb49-28"></a>  ),</span>
<span id="cb49-29"><a href="#cb49-29"></a>  <span class="co"># arguments relevant for `combine_plots` function</span></span>
<span id="cb49-30"><a href="#cb49-30"></a>  <span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"(i)"</span>, <span class="st">"(ii)"</span>),</span>
<span id="cb49-31"><a href="#cb49-31"></a>  <span class="dt">title.text =</span> <span class="st">"Robust variants of `lmRob` and `glmRob` </span><span class="ch">\n</span><span class="st">(from`robustbase` package)"</span>,</span>
<span id="cb49-32"><a href="#cb49-32"></a>  <span class="dt">nrow =</span> <span class="dv">2</span></span>
<span id="cb49-33"><a href="#cb49-33"></a>)</span>
<span id="cb49-34"><a href="#cb49-34"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span>
<span id="cb49-35"><a href="#cb49-35"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/robustbase-1.png" width="576"></p>
</div>
<div id="mm-type-estimators-for-linear-regression-on-compositional-data-complmrob" class="section level2">
<h2 class="hasAnchor">
<a href="#mm-type-estimators-for-linear-regression-on-compositional-data-complmrob" class="anchor"></a>MM-type estimators for linear regression on compositional data (<code>complmrob</code>)</h2>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="co"># setup</span></span>
<span id="cb50-2"><a href="#cb50-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb50-3"><a href="#cb50-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(complmrob)</span>
<span id="cb50-4"><a href="#cb50-4"></a></span>
<span id="cb50-5"><a href="#cb50-5"></a><span class="co"># data</span></span>
<span id="cb50-6"><a href="#cb50-6"></a>crimes &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(</span>
<span id="cb50-7"><a href="#cb50-7"></a>  <span class="dt">lifeExp =</span> state.x77[, <span class="st">"Life Exp"</span>],</span>
<span id="cb50-8"><a href="#cb50-8"></a>  USArrests[, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Murder"</span>, <span class="st">"Assault"</span>, <span class="st">"Rape"</span>)]</span>
<span id="cb50-9"><a href="#cb50-9"></a>)</span>
<span id="cb50-10"><a href="#cb50-10"></a></span>
<span id="cb50-11"><a href="#cb50-11"></a><span class="co"># model</span></span>
<span id="cb50-12"><a href="#cb50-12"></a>mUSArr &lt;-<span class="st"> </span><span class="kw">complmrob</span>(<span class="dt">formula =</span> lifeExp <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> crimes)</span>
<span id="cb50-13"><a href="#cb50-13"></a></span>
<span id="cb50-14"><a href="#cb50-14"></a><span class="co"># plot</span></span>
<span id="cb50-15"><a href="#cb50-15"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb50-16"><a href="#cb50-16"></a>  <span class="dt">x =</span> mUSArr,</span>
<span id="cb50-17"><a href="#cb50-17"></a>  <span class="dt">title =</span> <span class="st">"MM-type estimators for linear regression on compositional data"</span></span>
<span id="cb50-18"><a href="#cb50-18"></a>)</span>
<span id="cb50-19"><a href="#cb50-19"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/complmrob-1.png" width="576"></p>
</div>
<div id="fit-a-nonlinear-heteroscedastic-model-via-maximum-likelihood-nlreg" class="section level2">
<h2 class="hasAnchor">
<a href="#fit-a-nonlinear-heteroscedastic-model-via-maximum-likelihood-nlreg" class="anchor"></a>fit a nonlinear heteroscedastic model via maximum likelihood (<code>nlreg</code>)</h2>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb51-2"><a href="#cb51-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(nlreg)</span>
<span id="cb51-3"><a href="#cb51-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(boot)</span>
<span id="cb51-4"><a href="#cb51-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(calcium)</span>
<span id="cb51-5"><a href="#cb51-5"></a></span>
<span id="cb51-6"><a href="#cb51-6"></a><span class="co"># homoscedastic model fit</span></span>
<span id="cb51-7"><a href="#cb51-7"></a>calcium.nl &lt;-</span>
<span id="cb51-8"><a href="#cb51-8"></a><span class="st">  </span>nlreg<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/nlreg/man/nlreg.html">nlreg</a></span>(</span>
<span id="cb51-9"><a href="#cb51-9"></a>    <span class="dt">formula =</span> cal <span class="op">~</span><span class="st"> </span>b0 <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="op">-</span>b1 <span class="op">*</span><span class="st"> </span>time)),</span>
<span id="cb51-10"><a href="#cb51-10"></a>    <span class="dt">start =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">b0 =</span> <span class="dv">4</span>, <span class="dt">b1 =</span> <span class="fl">0.1</span>),</span>
<span id="cb51-11"><a href="#cb51-11"></a>    <span class="dt">data =</span> calcium</span>
<span id="cb51-12"><a href="#cb51-12"></a>  )</span>
<span id="cb51-13"><a href="#cb51-13"></a></span>
<span id="cb51-14"><a href="#cb51-14"></a><span class="co"># plot</span></span>
<span id="cb51-15"><a href="#cb51-15"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb51-16"><a href="#cb51-16"></a>  <span class="dt">x =</span> calcium.nl,</span>
<span id="cb51-17"><a href="#cb51-17"></a>  <span class="dt">conf.int =</span> <span class="ot">FALSE</span>,</span>
<span id="cb51-18"><a href="#cb51-18"></a>  <span class="dt">title =</span> <span class="st">"fit a nonlinear heteroscedastic model </span><span class="ch">\n</span><span class="st">via maximum likelihood"</span></span>
<span id="cb51-19"><a href="#cb51-19"></a>)</span>
<span id="cb51-20"><a href="#cb51-20"></a><span class="co">#&gt; </span></span>
<span id="cb51-21"><a href="#cb51-21"></a><span class="co">#&gt; differentiating mean function -- may take a while</span></span>
<span id="cb51-22"><a href="#cb51-22"></a><span class="co">#&gt; differentiating variance function -- may take a while</span></span>
<span id="cb51-23"><a href="#cb51-23"></a><span class="co">#&gt; </span></span>
<span id="cb51-24"><a href="#cb51-24"></a><span class="co">#&gt; differentiating mean function -- may take a while</span></span>
<span id="cb51-25"><a href="#cb51-25"></a><span class="co">#&gt; differentiating variance function -- may take a while</span></span>
<span id="cb51-26"><a href="#cb51-26"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span>
<span id="cb51-27"><a href="#cb51-27"></a><span class="co">#&gt; </span></span>
<span id="cb51-28"><a href="#cb51-28"></a><span class="co">#&gt; differentiating mean function -- may take a while</span></span>
<span id="cb51-29"><a href="#cb51-29"></a><span class="co">#&gt; differentiating variance function -- may take a while</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/nlreg-1.png" width="480"></p>
</div>
<div id="fit-a-linear-model-with-multiple-group-fixed-effects-felm" class="section level2">
<h2 class="hasAnchor">
<a href="#fit-a-linear-model-with-multiple-group-fixed-effects-felm" class="anchor"></a>fit a linear model with multiple group fixed effects (<code>felm</code>)</h2>
<p>Models of class <code>felm</code> from <code>lfe</code> package are also supported. This method is used to fit linear models with multiple group fixed effects, similarly to <code>lm</code>. It uses the Method of Alternating projections to sweep out multiple group effects from the normal equations before estimating the remaining coefficients with OLS.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(lfe)</span>
<span id="cb52-2"><a href="#cb52-2"></a></span>
<span id="cb52-3"><a href="#cb52-3"></a><span class="co"># create covariates</span></span>
<span id="cb52-4"><a href="#cb52-4"></a>x &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dv">1000</span>)</span>
<span id="cb52-5"><a href="#cb52-5"></a>x2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(x))</span>
<span id="cb52-6"><a href="#cb52-6"></a></span>
<span id="cb52-7"><a href="#cb52-7"></a><span class="co"># individual and firm</span></span>
<span id="cb52-8"><a href="#cb52-8"></a>id &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="dv">20</span>, <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(x), <span class="dt">replace =</span> <span class="ot">TRUE</span>))</span>
<span id="cb52-9"><a href="#cb52-9"></a>firm &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="dv">13</span>, <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(x), <span class="dt">replace =</span> <span class="ot">TRUE</span>))</span>
<span id="cb52-10"><a href="#cb52-10"></a></span>
<span id="cb52-11"><a href="#cb52-11"></a><span class="co"># effects for them</span></span>
<span id="cb52-12"><a href="#cb52-12"></a>id.eff &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/nlevels.html">nlevels</a></span>(id))</span>
<span id="cb52-13"><a href="#cb52-13"></a>firm.eff &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/nlevels.html">nlevels</a></span>(firm))</span>
<span id="cb52-14"><a href="#cb52-14"></a></span>
<span id="cb52-15"><a href="#cb52-15"></a><span class="co"># left hand side</span></span>
<span id="cb52-16"><a href="#cb52-16"></a>u &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(x))</span>
<span id="cb52-17"><a href="#cb52-17"></a>y &lt;-<span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>x2 <span class="op">+</span><span class="st"> </span>id.eff[id] <span class="op">+</span><span class="st"> </span>firm.eff[firm] <span class="op">+</span><span class="st"> </span>u</span>
<span id="cb52-18"><a href="#cb52-18"></a></span>
<span id="cb52-19"><a href="#cb52-19"></a><span class="co"># estimate and print result</span></span>
<span id="cb52-20"><a href="#cb52-20"></a>est &lt;-<span class="st"> </span>lfe<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/lfe/man/felm.html">felm</a></span>(<span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>x2 <span class="op">|</span><span class="st"> </span>id <span class="op">+</span><span class="st"> </span>firm)</span>
<span id="cb52-21"><a href="#cb52-21"></a></span>
<span id="cb52-22"><a href="#cb52-22"></a><span class="co"># plot</span></span>
<span id="cb52-23"><a href="#cb52-23"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb52-24"><a href="#cb52-24"></a>  <span class="dt">x =</span> est,</span>
<span id="cb52-25"><a href="#cb52-25"></a>  <span class="dt">title =</span> <span class="st">"linear model with multiple group fixed effects"</span></span>
<span id="cb52-26"><a href="#cb52-26"></a>)</span>
<span id="cb52-27"><a href="#cb52-27"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/felm-1.png" width="480"></p>
</div>
<div id="linear-models-for-panel-data-plm" class="section level2">
<h2 class="hasAnchor">
<a href="#linear-models-for-panel-data-plm" class="anchor"></a>linear models for panel data (<code>plm</code>)</h2>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="co"># data</span></span>
<span id="cb53-2"><a href="#cb53-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb53-3"><a href="#cb53-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(plm)</span>
<span id="cb53-4"><a href="#cb53-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"Produc"</span>, <span class="dt">package =</span> <span class="st">"plm"</span>)</span>
<span id="cb53-5"><a href="#cb53-5"></a></span>
<span id="cb53-6"><a href="#cb53-6"></a><span class="co"># model</span></span>
<span id="cb53-7"><a href="#cb53-7"></a>plm.mod &lt;-</span>
<span id="cb53-8"><a href="#cb53-8"></a><span class="st">  </span>plm<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/plm/man/plm.html">plm</a></span>(</span>
<span id="cb53-9"><a href="#cb53-9"></a>    <span class="dt">formula =</span> <span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(gsp) <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(pcap) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(pc) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(emp) <span class="op">+</span><span class="st"> </span>unemp,</span>
<span id="cb53-10"><a href="#cb53-10"></a>    <span class="dt">data =</span> Produc,</span>
<span id="cb53-11"><a href="#cb53-11"></a>    <span class="dt">index =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"state"</span>, <span class="st">"year"</span>)</span>
<span id="cb53-12"><a href="#cb53-12"></a>  )</span>
<span id="cb53-13"><a href="#cb53-13"></a></span>
<span id="cb53-14"><a href="#cb53-14"></a><span class="co"># plot</span></span>
<span id="cb53-15"><a href="#cb53-15"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb53-16"><a href="#cb53-16"></a>  <span class="dt">x =</span> plm.mod,</span>
<span id="cb53-17"><a href="#cb53-17"></a>  <span class="dt">title =</span> <span class="st">"linear models for panel data"</span></span>
<span id="cb53-18"><a href="#cb53-18"></a>)</span>
<span id="cb53-19"><a href="#cb53-19"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/plm-1.png" width="480"></p>
</div>
<div id="analysis-of-factorial-experiments-mixed" class="section level2">
<h2 class="hasAnchor">
<a href="#analysis-of-factorial-experiments-mixed" class="anchor"></a>analysis of factorial experiments (<code>mixed</code>)</h2>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="co"># setup</span></span>
<span id="cb54-2"><a href="#cb54-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb54-3"><a href="#cb54-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(afex)</span>
<span id="cb54-4"><a href="#cb54-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(sleepstudy)</span>
<span id="cb54-5"><a href="#cb54-5"></a></span>
<span id="cb54-6"><a href="#cb54-6"></a><span class="co"># data</span></span>
<span id="cb54-7"><a href="#cb54-7"></a>sleepstudy<span class="op">$</span>mygrp &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">size =</span> <span class="dv">180</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb54-8"><a href="#cb54-8"></a>sleepstudy<span class="op">$</span>mysubgrp &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb54-9"><a href="#cb54-9"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) {</span>
<span id="cb54-10"><a href="#cb54-10"></a>  filter_group &lt;-<span class="st"> </span>sleepstudy<span class="op">$</span>mygrp <span class="op">==</span><span class="st"> </span>i</span>
<span id="cb54-11"><a href="#cb54-11"></a>  sleepstudy<span class="op">$</span>mysubgrp[filter_group] &lt;-</span>
<span id="cb54-12"><a href="#cb54-12"></a><span class="st">    </span><span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>, <span class="dt">size =</span> <span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(filter_group), <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb54-13"><a href="#cb54-13"></a>}</span>
<span id="cb54-14"><a href="#cb54-14"></a></span>
<span id="cb54-15"><a href="#cb54-15"></a><span class="co"># linear model</span></span>
<span id="cb54-16"><a href="#cb54-16"></a>m1 &lt;-<span class="st"> </span>afex<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/afex/man/mixed.html">mixed</a></span>(</span>
<span id="cb54-17"><a href="#cb54-17"></a>  <span class="dt">formula =</span> Reaction <span class="op">~</span><span class="st"> </span>Days <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Days <span class="op">|</span><span class="st"> </span>Subject),</span>
<span id="cb54-18"><a href="#cb54-18"></a>  <span class="dt">data =</span> sleepstudy</span>
<span id="cb54-19"><a href="#cb54-19"></a>)</span>
<span id="cb54-20"><a href="#cb54-20"></a><span class="co">#&gt; Fitting one lmer() model. [DONE]</span></span>
<span id="cb54-21"><a href="#cb54-21"></a><span class="co">#&gt; Calculating p-values. [DONE]</span></span>
<span id="cb54-22"><a href="#cb54-22"></a></span>
<span id="cb54-23"><a href="#cb54-23"></a><span class="co"># linear mixed-effects model</span></span>
<span id="cb54-24"><a href="#cb54-24"></a>m2 &lt;-<span class="st"> </span>afex<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/afex/man/mixed.html">mixed</a></span>(</span>
<span id="cb54-25"><a href="#cb54-25"></a>  <span class="dt">formula =</span> Reaction <span class="op">~</span><span class="st"> </span>Days <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>mygrp <span class="op">/</span><span class="st"> </span>mysubgrp) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Subject),</span>
<span id="cb54-26"><a href="#cb54-26"></a>  <span class="dt">data =</span> sleepstudy</span>
<span id="cb54-27"><a href="#cb54-27"></a>)</span>
<span id="cb54-28"><a href="#cb54-28"></a><span class="co">#&gt; Fitting one lmer() model. [DONE]</span></span>
<span id="cb54-29"><a href="#cb54-29"></a><span class="co">#&gt; Calculating p-values. [DONE]</span></span>
<span id="cb54-30"><a href="#cb54-30"></a></span>
<span id="cb54-31"><a href="#cb54-31"></a><span class="co"># plot</span></span>
<span id="cb54-32"><a href="#cb54-32"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/combine_plots.html">combine_plots</a></span>(</span>
<span id="cb54-33"><a href="#cb54-33"></a>  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(m1, <span class="dt">title =</span> <span class="st">"linear model (`afex` package)"</span>),</span>
<span id="cb54-34"><a href="#cb54-34"></a>  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(m2, <span class="dt">title =</span> <span class="st">"linear mixed-effects model (`afex` package)"</span>),</span>
<span id="cb54-35"><a href="#cb54-35"></a>  <span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"(a)"</span>, <span class="st">"(b)"</span>)</span>
<span id="cb54-36"><a href="#cb54-36"></a>)</span>
<span id="cb54-37"><a href="#cb54-37"></a><span class="co">#&gt; Can't extract residuals from model.</span></span>
<span id="cb54-38"><a href="#cb54-38"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span>
<span id="cb54-39"><a href="#cb54-39"></a><span class="co">#&gt; Random effect variances not available. Returned R2 does not account for random effects.</span></span>
<span id="cb54-40"><a href="#cb54-40"></a><span class="co">#&gt; Can't extract residuals from model.</span></span>
<span id="cb54-41"><a href="#cb54-41"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/mixed-1.png" width="768"></p>
</div>
<div id="multinomial-logit-model-mlogit" class="section level2">
<h2 class="hasAnchor">
<a href="#multinomial-logit-model-mlogit" class="anchor"></a>multinomial logit model (<code>mlogit</code>)</h2>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a></span>
<span id="cb55-2"><a href="#cb55-2"></a><span class="co"># setup</span></span>
<span id="cb55-3"><a href="#cb55-3"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb55-4"><a href="#cb55-4"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(mlogit)</span>
<span id="cb55-5"><a href="#cb55-5"></a></span>
<span id="cb55-6"><a href="#cb55-6"></a><span class="co"># data</span></span>
<span id="cb55-7"><a href="#cb55-7"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"Fishing"</span>, <span class="dt">package =</span> <span class="st">"mlogit"</span>)</span>
<span id="cb55-8"><a href="#cb55-8"></a>Fish &lt;-<span class="st"> </span><span class="kw">mlogit.data</span>(Fishing, <span class="dt">varying =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span><span class="op">:</span><span class="dv">9</span>), <span class="dt">shape =</span> <span class="st">"wide"</span>, <span class="dt">choice =</span> <span class="st">"mode"</span>)</span>
<span id="cb55-9"><a href="#cb55-9"></a></span>
<span id="cb55-10"><a href="#cb55-10"></a><span class="co"># a "mixed" model</span></span>
<span id="cb55-11"><a href="#cb55-11"></a>m &lt;-<span class="st"> </span><span class="kw">mlogit</span>(mode <span class="op">~</span><span class="st"> </span>price <span class="op">+</span><span class="st"> </span>catch <span class="op">|</span><span class="st"> </span>income, <span class="dt">data =</span> Fish)</span>
<span id="cb55-12"><a href="#cb55-12"></a></span>
<span id="cb55-13"><a href="#cb55-13"></a><span class="co"># plot</span></span>
<span id="cb55-14"><a href="#cb55-14"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb55-15"><a href="#cb55-15"></a>  <span class="dt">x =</span> m,</span>
<span id="cb55-16"><a href="#cb55-16"></a>  <span class="dt">title =</span> <span class="st">"multinomial logit model"</span></span>
<span id="cb55-17"><a href="#cb55-17"></a>)</span>
<span id="cb55-18"><a href="#cb55-18"></a><span class="co">#&gt; Can't calculate log-loss.</span></span>
<span id="cb55-19"><a href="#cb55-19"></a><span class="co">#&gt; Can't calculate proper scoring rules for ordinal, multinomial or cumulative link models.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/mlogit-1.png" width="672"></p>
</div>
<div id="conditional-logit-models-mclogit" class="section level2">
<h2 class="hasAnchor">
<a href="#conditional-logit-models-mclogit" class="anchor"></a>conditional logit models (<code>mclogit</code>)</h2>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="co"># setup</span></span>
<span id="cb56-2"><a href="#cb56-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb56-3"><a href="#cb56-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(mclogit)</span>
<span id="cb56-4"><a href="#cb56-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(Transport)</span>
<span id="cb56-5"><a href="#cb56-5"></a></span>
<span id="cb56-6"><a href="#cb56-6"></a><span class="co"># model</span></span>
<span id="cb56-7"><a href="#cb56-7"></a>mod &lt;-</span>
<span id="cb56-8"><a href="#cb56-8"></a><span class="st">  </span>mclogit<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/mclogit/man/mclogit.html">mclogit</a></span>(</span>
<span id="cb56-9"><a href="#cb56-9"></a>    <span class="dt">formula =</span> <span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(resp, suburb) <span class="op">~</span><span class="st"> </span>distance <span class="op">+</span><span class="st"> </span>cost,</span>
<span id="cb56-10"><a href="#cb56-10"></a>    <span class="dt">data =</span> Transport,</span>
<span id="cb56-11"><a href="#cb56-11"></a>    <span class="dt">control =</span> <span class="kw">mclogit.control</span>(<span class="dt">trace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb56-12"><a href="#cb56-12"></a>  )</span>
<span id="cb56-13"><a href="#cb56-13"></a></span>
<span id="cb56-14"><a href="#cb56-14"></a><span class="co"># plot</span></span>
<span id="cb56-15"><a href="#cb56-15"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb56-16"><a href="#cb56-16"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb56-17"><a href="#cb56-17"></a>  <span class="dt">title =</span> <span class="st">"Conditional Logit Models"</span></span>
<span id="cb56-18"><a href="#cb56-18"></a>)</span>
<span id="cb56-19"><a href="#cb56-19"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/mclogit-1.png" width="384"></p>
</div>
<div id="mixed-conditional-logit-models-mmclogit" class="section level2">
<h2 class="hasAnchor">
<a href="#mixed-conditional-logit-models-mmclogit" class="anchor"></a>mixed conditional logit models (<code>mmclogit</code>)</h2>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="co"># setup</span></span>
<span id="cb57-2"><a href="#cb57-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb57-3"><a href="#cb57-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(mclogit)</span>
<span id="cb57-4"><a href="#cb57-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(electors)</span>
<span id="cb57-5"><a href="#cb57-5"></a></span>
<span id="cb57-6"><a href="#cb57-6"></a><span class="co"># model</span></span>
<span id="cb57-7"><a href="#cb57-7"></a>mod &lt;-</span>
<span id="cb57-8"><a href="#cb57-8"></a><span class="st">  </span>mclogit<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/mclogit/man/mclogit.html">mclogit</a></span>(</span>
<span id="cb57-9"><a href="#cb57-9"></a>    <span class="dt">formula =</span> <span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(Freq, <span class="kw"><a href="https://rdrr.io/r/base/interaction.html">interaction</a></span>(time, class)) <span class="op">~</span><span class="st"> </span>econ.left <span class="op">/</span><span class="st"> </span>class <span class="op">+</span><span class="st"> </span>welfare <span class="op">/</span><span class="st"> </span>class <span class="op">+</span><span class="st"> </span>auth <span class="op">/</span><span class="st"> </span>class,</span>
<span id="cb57-10"><a href="#cb57-10"></a>    <span class="dt">random =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>party.time,</span>
<span id="cb57-11"><a href="#cb57-11"></a>    <span class="dt">control =</span> <span class="kw">mclogit.control</span>(<span class="dt">trace =</span> <span class="ot">FALSE</span>),</span>
<span id="cb57-12"><a href="#cb57-12"></a>    <span class="dt">data =</span> <span class="kw"><a href="https://rdrr.io/r/base/with.html">within</a></span>(electors, party.time &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/interaction.html">interaction</a></span>(party, time))</span>
<span id="cb57-13"><a href="#cb57-13"></a>  )</span>
<span id="cb57-14"><a href="#cb57-14"></a></span>
<span id="cb57-15"><a href="#cb57-15"></a><span class="co"># plot</span></span>
<span id="cb57-16"><a href="#cb57-16"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb57-17"><a href="#cb57-17"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb57-18"><a href="#cb57-18"></a>  <span class="dt">title =</span> <span class="st">"Mixed Conditional Logit Models"</span></span>
<span id="cb57-19"><a href="#cb57-19"></a>)</span>
<span id="cb57-20"><a href="#cb57-20"></a><span class="co">#&gt; Warning:  No. of factor levels is greater than default palette color count.</span></span>
<span id="cb57-21"><a href="#cb57-21"></a><span class="co">#&gt;  Try using another color `palette` (and/or `package`).</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/mmclogit-1.png" width="672"></p>
</div>
<div id="conditional-generalized-linear-models-for-clustered-data-cglm" class="section level2">
<h2 class="hasAnchor">
<a href="#conditional-generalized-linear-models-for-clustered-data-cglm" class="anchor"></a>conditional generalized linear models for clustered data (<code>cglm</code>)</h2>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="co"># setup</span></span>
<span id="cb58-2"><a href="#cb58-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb58-3"><a href="#cb58-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(cglm)</span>
<span id="cb58-4"><a href="#cb58-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(teenpov)</span>
<span id="cb58-5"><a href="#cb58-5"></a></span>
<span id="cb58-6"><a href="#cb58-6"></a><span class="co"># model</span></span>
<span id="cb58-7"><a href="#cb58-7"></a>fit.ide &lt;-</span>
<span id="cb58-8"><a href="#cb58-8"></a><span class="st">  </span>cglm<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/cglm/man/cglm.html">cglm</a></span>(</span>
<span id="cb58-9"><a href="#cb58-9"></a>    <span class="dt">method =</span> <span class="st">"ts"</span>,</span>
<span id="cb58-10"><a href="#cb58-10"></a>    <span class="dt">formula =</span> hours <span class="op">~</span><span class="st"> </span>nonpov <span class="op">+</span><span class="st"> </span>inschool <span class="op">+</span><span class="st"> </span>spouse <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>mother,</span>
<span id="cb58-11"><a href="#cb58-11"></a>    <span class="dt">data =</span> teenpov,</span>
<span id="cb58-12"><a href="#cb58-12"></a>    <span class="dt">id =</span> <span class="st">"ID"</span>,</span>
<span id="cb58-13"><a href="#cb58-13"></a>    <span class="dt">link =</span> <span class="st">"identity"</span></span>
<span id="cb58-14"><a href="#cb58-14"></a>  )</span>
<span id="cb58-15"><a href="#cb58-15"></a></span>
<span id="cb58-16"><a href="#cb58-16"></a><span class="co"># plot</span></span>
<span id="cb58-17"><a href="#cb58-17"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb58-18"><a href="#cb58-18"></a>  <span class="dt">x =</span> fit.ide,</span>
<span id="cb58-19"><a href="#cb58-19"></a>  <span class="dt">title =</span> <span class="st">"conditional generalized linear models</span><span class="ch">\n</span><span class="st"> for clustered data"</span></span>
<span id="cb58-20"><a href="#cb58-20"></a>)</span>
<span id="cb58-21"><a href="#cb58-21"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/cglm-1.png" width="576"></p>
</div>
<div id="cox-proportional-hazards-regression-model-coxph" class="section level2">
<h2 class="hasAnchor">
<a href="#cox-proportional-hazards-regression-model-coxph" class="anchor"></a>Cox proportional hazards regression model (<code>coxph</code>)</h2>
<p>Fitted proportional hazards regression model - as implemented in the <code>survival</code> package - can also be displayed in a dot-whisker plot.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb59-2"><a href="#cb59-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb59-3"><a href="#cb59-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(survival)</span>
<span id="cb59-4"><a href="#cb59-4"></a></span>
<span id="cb59-5"><a href="#cb59-5"></a><span class="co"># create the simplest test data set</span></span>
<span id="cb59-6"><a href="#cb59-6"></a>test1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</span>
<span id="cb59-7"><a href="#cb59-7"></a>  <span class="dt">time =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb59-8"><a href="#cb59-8"></a>  <span class="dt">status =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb59-9"><a href="#cb59-9"></a>  <span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb59-10"><a href="#cb59-10"></a>  <span class="dt">sex =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb59-11"><a href="#cb59-11"></a>)</span>
<span id="cb59-12"><a href="#cb59-12"></a></span>
<span id="cb59-13"><a href="#cb59-13"></a><span class="co"># fit a stratified model</span></span>
<span id="cb59-14"><a href="#cb59-14"></a>mod &lt;-<span class="st"> </span>survival<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/survival/man/coxph.html">coxph</a></span>(</span>
<span id="cb59-15"><a href="#cb59-15"></a>  <span class="dt">formula =</span> <span class="kw">Surv</span>(time, status) <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">strata</span>(sex),</span>
<span id="cb59-16"><a href="#cb59-16"></a>  <span class="dt">data =</span> test1</span>
<span id="cb59-17"><a href="#cb59-17"></a>)</span>
<span id="cb59-18"><a href="#cb59-18"></a></span>
<span id="cb59-19"><a href="#cb59-19"></a><span class="co"># plot</span></span>
<span id="cb59-20"><a href="#cb59-20"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb59-21"><a href="#cb59-21"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb59-22"><a href="#cb59-22"></a>  <span class="dt">exponentiate =</span> <span class="ot">TRUE</span>,</span>
<span id="cb59-23"><a href="#cb59-23"></a>  <span class="dt">title =</span> <span class="st">"Cox proportional hazards regression model"</span></span>
<span id="cb59-24"><a href="#cb59-24"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/coxph-1.png" width="384"></p>
</div>
<div id="mixed-effects-cox-model-coxme" class="section level2">
<h2 class="hasAnchor">
<a href="#mixed-effects-cox-model-coxme" class="anchor"></a>mixed effects Cox model (<code>coxme</code>)</h2>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="co"># setup</span></span>
<span id="cb60-2"><a href="#cb60-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb60-3"><a href="#cb60-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(survival)</span>
<span id="cb60-4"><a href="#cb60-4"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(coxme)</span>
<span id="cb60-5"><a href="#cb60-5"></a></span>
<span id="cb60-6"><a href="#cb60-6"></a><span class="co"># model</span></span>
<span id="cb60-7"><a href="#cb60-7"></a>fit &lt;-<span class="st"> </span><span class="kw">coxme</span>(<span class="kw">Surv</span>(y, uncens) <span class="op">~</span><span class="st"> </span>trt <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>center), eortc)</span>
<span id="cb60-8"><a href="#cb60-8"></a></span>
<span id="cb60-9"><a href="#cb60-9"></a><span class="co"># plot</span></span>
<span id="cb60-10"><a href="#cb60-10"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb60-11"><a href="#cb60-11"></a>  <span class="dt">x =</span> fit,</span>
<span id="cb60-12"><a href="#cb60-12"></a>  <span class="dt">exclude.intercept =</span> <span class="ot">FALSE</span>,</span>
<span id="cb60-13"><a href="#cb60-13"></a>  <span class="dt">title =</span> <span class="st">"mixed effects Cox model"</span></span>
<span id="cb60-14"><a href="#cb60-14"></a>)</span>
<span id="cb60-15"><a href="#cb60-15"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span>
<span id="cb60-16"><a href="#cb60-16"></a><span class="co">#&gt; Cox mixed-effects model fit by maximum likelihood</span></span>
<span id="cb60-17"><a href="#cb60-17"></a><span class="co">#&gt;   Data: eortc</span></span>
<span id="cb60-18"><a href="#cb60-18"></a><span class="co">#&gt;   events, n = 1463, 2323</span></span>
<span id="cb60-19"><a href="#cb60-19"></a><span class="co">#&gt;   Iterations= 9 49 </span></span>
<span id="cb60-20"><a href="#cb60-20"></a><span class="co">#&gt;                     NULL Integrated    Fitted</span></span>
<span id="cb60-21"><a href="#cb60-21"></a><span class="co">#&gt; Log-likelihood -10638.71  -10520.65 -10478.84</span></span>
<span id="cb60-22"><a href="#cb60-22"></a><span class="co">#&gt; </span></span>
<span id="cb60-23"><a href="#cb60-23"></a><span class="co">#&gt;                    Chisq    df p    AIC    BIC</span></span>
<span id="cb60-24"><a href="#cb60-24"></a><span class="co">#&gt; Integrated loglik 236.11  2.00 0 232.11 221.53</span></span>
<span id="cb60-25"><a href="#cb60-25"></a><span class="co">#&gt;  Penalized loglik 319.74 28.69 0 262.37 110.67</span></span>
<span id="cb60-26"><a href="#cb60-26"></a><span class="co">#&gt; </span></span>
<span id="cb60-27"><a href="#cb60-27"></a><span class="co">#&gt; Model:  Surv(y, uncens) ~ trt + (1 | center) </span></span>
<span id="cb60-28"><a href="#cb60-28"></a><span class="co">#&gt; Fixed coefficients</span></span>
<span id="cb60-29"><a href="#cb60-29"></a><span class="co">#&gt;          coef exp(coef)   se(coef)     z p</span></span>
<span id="cb60-30"><a href="#cb60-30"></a><span class="co">#&gt; trt 0.7086127  2.031171 0.06424398 11.03 0</span></span>
<span id="cb60-31"><a href="#cb60-31"></a><span class="co">#&gt; </span></span>
<span id="cb60-32"><a href="#cb60-32"></a><span class="co">#&gt; Random effects</span></span>
<span id="cb60-33"><a href="#cb60-33"></a><span class="co">#&gt;  Group  Variable  Std Dev   Variance </span></span>
<span id="cb60-34"><a href="#cb60-34"></a><span class="co">#&gt;  center Intercept 0.3292140 0.1083818</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/coxme-1.png" width="384"></p>
</div>
<div id="truncated-gaussian-regression-models-truncreg" class="section level2">
<h2 class="hasAnchor">
<a href="#truncated-gaussian-regression-models-truncreg" class="anchor"></a>truncated Gaussian Regression Models (<code>truncreg</code>)</h2>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="co"># setup</span></span>
<span id="cb61-2"><a href="#cb61-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb61-3"><a href="#cb61-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(truncreg)</span>
<span id="cb61-4"><a href="#cb61-4"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(survival)</span>
<span id="cb61-5"><a href="#cb61-5"></a></span>
<span id="cb61-6"><a href="#cb61-6"></a><span class="co"># data</span></span>
<span id="cb61-7"><a href="#cb61-7"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"tobin"</span>, <span class="dt">package =</span> <span class="st">"survival"</span>)</span>
<span id="cb61-8"><a href="#cb61-8"></a></span>
<span id="cb61-9"><a href="#cb61-9"></a><span class="co"># model</span></span>
<span id="cb61-10"><a href="#cb61-10"></a>cragg_trunc &lt;-</span>
<span id="cb61-11"><a href="#cb61-11"></a><span class="st">  </span><span class="kw">truncreg</span>(</span>
<span id="cb61-12"><a href="#cb61-12"></a>    <span class="dt">formula =</span> durable <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>quant,</span>
<span id="cb61-13"><a href="#cb61-13"></a>    <span class="dt">data =</span> tobin,</span>
<span id="cb61-14"><a href="#cb61-14"></a>    <span class="dt">subset =</span> durable <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span></span>
<span id="cb61-15"><a href="#cb61-15"></a>  )</span>
<span id="cb61-16"><a href="#cb61-16"></a></span>
<span id="cb61-17"><a href="#cb61-17"></a><span class="co"># plot</span></span>
<span id="cb61-18"><a href="#cb61-18"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb61-19"><a href="#cb61-19"></a>  <span class="dt">x =</span> cragg_trunc,</span>
<span id="cb61-20"><a href="#cb61-20"></a>  <span class="dt">title =</span> <span class="st">"Truncated Gaussian Regression Models"</span></span>
<span id="cb61-21"><a href="#cb61-21"></a>)</span>
<span id="cb61-22"><a href="#cb61-22"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/truncreg-1.png" width="480"></p>
</div>
<div id="autoregressive-integrated-moving-average-arima" class="section level2">
<h2 class="hasAnchor">
<a href="#autoregressive-integrated-moving-average-arima" class="anchor"></a>autoregressive integrated moving average (<code>Arima</code>)</h2>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb62-2"><a href="#cb62-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb62-3"><a href="#cb62-3"></a></span>
<span id="cb62-4"><a href="#cb62-4"></a><span class="co"># model</span></span>
<span id="cb62-5"><a href="#cb62-5"></a>fit &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/arima.html">arima</a></span>(<span class="dt">x =</span> lh, <span class="dt">order =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb62-6"><a href="#cb62-6"></a></span>
<span id="cb62-7"><a href="#cb62-7"></a><span class="co"># plot</span></span>
<span id="cb62-8"><a href="#cb62-8"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb62-9"><a href="#cb62-9"></a>  <span class="dt">x =</span> fit,</span>
<span id="cb62-10"><a href="#cb62-10"></a>  <span class="dt">title =</span> <span class="st">"autoregressive integrated moving average"</span></span>
<span id="cb62-11"><a href="#cb62-11"></a>)</span>
<span id="cb62-12"><a href="#cb62-12"></a><span class="co">#&gt; </span></span>
<span id="cb62-13"><a href="#cb62-13"></a><span class="co">#&gt; Could not extract p-values from model object.</span></span>
<span id="cb62-14"><a href="#cb62-14"></a><span class="co">#&gt; Note: No p-values and/or statistic available for the model object;</span></span>
<span id="cb62-15"><a href="#cb62-15"></a><span class="co">#&gt; skipping labels with statistical details.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/arima-1.png" width="480"></p>
</div>
<div id="high-performance-linear-model-speedlmspeedglm" class="section level2">
<h2 class="hasAnchor">
<a href="#high-performance-linear-model-speedlmspeedglm" class="anchor"></a>high performance linear model (<code>speedlm</code>/<code>speedglm</code>)</h2>
<p>Example of high performance linear model-</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="co"># model</span></span>
<span id="cb63-2"><a href="#cb63-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb63-3"><a href="#cb63-3"></a>mod &lt;-<span class="st"> </span>speedglm<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/speedglm/man/speedlm.html">speedlm</a></span>(</span>
<span id="cb63-4"><a href="#cb63-4"></a>  <span class="dt">formula =</span> mpg <span class="op">~</span><span class="st"> </span>wt <span class="op">+</span><span class="st"> </span>qsec,</span>
<span id="cb63-5"><a href="#cb63-5"></a>  <span class="dt">data =</span> mtcars,</span>
<span id="cb63-6"><a href="#cb63-6"></a>  <span class="dt">fitted =</span> <span class="ot">TRUE</span></span>
<span id="cb63-7"><a href="#cb63-7"></a>)</span>
<span id="cb63-8"><a href="#cb63-8"></a></span>
<span id="cb63-9"><a href="#cb63-9"></a><span class="co"># plot</span></span>
<span id="cb63-10"><a href="#cb63-10"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb63-11"><a href="#cb63-11"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb63-12"><a href="#cb63-12"></a>  <span class="dt">title =</span> <span class="st">"high performance linear model"</span>,</span>
<span id="cb63-13"><a href="#cb63-13"></a>  <span class="dt">exclude.intercept =</span> <span class="ot">FALSE</span></span>
<span id="cb63-14"><a href="#cb63-14"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/speedlm-1.png" width="480"></p>
<p>Example of high performance generalized linear model-</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="co"># setup</span></span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb64-3"><a href="#cb64-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(speedglm)</span>
<span id="cb64-4"><a href="#cb64-4"></a></span>
<span id="cb64-5"><a href="#cb64-5"></a><span class="co"># data</span></span>
<span id="cb64-6"><a href="#cb64-6"></a>n &lt;-<span class="st"> </span><span class="dv">50000</span></span>
<span id="cb64-7"><a href="#cb64-7"></a>k &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb64-8"><a href="#cb64-8"></a>y &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/GammaDist.html">rgamma</a></span>(n, <span class="fl">1.5</span>, <span class="dv">1</span>)</span>
<span id="cb64-9"><a href="#cb64-9"></a>x &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(n <span class="op">*</span><span class="st"> </span>k), n, k), <span class="dt">digits =</span> <span class="dv">3</span>)</span>
<span id="cb64-10"><a href="#cb64-10"></a><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(x) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"s"</span>, <span class="dv">1</span><span class="op">:</span>k, <span class="dt">sep =</span> <span class="st">""</span>)</span>
<span id="cb64-11"><a href="#cb64-11"></a>da &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(y, x)</span>
<span id="cb64-12"><a href="#cb64-12"></a>fo &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"y~"</span>, <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"s"</span>, <span class="dv">1</span><span class="op">:</span>k, <span class="dt">sep =</span> <span class="st">""</span>), <span class="dt">collapse =</span> <span class="st">"+"</span>)))</span>
<span id="cb64-13"><a href="#cb64-13"></a></span>
<span id="cb64-14"><a href="#cb64-14"></a><span class="co"># model</span></span>
<span id="cb64-15"><a href="#cb64-15"></a>mod &lt;-<span class="st"> </span>speedglm<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/speedglm/man/speedglm.html">speedglm</a></span>(</span>
<span id="cb64-16"><a href="#cb64-16"></a>  <span class="dt">formula =</span> fo,</span>
<span id="cb64-17"><a href="#cb64-17"></a>  <span class="dt">data =</span> da,</span>
<span id="cb64-18"><a href="#cb64-18"></a>  <span class="dt">family =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/family.html">Gamma</a></span>(log)</span>
<span id="cb64-19"><a href="#cb64-19"></a>)</span>
<span id="cb64-20"><a href="#cb64-20"></a></span>
<span id="cb64-21"><a href="#cb64-21"></a><span class="co"># plot</span></span>
<span id="cb64-22"><a href="#cb64-22"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb64-23"><a href="#cb64-23"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb64-24"><a href="#cb64-24"></a>  <span class="dt">title =</span> <span class="st">"high performance generalized linear model"</span></span>
<span id="cb64-25"><a href="#cb64-25"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/speedglm-1.png" width="480"></p>
</div>
<div id="bounded-memory-linear-regression-biglm" class="section level2">
<h2 class="hasAnchor">
<a href="#bounded-memory-linear-regression-biglm" class="anchor"></a>bounded memory linear regression (<code>biglm</code>)</h2>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="co"># setup</span></span>
<span id="cb65-2"><a href="#cb65-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb65-3"><a href="#cb65-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(biglm)</span>
<span id="cb65-4"><a href="#cb65-4"></a></span>
<span id="cb65-5"><a href="#cb65-5"></a><span class="co"># model</span></span>
<span id="cb65-6"><a href="#cb65-6"></a>bfit1 &lt;-<span class="st"> </span><span class="kw">biglm</span>(</span>
<span id="cb65-7"><a href="#cb65-7"></a>  <span class="dt">formula =</span> <span class="kw"><a href="https://rdrr.io/r/base/scale.html">scale</a></span>(mpg) <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/scale.html">scale</a></span>(wt) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/scale.html">scale</a></span>(disp),</span>
<span id="cb65-8"><a href="#cb65-8"></a>  <span class="dt">data =</span> mtcars</span>
<span id="cb65-9"><a href="#cb65-9"></a>)</span>
<span id="cb65-10"><a href="#cb65-10"></a></span>
<span id="cb65-11"><a href="#cb65-11"></a><span class="co"># plot</span></span>
<span id="cb65-12"><a href="#cb65-12"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb65-13"><a href="#cb65-13"></a>  <span class="dt">x =</span> bfit1,</span>
<span id="cb65-14"><a href="#cb65-14"></a>  <span class="dt">title =</span> <span class="st">"bounded memory simple linear regression"</span>,</span>
<span id="cb65-15"><a href="#cb65-15"></a>  <span class="dt">exclude.intercept =</span> <span class="ot">FALSE</span></span>
<span id="cb65-16"><a href="#cb65-16"></a>)</span>
<span id="cb65-17"><a href="#cb65-17"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span>
<span id="cb65-18"><a href="#cb65-18"></a><span class="co">#&gt; Note: No p-values and/or statistic available for the model object;</span></span>
<span id="cb65-19"><a href="#cb65-19"></a><span class="co">#&gt; skipping labels with statistical details.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/biglm-1.png" width="576"></p>
</div>
<div id="bounded-memory-general-linear-regression-bigglm" class="section level2">
<h2 class="hasAnchor">
<a href="#bounded-memory-general-linear-regression-bigglm" class="anchor"></a>bounded memory general linear regression (<code>bigglm</code>)</h2>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="co"># setup</span></span>
<span id="cb66-2"><a href="#cb66-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb66-3"><a href="#cb66-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(biglm)</span>
<span id="cb66-4"><a href="#cb66-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(trees)</span>
<span id="cb66-5"><a href="#cb66-5"></a></span>
<span id="cb66-6"><a href="#cb66-6"></a><span class="co"># model</span></span>
<span id="cb66-7"><a href="#cb66-7"></a>mod &lt;-<span class="st"> </span>biglm<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/biglm/man/bigglm.html">bigglm</a></span>(</span>
<span id="cb66-8"><a href="#cb66-8"></a>  <span class="dt">formula =</span> <span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(Volume) <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(Girth) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(Height),</span>
<span id="cb66-9"><a href="#cb66-9"></a>  <span class="dt">data =</span> trees,</span>
<span id="cb66-10"><a href="#cb66-10"></a>  <span class="dt">chunksize =</span> <span class="dv">10</span>,</span>
<span id="cb66-11"><a href="#cb66-11"></a>  <span class="dt">sandwich =</span> <span class="ot">TRUE</span></span>
<span id="cb66-12"><a href="#cb66-12"></a>)</span>
<span id="cb66-13"><a href="#cb66-13"></a><span class="co"># plot</span></span>
<span id="cb66-14"><a href="#cb66-14"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb66-15"><a href="#cb66-15"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb66-16"><a href="#cb66-16"></a>  <span class="dt">title =</span> <span class="st">"bounded memory general linear regression"</span></span>
<span id="cb66-17"><a href="#cb66-17"></a>)</span>
<span id="cb66-18"><a href="#cb66-18"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span>
<span id="cb66-19"><a href="#cb66-19"></a><span class="co">#&gt; Note: No p-values and/or statistic available for the model object;</span></span>
<span id="cb66-20"><a href="#cb66-20"></a><span class="co">#&gt; skipping labels with statistical details.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/bigglm-1.png" width="576"></p>
</div>
<div id="parametric-survival-regression-model-survreg" class="section level2">
<h2 class="hasAnchor">
<a href="#parametric-survival-regression-model-survreg" class="anchor"></a>parametric survival regression model (<code>survreg</code>)</h2>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="co"># setup</span></span>
<span id="cb67-2"><a href="#cb67-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb67-3"><a href="#cb67-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(survival)</span>
<span id="cb67-4"><a href="#cb67-4"></a></span>
<span id="cb67-5"><a href="#cb67-5"></a><span class="co"># model</span></span>
<span id="cb67-6"><a href="#cb67-6"></a>mod &lt;-<span class="st"> </span>survival<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/survival/man/survreg.html">survreg</a></span>(</span>
<span id="cb67-7"><a href="#cb67-7"></a>  <span class="dt">formula =</span> <span class="kw">Surv</span>(futime, fustat) <span class="op">~</span><span class="st"> </span>ecog.ps <span class="op">+</span><span class="st"> </span>rx,</span>
<span id="cb67-8"><a href="#cb67-8"></a>  <span class="dt">data =</span> ovarian,</span>
<span id="cb67-9"><a href="#cb67-9"></a>  <span class="dt">dist =</span> <span class="st">"logistic"</span></span>
<span id="cb67-10"><a href="#cb67-10"></a>)</span>
<span id="cb67-11"><a href="#cb67-11"></a></span>
<span id="cb67-12"><a href="#cb67-12"></a><span class="co"># plot</span></span>
<span id="cb67-13"><a href="#cb67-13"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb67-14"><a href="#cb67-14"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb67-15"><a href="#cb67-15"></a>  <span class="dt">exclude.intercept =</span> <span class="ot">FALSE</span>,</span>
<span id="cb67-16"><a href="#cb67-16"></a>  <span class="dt">ggtheme =</span> hrbrthemes<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/hrbrthemes/man/theme_ipsum_rc.html">theme_ipsum_rc</a></span>(),</span>
<span id="cb67-17"><a href="#cb67-17"></a>  <span class="dt">package =</span> <span class="st">"ggsci"</span>,</span>
<span id="cb67-18"><a href="#cb67-18"></a>  <span class="dt">palette =</span> <span class="st">"legacy_tron"</span>,</span>
<span id="cb67-19"><a href="#cb67-19"></a>  <span class="dt">title =</span> <span class="st">"parametric survival regression model"</span></span>
<span id="cb67-20"><a href="#cb67-20"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/survreg-1.png" width="480"></p>
</div>
<div id="fixed-effects-individual-slope-estimator-feis" class="section level2">
<h2 class="hasAnchor">
<a href="#fixed-effects-individual-slope-estimator-feis" class="anchor"></a>Fixed Effects Individual Slope Estimator (<code>feis</code>)</h2>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="co"># setup</span></span>
<span id="cb68-2"><a href="#cb68-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb68-3"><a href="#cb68-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(feisr)</span>
<span id="cb68-4"><a href="#cb68-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"mwp"</span>, <span class="dt">package =</span> <span class="st">"feisr"</span>)</span>
<span id="cb68-5"><a href="#cb68-5"></a></span>
<span id="cb68-6"><a href="#cb68-6"></a><span class="co"># model</span></span>
<span id="cb68-7"><a href="#cb68-7"></a>feis.mod &lt;-</span>
<span id="cb68-8"><a href="#cb68-8"></a><span class="st">  </span><span class="kw">feis</span>(</span>
<span id="cb68-9"><a href="#cb68-9"></a>    <span class="dt">formula =</span> lnw <span class="op">~</span><span class="st"> </span>marry <span class="op">+</span><span class="st"> </span>enrol <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(yeargr) <span class="op">|</span><span class="st"> </span>exp <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span>(exp<span class="op">^</span><span class="dv">2</span>),</span>
<span id="cb68-10"><a href="#cb68-10"></a>    <span class="dt">data =</span> mwp,</span>
<span id="cb68-11"><a href="#cb68-11"></a>    <span class="dt">id =</span> <span class="st">"id"</span>,</span>
<span id="cb68-12"><a href="#cb68-12"></a>    <span class="dt">robust =</span> <span class="ot">TRUE</span></span>
<span id="cb68-13"><a href="#cb68-13"></a>  )</span>
<span id="cb68-14"><a href="#cb68-14"></a></span>
<span id="cb68-15"><a href="#cb68-15"></a><span class="co"># plot</span></span>
<span id="cb68-16"><a href="#cb68-16"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb68-17"><a href="#cb68-17"></a>  <span class="dt">x =</span> feis.mod,</span>
<span id="cb68-18"><a href="#cb68-18"></a>  <span class="dt">title =</span> <span class="st">"Fixed Effects Individual Slope Estimator"</span></span>
<span id="cb68-19"><a href="#cb68-19"></a>)</span>
<span id="cb68-20"><a href="#cb68-20"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/feis-1.png" width="576"></p>
</div>
<div id="tobit-regression-tobit" class="section level2">
<h2 class="hasAnchor">
<a href="#tobit-regression-tobit" class="anchor"></a>tobit regression (<code>tobit</code>)</h2>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="co"># setup</span></span>
<span id="cb69-2"><a href="#cb69-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb69-3"><a href="#cb69-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(AER)</span>
<span id="cb69-4"><a href="#cb69-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"Affairs"</span>, <span class="dt">package =</span> <span class="st">"AER"</span>)</span>
<span id="cb69-5"><a href="#cb69-5"></a></span>
<span id="cb69-6"><a href="#cb69-6"></a><span class="co"># model</span></span>
<span id="cb69-7"><a href="#cb69-7"></a>m1 &lt;-</span>
<span id="cb69-8"><a href="#cb69-8"></a><span class="st">  </span>AER<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/AER/man/tobit.html">tobit</a></span>(</span>
<span id="cb69-9"><a href="#cb69-9"></a>    <span class="dt">formula =</span> affairs <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>yearsmarried <span class="op">+</span><span class="st"> </span>religiousness <span class="op">+</span><span class="st"> </span>occupation <span class="op">+</span><span class="st"> </span>rating,</span>
<span id="cb69-10"><a href="#cb69-10"></a>    <span class="dt">data =</span> Affairs</span>
<span id="cb69-11"><a href="#cb69-11"></a>  )</span>
<span id="cb69-12"><a href="#cb69-12"></a></span>
<span id="cb69-13"><a href="#cb69-13"></a><span class="co"># plot</span></span>
<span id="cb69-14"><a href="#cb69-14"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb69-15"><a href="#cb69-15"></a>  <span class="dt">x =</span> m1,</span>
<span id="cb69-16"><a href="#cb69-16"></a>  <span class="dt">title =</span> <span class="st">"tobit regression"</span></span>
<span id="cb69-17"><a href="#cb69-17"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/tobit-1.png" width="480"></p>
</div>
<div id="aalens-additive-regression-model-for-censored-data-aareg" class="section level2">
<h2 class="hasAnchor">
<a href="#aalens-additive-regression-model-for-censored-data-aareg" class="anchor"></a>Aalen’s additive regression model for censored data (<code>aareg</code>)</h2>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="co"># model</span></span>
<span id="cb70-2"><a href="#cb70-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(survival)</span>
<span id="cb70-3"><a href="#cb70-3"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb70-4"><a href="#cb70-4"></a>afit &lt;-<span class="st"> </span>survival<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/survival/man/aareg.html">aareg</a></span>(</span>
<span id="cb70-5"><a href="#cb70-5"></a>  <span class="dt">formula =</span> <span class="kw">Surv</span>(time, status) <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>ph.ecog,</span>
<span id="cb70-6"><a href="#cb70-6"></a>  <span class="dt">data =</span> lung,</span>
<span id="cb70-7"><a href="#cb70-7"></a>  <span class="dt">dfbeta =</span> <span class="ot">TRUE</span></span>
<span id="cb70-8"><a href="#cb70-8"></a>)</span>
<span id="cb70-9"><a href="#cb70-9"></a></span>
<span id="cb70-10"><a href="#cb70-10"></a><span class="co"># plot</span></span>
<span id="cb70-11"><a href="#cb70-11"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb70-12"><a href="#cb70-12"></a>  <span class="dt">x =</span> afit,</span>
<span id="cb70-13"><a href="#cb70-13"></a>  <span class="dt">title =</span> <span class="st">"Aalen's additive regression model"</span>,</span>
<span id="cb70-14"><a href="#cb70-14"></a>  <span class="dt">subtitle =</span> <span class="st">"(for censored data)"</span>,</span>
<span id="cb70-15"><a href="#cb70-15"></a>  <span class="dt">k =</span> <span class="dv">3</span></span>
<span id="cb70-16"><a href="#cb70-16"></a>)</span>
<span id="cb70-17"><a href="#cb70-17"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/aareg-1.png" width="480"></p>
</div>
<div id="relative-risk-regression-model-for-case-cohort-studies-cch" class="section level2">
<h2 class="hasAnchor">
<a href="#relative-risk-regression-model-for-case-cohort-studies-cch" class="anchor"></a>relative risk regression model for case-cohort studies (<code>cch</code>)</h2>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="co"># setup</span></span>
<span id="cb71-2"><a href="#cb71-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb71-3"><a href="#cb71-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(survival)</span>
<span id="cb71-4"><a href="#cb71-4"></a></span>
<span id="cb71-5"><a href="#cb71-5"></a><span class="co"># examples come from cch documentation</span></span>
<span id="cb71-6"><a href="#cb71-6"></a>subcoh &lt;-<span class="st"> </span>nwtco<span class="op">$</span>in.subcohort</span>
<span id="cb71-7"><a href="#cb71-7"></a>selccoh &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/with.html">with</a></span>(nwtco, rel <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>subcoh <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb71-8"><a href="#cb71-8"></a>ccoh.data &lt;-<span class="st"> </span>nwtco[selccoh, ]</span>
<span id="cb71-9"><a href="#cb71-9"></a>ccoh.data<span class="op">$</span>subcohort &lt;-<span class="st"> </span>subcoh[selccoh]</span>
<span id="cb71-10"><a href="#cb71-10"></a></span>
<span id="cb71-11"><a href="#cb71-11"></a><span class="co">## central-lab histology</span></span>
<span id="cb71-12"><a href="#cb71-12"></a>ccoh.data<span class="op">$</span>histol &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(ccoh.data<span class="op">$</span>histol, <span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"FH"</span>, <span class="st">"UH"</span>))</span>
<span id="cb71-13"><a href="#cb71-13"></a></span>
<span id="cb71-14"><a href="#cb71-14"></a><span class="co">## tumour stage</span></span>
<span id="cb71-15"><a href="#cb71-15"></a>ccoh.data<span class="op">$</span>stage &lt;-</span>
<span id="cb71-16"><a href="#cb71-16"></a><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(ccoh.data<span class="op">$</span>stage, <span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"I"</span>, <span class="st">"II"</span>, <span class="st">"III"</span>, <span class="st">"IV"</span>))</span>
<span id="cb71-17"><a href="#cb71-17"></a>ccoh.data<span class="op">$</span>age &lt;-<span class="st"> </span>ccoh.data<span class="op">$</span>age <span class="op">/</span><span class="st"> </span><span class="dv">12</span> <span class="co"># Age in years</span></span>
<span id="cb71-18"><a href="#cb71-18"></a></span>
<span id="cb71-19"><a href="#cb71-19"></a><span class="co"># model</span></span>
<span id="cb71-20"><a href="#cb71-20"></a>fit.ccP &lt;-</span>
<span id="cb71-21"><a href="#cb71-21"></a><span class="st">  </span>survival<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/survival/man/cch.html">cch</a></span>(</span>
<span id="cb71-22"><a href="#cb71-22"></a>    <span class="dt">formula =</span> <span class="kw">Surv</span>(edrel, rel) <span class="op">~</span><span class="st"> </span>stage <span class="op">+</span><span class="st"> </span>histol <span class="op">+</span><span class="st"> </span>age,</span>
<span id="cb71-23"><a href="#cb71-23"></a>    <span class="dt">data =</span> ccoh.data,</span>
<span id="cb71-24"><a href="#cb71-24"></a>    <span class="dt">subcoh =</span> <span class="op">~</span>subcohort,</span>
<span id="cb71-25"><a href="#cb71-25"></a>    <span class="dt">id =</span> <span class="op">~</span>seqno,</span>
<span id="cb71-26"><a href="#cb71-26"></a>    <span class="dt">cohort.size =</span> <span class="dv">4028</span></span>
<span id="cb71-27"><a href="#cb71-27"></a>  )</span>
<span id="cb71-28"><a href="#cb71-28"></a></span>
<span id="cb71-29"><a href="#cb71-29"></a><span class="co"># plot</span></span>
<span id="cb71-30"><a href="#cb71-30"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb71-31"><a href="#cb71-31"></a>  <span class="dt">x =</span> fit.ccP,</span>
<span id="cb71-32"><a href="#cb71-32"></a>  <span class="dt">title =</span> <span class="st">"relative risk regression model"</span>,</span>
<span id="cb71-33"><a href="#cb71-33"></a>  <span class="dt">subtitle =</span> <span class="st">"(for case-cohort studies)"</span>,</span>
<span id="cb71-34"><a href="#cb71-34"></a>  <span class="dt">conf.level =</span> <span class="fl">0.99</span></span>
<span id="cb71-35"><a href="#cb71-35"></a>)</span>
<span id="cb71-36"><a href="#cb71-36"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/cch-1.png" width="576"></p>
</div>
<div id="ridge-regression-ridgelm" class="section level2">
<h2 class="hasAnchor">
<a href="#ridge-regression-ridgelm" class="anchor"></a>ridge regression (<code>ridgelm</code>)</h2>
<p>For ridge regression, neither statistic values nor confidence intervals for estimates are available, so only estimates will be displayed.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="co"># setup</span></span>
<span id="cb72-2"><a href="#cb72-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb72-3"><a href="#cb72-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(MASS)</span>
<span id="cb72-4"><a href="#cb72-4"></a></span>
<span id="cb72-5"><a href="#cb72-5"></a><span class="co"># model</span></span>
<span id="cb72-6"><a href="#cb72-6"></a><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(longley)[<span class="dv">1</span>] &lt;-<span class="st"> "y"</span></span>
<span id="cb72-7"><a href="#cb72-7"></a>mod &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/MASS/man/lm.ridge.html">lm.ridge</a></span>(<span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> longley)</span>
<span id="cb72-8"><a href="#cb72-8"></a></span>
<span id="cb72-9"><a href="#cb72-9"></a><span class="co"># plot</span></span>
<span id="cb72-10"><a href="#cb72-10"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb72-11"><a href="#cb72-11"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb72-12"><a href="#cb72-12"></a>  <span class="dt">title =</span> <span class="st">"ridge regression"</span>,</span>
<span id="cb72-13"><a href="#cb72-13"></a>  <span class="dt">point.color =</span> <span class="st">"red"</span>,</span>
<span id="cb72-14"><a href="#cb72-14"></a>  <span class="dt">point.shape =</span> <span class="dv">6</span>,</span>
<span id="cb72-15"><a href="#cb72-15"></a>  <span class="dt">point.size =</span> <span class="dv">5</span></span>
<span id="cb72-16"><a href="#cb72-16"></a>)</span>
<span id="cb72-17"><a href="#cb72-17"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span>
<span id="cb72-18"><a href="#cb72-18"></a><span class="co">#&gt; </span></span>
<span id="cb72-19"><a href="#cb72-19"></a><span class="co">#&gt; Could not extract p-values from model object.</span></span>
<span id="cb72-20"><a href="#cb72-20"></a><span class="co">#&gt; Note: No p-values and/or statistic available for the model object;</span></span>
<span id="cb72-21"><a href="#cb72-21"></a><span class="co">#&gt; skipping labels with statistical details.</span></span>
<span id="cb72-22"><a href="#cb72-22"></a><span class="co">#&gt; Note: No confidence intervals available for regression coefficientsobject, so skipping whiskers in the plot.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/ridgelm-1.png" width="480"></p>
</div>
<div id="generalized-additive-models-with-integrated-smoothness-estimation-gam" class="section level2">
<h2 class="hasAnchor">
<a href="#generalized-additive-models-with-integrated-smoothness-estimation-gam" class="anchor"></a>generalized additive models with integrated smoothness estimation (<code>gam</code>)</h2>
<p><strong>Important</strong>: These model outputs contains both parametric and smooth terms. <code>ggcoefstats</code> only displays the parametric terms.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="co"># setup</span></span>
<span id="cb73-2"><a href="#cb73-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb73-3"><a href="#cb73-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(mgcv)</span>
<span id="cb73-4"><a href="#cb73-4"></a></span>
<span id="cb73-5"><a href="#cb73-5"></a><span class="co"># model</span></span>
<span id="cb73-6"><a href="#cb73-6"></a>g &lt;-<span class="st"> </span>mgcv<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span>(</span>
<span id="cb73-7"><a href="#cb73-7"></a>  <span class="dt">formula =</span> mpg <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(hp) <span class="op">+</span><span class="st"> </span>am <span class="op">+</span><span class="st"> </span>qsec,</span>
<span id="cb73-8"><a href="#cb73-8"></a>  <span class="dt">family =</span> stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/family.html">quasi</a></span>(),</span>
<span id="cb73-9"><a href="#cb73-9"></a>  <span class="dt">data =</span> mtcars</span>
<span id="cb73-10"><a href="#cb73-10"></a>)</span>
<span id="cb73-11"><a href="#cb73-11"></a></span>
<span id="cb73-12"><a href="#cb73-12"></a><span class="co"># plot</span></span>
<span id="cb73-13"><a href="#cb73-13"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb73-14"><a href="#cb73-14"></a>  <span class="dt">x =</span> g,</span>
<span id="cb73-15"><a href="#cb73-15"></a>  <span class="dt">title =</span> <span class="st">"generalized additive models </span><span class="ch">\n</span><span class="st">with integrated smoothness estimation"</span>,</span>
<span id="cb73-16"><a href="#cb73-16"></a>  <span class="dt">subtitle =</span> <span class="st">"using `mgcv` package"</span></span>
<span id="cb73-17"><a href="#cb73-17"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/gam_mgcv-1.png" width="480"></p>
</div>
<div id="generalized-additive-model-gam" class="section level2">
<h2 class="hasAnchor">
<a href="#generalized-additive-model-gam" class="anchor"></a>generalized additive model (<code>Gam</code>)</h2>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="co"># setup</span></span>
<span id="cb74-2"><a href="#cb74-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb74-3"><a href="#cb74-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(gam)</span>
<span id="cb74-4"><a href="#cb74-4"></a></span>
<span id="cb74-5"><a href="#cb74-5"></a><span class="co"># model</span></span>
<span id="cb74-6"><a href="#cb74-6"></a>g &lt;-<span class="st"> </span>gam<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/gam/man/gam.html">gam</a></span>(</span>
<span id="cb74-7"><a href="#cb74-7"></a>  <span class="dt">formula =</span> mpg <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(hp, <span class="dv">4</span>) <span class="op">+</span><span class="st"> </span>am <span class="op">+</span><span class="st"> </span>qsec,</span>
<span id="cb74-8"><a href="#cb74-8"></a>  <span class="dt">data =</span> mtcars</span>
<span id="cb74-9"><a href="#cb74-9"></a>)</span>
<span id="cb74-10"><a href="#cb74-10"></a></span>
<span id="cb74-11"><a href="#cb74-11"></a><span class="co"># plot</span></span>
<span id="cb74-12"><a href="#cb74-12"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb74-13"><a href="#cb74-13"></a>  <span class="dt">x =</span> g,</span>
<span id="cb74-14"><a href="#cb74-14"></a>  <span class="dt">title =</span> <span class="st">"generalized additive model"</span>,</span>
<span id="cb74-15"><a href="#cb74-15"></a>  <span class="dt">subtite =</span> <span class="st">"(using `gam` package)"</span></span>
<span id="cb74-16"><a href="#cb74-16"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/Gam-1.png" width="480"></p>
</div>
<div id="linear-mixed-effects-models-lme" class="section level2">
<h2 class="hasAnchor">
<a href="#linear-mixed-effects-models-lme" class="anchor"></a>linear mixed-effects models (<code>lme</code>)</h2>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb75-2"><a href="#cb75-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb75-3"><a href="#cb75-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(lme4)</span>
<span id="cb75-4"><a href="#cb75-4"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(nlme)</span>
<span id="cb75-5"><a href="#cb75-5"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"sleepstudy"</span>)</span>
<span id="cb75-6"><a href="#cb75-6"></a></span>
<span id="cb75-7"><a href="#cb75-7"></a><span class="co"># model</span></span>
<span id="cb75-8"><a href="#cb75-8"></a>mod &lt;-</span>
<span id="cb75-9"><a href="#cb75-9"></a><span class="st">  </span>nlme<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/nlme/man/lme.html">lme</a></span>(</span>
<span id="cb75-10"><a href="#cb75-10"></a>    <span class="dt">fixed =</span> Reaction <span class="op">~</span><span class="st"> </span>Days,</span>
<span id="cb75-11"><a href="#cb75-11"></a>    <span class="dt">random =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Days <span class="op">|</span><span class="st"> </span>Subject,</span>
<span id="cb75-12"><a href="#cb75-12"></a>    <span class="dt">data =</span> sleepstudy</span>
<span id="cb75-13"><a href="#cb75-13"></a>  )</span>
<span id="cb75-14"><a href="#cb75-14"></a></span>
<span id="cb75-15"><a href="#cb75-15"></a><span class="co"># plot</span></span>
<span id="cb75-16"><a href="#cb75-16"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb75-17"><a href="#cb75-17"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb75-18"><a href="#cb75-18"></a>  <span class="dt">title =</span> <span class="st">"linear mixed-effects models (`lme`)"</span></span>
<span id="cb75-19"><a href="#cb75-19"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/lme-1.png" width="480"></p>
</div>
<div id="linear-model-using-generalized-least-squares-gls" class="section level2">
<h2 class="hasAnchor">
<a href="#linear-model-using-generalized-least-squares-gls" class="anchor"></a>linear model using generalized least squares (<code>gls</code>)</h2>
<p>The <code>nlme</code> package provides a function to fit a linear model using generalized least squares. The errors are allowed to be correlated and/or have unequal variances.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb76-2"><a href="#cb76-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb76-3"><a href="#cb76-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(nlme)</span>
<span id="cb76-4"><a href="#cb76-4"></a></span>
<span id="cb76-5"><a href="#cb76-5"></a><span class="co"># model</span></span>
<span id="cb76-6"><a href="#cb76-6"></a>mod &lt;-</span>
<span id="cb76-7"><a href="#cb76-7"></a><span class="st">  </span>nlme<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/nlme/man/gls.html">gls</a></span>(</span>
<span id="cb76-8"><a href="#cb76-8"></a>    <span class="dt">model =</span> follicles <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi <span class="op">*</span><span class="st"> </span>Time) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi <span class="op">*</span><span class="st"> </span>Time),</span>
<span id="cb76-9"><a href="#cb76-9"></a>    <span class="dt">data =</span> Ovary,</span>
<span id="cb76-10"><a href="#cb76-10"></a>    <span class="dt">correlation =</span> <span class="kw">corAR1</span>(<span class="dt">form =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Mare)</span>
<span id="cb76-11"><a href="#cb76-11"></a>  )</span>
<span id="cb76-12"><a href="#cb76-12"></a></span>
<span id="cb76-13"><a href="#cb76-13"></a><span class="co"># plot</span></span>
<span id="cb76-14"><a href="#cb76-14"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb76-15"><a href="#cb76-15"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb76-16"><a href="#cb76-16"></a>  <span class="dt">point.color =</span> <span class="st">"red"</span>,</span>
<span id="cb76-17"><a href="#cb76-17"></a>  <span class="dt">stats.label.color =</span> <span class="st">"black"</span>,</span>
<span id="cb76-18"><a href="#cb76-18"></a>  <span class="dt">ggtheme =</span> hrbrthemes<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/hrbrthemes/man/theme_ipsum_ps.html">theme_ipsum_ps</a></span>(),</span>
<span id="cb76-19"><a href="#cb76-19"></a>  <span class="dt">ggstatsplot.layer =</span> <span class="ot">FALSE</span>,</span>
<span id="cb76-20"><a href="#cb76-20"></a>  <span class="dt">exclude.intercept =</span> <span class="ot">FALSE</span>,</span>
<span id="cb76-21"><a href="#cb76-21"></a>  <span class="dt">title =</span> <span class="st">"generalized least squares model"</span></span>
<span id="cb76-22"><a href="#cb76-22"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/gls-1.png" width="576"></p>
</div>
<div id="ordinary-least-squares-with-robust-standard-errors-lm_robust" class="section level2">
<h2 class="hasAnchor">
<a href="#ordinary-least-squares-with-robust-standard-errors-lm_robust" class="anchor"></a>ordinary least squares with robust standard errors (<code>lm_robust</code>)</h2>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb77-2"><a href="#cb77-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb77-3"><a href="#cb77-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(estimatr)</span>
<span id="cb77-4"><a href="#cb77-4"></a></span>
<span id="cb77-5"><a href="#cb77-5"></a><span class="co"># model</span></span>
<span id="cb77-6"><a href="#cb77-6"></a>mod &lt;-<span class="st"> </span><span class="kw">lm_robust</span>(</span>
<span id="cb77-7"><a href="#cb77-7"></a>  <span class="dt">formula =</span> mpg <span class="op">~</span><span class="st"> </span>gear <span class="op">+</span><span class="st"> </span>wt <span class="op">+</span><span class="st"> </span>cyl,</span>
<span id="cb77-8"><a href="#cb77-8"></a>  <span class="dt">data =</span> mtcars</span>
<span id="cb77-9"><a href="#cb77-9"></a>)</span>
<span id="cb77-10"><a href="#cb77-10"></a></span>
<span id="cb77-11"><a href="#cb77-11"></a><span class="co"># plot</span></span>
<span id="cb77-12"><a href="#cb77-12"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb77-13"><a href="#cb77-13"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb77-14"><a href="#cb77-14"></a>  <span class="dt">title =</span> <span class="st">"ordinary least squares </span><span class="ch">\n</span><span class="st">with robust standard errors"</span></span>
<span id="cb77-15"><a href="#cb77-15"></a>)</span>
<span id="cb77-16"><a href="#cb77-16"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/lm_robust-1.png" width="480"></p>
</div>
<div id="inference-for-estimated-coefficients-coeftest" class="section level2">
<h2 class="hasAnchor">
<a href="#inference-for-estimated-coefficients-coeftest" class="anchor"></a>inference for estimated coefficients (<code>coeftest</code>)</h2>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="co"># setup</span></span>
<span id="cb78-2"><a href="#cb78-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb78-3"><a href="#cb78-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(lmtest)</span>
<span id="cb78-4"><a href="#cb78-4"></a></span>
<span id="cb78-5"><a href="#cb78-5"></a><span class="co"># load data and fit model</span></span>
<span id="cb78-6"><a href="#cb78-6"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"Mandible"</span>, <span class="dt">package =</span> <span class="st">"lmtest"</span>)</span>
<span id="cb78-7"><a href="#cb78-7"></a>fm &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="dt">formula =</span> length <span class="op">~</span><span class="st"> </span>age, <span class="dt">data =</span> Mandible, <span class="dt">subset =</span> (age <span class="op">&lt;=</span><span class="st"> </span><span class="dv">28</span>))</span>
<span id="cb78-8"><a href="#cb78-8"></a></span>
<span id="cb78-9"><a href="#cb78-9"></a><span class="co"># the following commands lead to the same tests:</span></span>
<span id="cb78-10"><a href="#cb78-10"></a>ct &lt;-<span class="st"> </span>lmtest<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html">coeftest</a></span>(fm)</span>
<span id="cb78-11"><a href="#cb78-11"></a></span>
<span id="cb78-12"><a href="#cb78-12"></a><span class="co"># plot</span></span>
<span id="cb78-13"><a href="#cb78-13"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb78-14"><a href="#cb78-14"></a>  <span class="dt">x =</span> ct,</span>
<span id="cb78-15"><a href="#cb78-15"></a>  <span class="dt">plot =</span> <span class="st">"inference for estimated coefficients"</span>,</span>
<span id="cb78-16"><a href="#cb78-16"></a>  <span class="dt">conf.level =</span> <span class="fl">0.99</span></span>
<span id="cb78-17"><a href="#cb78-17"></a>)</span>
<span id="cb78-18"><a href="#cb78-18"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/coeftest-1.png" width="384"></p>
</div>
<div id="robust-regression-using-an-m-estimator-rlm" class="section level2">
<h2 class="hasAnchor">
<a href="#robust-regression-using-an-m-estimator-rlm" class="anchor"></a>robust regression using an M estimator (<code>rlm</code>)</h2>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb79-2"><a href="#cb79-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb79-3"><a href="#cb79-3"></a></span>
<span id="cb79-4"><a href="#cb79-4"></a><span class="co"># model</span></span>
<span id="cb79-5"><a href="#cb79-5"></a>mod &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/MASS/man/rlm.html">rlm</a></span>(<span class="dt">formula =</span> mpg <span class="op">~</span><span class="st"> </span>am <span class="op">*</span><span class="st"> </span>cyl, <span class="dt">data =</span> mtcars)</span>
<span id="cb79-6"><a href="#cb79-6"></a></span>
<span id="cb79-7"><a href="#cb79-7"></a><span class="co"># plot</span></span>
<span id="cb79-8"><a href="#cb79-8"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb79-9"><a href="#cb79-9"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb79-10"><a href="#cb79-10"></a>  <span class="dt">point.color =</span> <span class="st">"red"</span>,</span>
<span id="cb79-11"><a href="#cb79-11"></a>  <span class="dt">point.shape =</span> <span class="dv">15</span>,</span>
<span id="cb79-12"><a href="#cb79-12"></a>  <span class="dt">vline.args =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">"#CC79A7"</span>, <span class="dt">linetype =</span> <span class="st">"dotdash"</span>),</span>
<span id="cb79-13"><a href="#cb79-13"></a>  <span class="dt">stats.label.color =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"darkgreen"</span>),</span>
<span id="cb79-14"><a href="#cb79-14"></a>  <span class="dt">title =</span> <span class="st">"robust regression using an M estimator"</span>,</span>
<span id="cb79-15"><a href="#cb79-15"></a>  <span class="dt">ggtheme =</span> ggthemes<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ggthemes/man/theme_stata.html">theme_stata</a></span>(),</span>
<span id="cb79-16"><a href="#cb79-16"></a>  <span class="dt">ggstatsplot.layer =</span> <span class="ot">FALSE</span></span>
<span id="cb79-17"><a href="#cb79-17"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/rlm-1.png" width="480"></p>
</div>
<div id="quantile-regression-rq" class="section level2">
<h2 class="hasAnchor">
<a href="#quantile-regression-rq" class="anchor"></a>quantile regression (<code>rq</code>)</h2>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="co"># for reproducibility</span></span>
<span id="cb80-2"><a href="#cb80-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb80-3"><a href="#cb80-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(quantreg)</span>
<span id="cb80-4"><a href="#cb80-4"></a></span>
<span id="cb80-5"><a href="#cb80-5"></a><span class="co"># loading dataframe needed for the analyses below</span></span>
<span id="cb80-6"><a href="#cb80-6"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(stackloss)</span>
<span id="cb80-7"><a href="#cb80-7"></a></span>
<span id="cb80-8"><a href="#cb80-8"></a><span class="co"># plot</span></span>
<span id="cb80-9"><a href="#cb80-9"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb80-10"><a href="#cb80-10"></a>  <span class="dt">x =</span> quantreg<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/quantreg/man/rq.html">rq</a></span>(</span>
<span id="cb80-11"><a href="#cb80-11"></a>    <span class="dt">formula =</span> stack.loss <span class="op">~</span><span class="st"> </span>stack.x,</span>
<span id="cb80-12"><a href="#cb80-12"></a>    <span class="dt">data =</span> stackloss,</span>
<span id="cb80-13"><a href="#cb80-13"></a>    <span class="dt">method =</span> <span class="st">"br"</span></span>
<span id="cb80-14"><a href="#cb80-14"></a>  ),</span>
<span id="cb80-15"><a href="#cb80-15"></a>  <span class="dt">se.type =</span> <span class="st">"iid"</span>,</span>
<span id="cb80-16"><a href="#cb80-16"></a>  <span class="dt">title =</span> <span class="st">"quantile regression"</span></span>
<span id="cb80-17"><a href="#cb80-17"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/rq-1.png" width="576"></p>
</div>
<div id="nonlinear-quantile-regression-estimates-nlrq" class="section level2">
<h2 class="hasAnchor">
<a href="#nonlinear-quantile-regression-estimates-nlrq" class="anchor"></a>nonlinear quantile regression estimates (<code>nlrq</code>)</h2>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(quantreg)</span>
<span id="cb81-2"><a href="#cb81-2"></a></span>
<span id="cb81-3"><a href="#cb81-3"></a><span class="co"># preparing data</span></span>
<span id="cb81-4"><a href="#cb81-4"></a>Dat &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb81-5"><a href="#cb81-5"></a>Dat<span class="op">$</span>x &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">25</span>, <span class="dv">20</span>)</span>
<span id="cb81-6"><a href="#cb81-6"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb81-7"><a href="#cb81-7"></a>Dat<span class="op">$</span>y &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/SSlogis.html">SSlogis</a></span>(Dat<span class="op">$</span>x, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">2</span>) <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dv">500</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)</span>
<span id="cb81-8"><a href="#cb81-8"></a></span>
<span id="cb81-9"><a href="#cb81-9"></a><span class="co"># then fit the median using nlrq</span></span>
<span id="cb81-10"><a href="#cb81-10"></a>Dat.nlrq &lt;-</span>
<span id="cb81-11"><a href="#cb81-11"></a><span class="st">  </span>quantreg<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/quantreg/man/nlrq.html">nlrq</a></span>(</span>
<span id="cb81-12"><a href="#cb81-12"></a>    <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/SSlogis.html">SSlogis</a></span>(x, Asym, mid, scal),</span>
<span id="cb81-13"><a href="#cb81-13"></a>    <span class="dt">data =</span> Dat,</span>
<span id="cb81-14"><a href="#cb81-14"></a>    <span class="dt">tau =</span> <span class="fl">0.5</span>,</span>
<span id="cb81-15"><a href="#cb81-15"></a>    <span class="dt">trace =</span> <span class="ot">FALSE</span></span>
<span id="cb81-16"><a href="#cb81-16"></a>  )</span>
<span id="cb81-17"><a href="#cb81-17"></a></span>
<span id="cb81-18"><a href="#cb81-18"></a><span class="co"># plot</span></span>
<span id="cb81-19"><a href="#cb81-19"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb81-20"><a href="#cb81-20"></a>  <span class="dt">x =</span> Dat.nlrq,</span>
<span id="cb81-21"><a href="#cb81-21"></a>  <span class="dt">title =</span> <span class="st">"non-linear quantile regression"</span></span>
<span id="cb81-22"><a href="#cb81-22"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/nlrq-1.png" width="480"></p>
</div>
<div id="additive-quantile-regression-rqss" class="section level2">
<h2 class="hasAnchor">
<a href="#additive-quantile-regression-rqss" class="anchor"></a>additive quantile regression (<code>rqss</code>)</h2>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="co"># setup</span></span>
<span id="cb82-2"><a href="#cb82-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb82-3"><a href="#cb82-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(quantreg)</span>
<span id="cb82-4"><a href="#cb82-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(CobarOre)</span>
<span id="cb82-5"><a href="#cb82-5"></a></span>
<span id="cb82-6"><a href="#cb82-6"></a><span class="co"># model</span></span>
<span id="cb82-7"><a href="#cb82-7"></a>fCO &lt;-<span class="st"> </span><span class="kw">rqss</span>(<span class="dt">formula =</span> z <span class="op">~</span><span class="st"> </span><span class="kw">qss</span>(<span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(x, y), <span class="dt">lambda =</span> <span class="fl">.08</span>), <span class="dt">data =</span> CobarOre)</span>
<span id="cb82-8"><a href="#cb82-8"></a></span>
<span id="cb82-9"><a href="#cb82-9"></a><span class="co"># model info</span></span>
<span id="cb82-10"><a href="#cb82-10"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb82-11"><a href="#cb82-11"></a>  <span class="dt">x =</span> fCO,</span>
<span id="cb82-12"><a href="#cb82-12"></a>  <span class="dt">title =</span> <span class="st">"Additive Quantile Regression"</span>,</span>
<span id="cb82-13"><a href="#cb82-13"></a>  <span class="dt">exclude.intercept =</span> <span class="ot">FALSE</span></span>
<span id="cb82-14"><a href="#cb82-14"></a>)</span>
<span id="cb82-15"><a href="#cb82-15"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/rqss-1.png" width="384"></p>
</div>
<div id="instrumental-variable-regression-ivreg" class="section level2">
<h2 class="hasAnchor">
<a href="#instrumental-variable-regression-ivreg" class="anchor"></a>instrumental-variable regression (<code>ivreg</code>)</h2>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a><span class="co"># setup</span></span>
<span id="cb83-2"><a href="#cb83-2"></a><span class="kw"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(AER))</span>
<span id="cb83-3"><a href="#cb83-3"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb83-4"><a href="#cb83-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"CigarettesSW"</span>, <span class="dt">package =</span> <span class="st">"AER"</span>)</span>
<span id="cb83-5"><a href="#cb83-5"></a></span>
<span id="cb83-6"><a href="#cb83-6"></a><span class="co"># model</span></span>
<span id="cb83-7"><a href="#cb83-7"></a>ivr &lt;-<span class="st"> </span>AER<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/AER/man/ivreg.html">ivreg</a></span>(</span>
<span id="cb83-8"><a href="#cb83-8"></a>  <span class="dt">formula =</span> <span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(packs) <span class="op">~</span><span class="st"> </span>income <span class="op">|</span><span class="st"> </span>population,</span>
<span id="cb83-9"><a href="#cb83-9"></a>  <span class="dt">data =</span> CigarettesSW,</span>
<span id="cb83-10"><a href="#cb83-10"></a>  <span class="dt">subset =</span> year <span class="op">==</span><span class="st"> "1995"</span></span>
<span id="cb83-11"><a href="#cb83-11"></a>)</span>
<span id="cb83-12"><a href="#cb83-12"></a></span>
<span id="cb83-13"><a href="#cb83-13"></a><span class="co"># plot</span></span>
<span id="cb83-14"><a href="#cb83-14"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb83-15"><a href="#cb83-15"></a>  <span class="dt">x =</span> ivr,</span>
<span id="cb83-16"><a href="#cb83-16"></a>  <span class="dt">title =</span> <span class="st">"instrumental-variable regression"</span></span>
<span id="cb83-17"><a href="#cb83-17"></a>)</span>
<span id="cb83-18"><a href="#cb83-18"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/ivreg-1.png" width="480"></p>
</div>
<div id="causal-mediation-analysis-mediate" class="section level2">
<h2 class="hasAnchor">
<a href="#causal-mediation-analysis-mediate" class="anchor"></a>causal mediation analysis (<code>mediate</code>)</h2>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="co"># setup</span></span>
<span id="cb84-2"><a href="#cb84-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb84-3"><a href="#cb84-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(mediation)</span>
<span id="cb84-4"><a href="#cb84-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(jobs)</span>
<span id="cb84-5"><a href="#cb84-5"></a></span>
<span id="cb84-6"><a href="#cb84-6"></a><span class="co"># base models</span></span>
<span id="cb84-7"><a href="#cb84-7"></a>b &lt;-</span>
<span id="cb84-8"><a href="#cb84-8"></a><span class="st">  </span>stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(</span>
<span id="cb84-9"><a href="#cb84-9"></a>    <span class="dt">formula =</span> job_seek <span class="op">~</span><span class="st"> </span>treat <span class="op">+</span><span class="st"> </span>econ_hard <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>age,</span>
<span id="cb84-10"><a href="#cb84-10"></a>    <span class="dt">data =</span> jobs</span>
<span id="cb84-11"><a href="#cb84-11"></a>  )</span>
<span id="cb84-12"><a href="#cb84-12"></a>c &lt;-</span>
<span id="cb84-13"><a href="#cb84-13"></a><span class="st">  </span>stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(</span>
<span id="cb84-14"><a href="#cb84-14"></a>    <span class="dt">formula =</span> depress2 <span class="op">~</span><span class="st"> </span>treat <span class="op">+</span><span class="st"> </span>job_seek <span class="op">+</span><span class="st"> </span>econ_hard <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>age,</span>
<span id="cb84-15"><a href="#cb84-15"></a>    <span class="dt">data =</span> jobs</span>
<span id="cb84-16"><a href="#cb84-16"></a>  )</span>
<span id="cb84-17"><a href="#cb84-17"></a></span>
<span id="cb84-18"><a href="#cb84-18"></a><span class="co"># mediation model</span></span>
<span id="cb84-19"><a href="#cb84-19"></a>mod &lt;-</span>
<span id="cb84-20"><a href="#cb84-20"></a><span class="st">  </span>mediation<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/mediation/man/mediate.html">mediate</a></span>(</span>
<span id="cb84-21"><a href="#cb84-21"></a>    <span class="dt">model.m =</span> b,</span>
<span id="cb84-22"><a href="#cb84-22"></a>    <span class="dt">model.y =</span> c,</span>
<span id="cb84-23"><a href="#cb84-23"></a>    <span class="dt">sims =</span> <span class="dv">50</span>,</span>
<span id="cb84-24"><a href="#cb84-24"></a>    <span class="dt">treat =</span> <span class="st">"treat"</span>,</span>
<span id="cb84-25"><a href="#cb84-25"></a>    <span class="dt">mediator =</span> <span class="st">"job_seek"</span></span>
<span id="cb84-26"><a href="#cb84-26"></a>  )</span>
<span id="cb84-27"><a href="#cb84-27"></a></span>
<span id="cb84-28"><a href="#cb84-28"></a><span class="co"># plot</span></span>
<span id="cb84-29"><a href="#cb84-29"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb84-30"><a href="#cb84-30"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb84-31"><a href="#cb84-31"></a>  <span class="dt">title =</span> <span class="st">"causal mediation analysis"</span></span>
<span id="cb84-32"><a href="#cb84-32"></a>)</span>
<span id="cb84-33"><a href="#cb84-33"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span>
<span id="cb84-34"><a href="#cb84-34"></a><span class="co">#&gt; Note: No p-values and/or statistic available for the model object;</span></span>
<span id="cb84-35"><a href="#cb84-35"></a><span class="co">#&gt; skipping labels with statistical details.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/mediate-1.png" width="480"></p>
</div>
<div id="model-ii-regression-lmodel2" class="section level2">
<h2 class="hasAnchor">
<a href="#model-ii-regression-lmodel2" class="anchor"></a>Model II regression (<code>lmodel2</code>)</h2>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="co"># setup</span></span>
<span id="cb85-2"><a href="#cb85-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb85-3"><a href="#cb85-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(lmodel2)</span>
<span id="cb85-4"><a href="#cb85-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(mod2ex2)</span>
<span id="cb85-5"><a href="#cb85-5"></a></span>
<span id="cb85-6"><a href="#cb85-6"></a><span class="co"># model</span></span>
<span id="cb85-7"><a href="#cb85-7"></a>Ex2.res &lt;-</span>
<span id="cb85-8"><a href="#cb85-8"></a><span class="st">  </span>lmodel2<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/lmodel2/man/lmodel2.html">lmodel2</a></span>(</span>
<span id="cb85-9"><a href="#cb85-9"></a>    <span class="dt">formula =</span> Prey <span class="op">~</span><span class="st"> </span>Predators,</span>
<span id="cb85-10"><a href="#cb85-10"></a>    <span class="dt">data =</span> mod2ex2,</span>
<span id="cb85-11"><a href="#cb85-11"></a>    <span class="dt">range.y =</span> <span class="st">"relative"</span>,</span>
<span id="cb85-12"><a href="#cb85-12"></a>    <span class="dt">range.x =</span> <span class="st">"relative"</span>,</span>
<span id="cb85-13"><a href="#cb85-13"></a>    <span class="dt">nperm =</span> <span class="dv">99</span></span>
<span id="cb85-14"><a href="#cb85-14"></a>  )</span>
<span id="cb85-15"><a href="#cb85-15"></a></span>
<span id="cb85-16"><a href="#cb85-16"></a><span class="co"># plot</span></span>
<span id="cb85-17"><a href="#cb85-17"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb85-18"><a href="#cb85-18"></a>  <span class="dt">x =</span> Ex2.res,</span>
<span id="cb85-19"><a href="#cb85-19"></a>  <span class="dt">exclude.intercept =</span> <span class="ot">FALSE</span>,</span>
<span id="cb85-20"><a href="#cb85-20"></a>  <span class="dt">title =</span> <span class="st">"Model II regression"</span></span>
<span id="cb85-21"><a href="#cb85-21"></a>)</span>
<span id="cb85-22"><a href="#cb85-22"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span>
<span id="cb85-23"><a href="#cb85-23"></a><span class="co">#&gt; Note: No p-values and/or statistic available for the model object;</span></span>
<span id="cb85-24"><a href="#cb85-24"></a><span class="co">#&gt; skipping labels with statistical details.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/lmodel2-1.png" width="576"></p>
</div>
<div id="generalized-additive-models-for-location-scale-and-shape-gamlss" class="section level2">
<h2 class="hasAnchor">
<a href="#generalized-additive-models-for-location-scale-and-shape-gamlss" class="anchor"></a>generalized additive models for location scale and shape (<code>gamlss</code>)</h2>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a><span class="co"># setup</span></span>
<span id="cb86-2"><a href="#cb86-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb86-3"><a href="#cb86-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(gamlss)</span>
<span id="cb86-4"><a href="#cb86-4"></a></span>
<span id="cb86-5"><a href="#cb86-5"></a><span class="co"># model</span></span>
<span id="cb86-6"><a href="#cb86-6"></a>g &lt;-</span>
<span id="cb86-7"><a href="#cb86-7"></a><span class="st">  </span>gamlss<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/gamlss/man/gamlss.html">gamlss</a></span>(</span>
<span id="cb86-8"><a href="#cb86-8"></a>    <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="kw">pb</span>(x),</span>
<span id="cb86-9"><a href="#cb86-9"></a>    <span class="dt">sigma.fo =</span> <span class="op">~</span><span class="st"> </span><span class="kw">pb</span>(x),</span>
<span id="cb86-10"><a href="#cb86-10"></a>    <span class="dt">family =</span> BCT,</span>
<span id="cb86-11"><a href="#cb86-11"></a>    <span class="dt">data =</span> abdom,</span>
<span id="cb86-12"><a href="#cb86-12"></a>    <span class="dt">method =</span> <span class="kw">mixed</span>(<span class="dv">1</span>, <span class="dv">20</span>)</span>
<span id="cb86-13"><a href="#cb86-13"></a>  )</span>
<span id="cb86-14"><a href="#cb86-14"></a><span class="co">#&gt; GAMLSS-RS iteration 1: Global Deviance = 4771.925 </span></span>
<span id="cb86-15"><a href="#cb86-15"></a><span class="co">#&gt; GAMLSS-CG iteration 1: Global Deviance = 4771.013 </span></span>
<span id="cb86-16"><a href="#cb86-16"></a><span class="co">#&gt; GAMLSS-CG iteration 2: Global Deviance = 4770.994 </span></span>
<span id="cb86-17"><a href="#cb86-17"></a><span class="co">#&gt; GAMLSS-CG iteration 3: Global Deviance = 4770.994</span></span>
<span id="cb86-18"><a href="#cb86-18"></a></span>
<span id="cb86-19"><a href="#cb86-19"></a><span class="co"># plot</span></span>
<span id="cb86-20"><a href="#cb86-20"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb86-21"><a href="#cb86-21"></a>  <span class="dt">x =</span> g,</span>
<span id="cb86-22"><a href="#cb86-22"></a>  <span class="dt">title =</span> <span class="st">"generalized additive models </span><span class="ch">\n</span><span class="st">for location scale and shape"</span></span>
<span id="cb86-23"><a href="#cb86-23"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/gamlss-1.png" width="480"></p>
</div>
<div id="generalized-method-of-moment-estimation-gmm" class="section level2">
<h2 class="hasAnchor">
<a href="#generalized-method-of-moment-estimation-gmm" class="anchor"></a>generalized method of moment estimation (<code>gmm</code>)</h2>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a><span class="co"># setup</span></span>
<span id="cb87-2"><a href="#cb87-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb87-3"><a href="#cb87-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(gmm)</span>
<span id="cb87-4"><a href="#cb87-4"></a></span>
<span id="cb87-5"><a href="#cb87-5"></a><span class="co"># examples come from the "gmm" package</span></span>
<span id="cb87-6"><a href="#cb87-6"></a><span class="co">## CAPM test with GMM</span></span>
<span id="cb87-7"><a href="#cb87-7"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(Finance)</span>
<span id="cb87-8"><a href="#cb87-8"></a>r &lt;-<span class="st"> </span>Finance[<span class="dv">1</span><span class="op">:</span><span class="dv">300</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</span>
<span id="cb87-9"><a href="#cb87-9"></a>rm &lt;-<span class="st"> </span>Finance[<span class="dv">1</span><span class="op">:</span><span class="dv">300</span>, <span class="st">"rm"</span>]</span>
<span id="cb87-10"><a href="#cb87-10"></a>rf &lt;-<span class="st"> </span>Finance[<span class="dv">1</span><span class="op">:</span><span class="dv">300</span>, <span class="st">"rf"</span>]</span>
<span id="cb87-11"><a href="#cb87-11"></a></span>
<span id="cb87-12"><a href="#cb87-12"></a>z &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(r <span class="op">-</span><span class="st"> </span>rf)</span>
<span id="cb87-13"><a href="#cb87-13"></a>t &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(z)</span>
<span id="cb87-14"><a href="#cb87-14"></a>zm &lt;-<span class="st"> </span>rm <span class="op">-</span><span class="st"> </span>rf</span>
<span id="cb87-15"><a href="#cb87-15"></a>h &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(zm, t, <span class="dv">1</span>)</span>
<span id="cb87-16"><a href="#cb87-16"></a>res &lt;-<span class="st"> </span>gmm<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/gmm/man/gmm.html">gmm</a></span>(z <span class="op">~</span><span class="st"> </span>zm, <span class="dt">x =</span> h)</span>
<span id="cb87-17"><a href="#cb87-17"></a></span>
<span id="cb87-18"><a href="#cb87-18"></a><span class="co"># plot</span></span>
<span id="cb87-19"><a href="#cb87-19"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb87-20"><a href="#cb87-20"></a>  <span class="dt">x =</span> res,</span>
<span id="cb87-21"><a href="#cb87-21"></a>  <span class="dt">package =</span> <span class="st">"palettetown"</span>,</span>
<span id="cb87-22"><a href="#cb87-22"></a>  <span class="dt">palette =</span> <span class="st">"victreebel"</span>,</span>
<span id="cb87-23"><a href="#cb87-23"></a>  <span class="dt">title =</span> <span class="st">"generalized method of moment estimation"</span></span>
<span id="cb87-24"><a href="#cb87-24"></a>)</span>
<span id="cb87-25"><a href="#cb87-25"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/gmm-1.png" width="480"></p>
</div>
<div id="fit-a-glm-with-lasso-or-elasticnet-regularization-glmnet" class="section level2">
<h2 class="hasAnchor">
<a href="#fit-a-glm-with-lasso-or-elasticnet-regularization-glmnet" class="anchor"></a>fit a GLM with lasso or elasticnet regularization (<code>glmnet</code>)</h2>
<p>Although these models are not directly supported in <code>ggcoefstats</code> because of the sheer number of terms that are typically present. But this function can still be used to selectively show few of the terms of interest:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a><span class="co"># setup</span></span>
<span id="cb88-2"><a href="#cb88-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(glmnet)</span>
<span id="cb88-3"><a href="#cb88-3"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">2014</span>)</span>
<span id="cb88-4"><a href="#cb88-4"></a></span>
<span id="cb88-5"><a href="#cb88-5"></a><span class="co"># creating a dataframe</span></span>
<span id="cb88-6"><a href="#cb88-6"></a>x &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dv">100</span> <span class="op">*</span><span class="st"> </span><span class="dv">20</span>), <span class="dv">100</span>, <span class="dv">20</span>)</span>
<span id="cb88-7"><a href="#cb88-7"></a>y &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dv">100</span>)</span>
<span id="cb88-8"><a href="#cb88-8"></a>fit1 &lt;-<span class="st"> </span>glmnet<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/glmnet/man/glmnet.html">glmnet</a></span>(x, y)</span>
<span id="cb88-9"><a href="#cb88-9"></a>(df &lt;-<span class="st"> </span>broom<span class="op">::</span><span class="kw"><a href="http://broom.tidyverse.org/reference/reexports.html">tidy</a></span>(fit1))</span>
<span id="cb88-10"><a href="#cb88-10"></a><span class="co">#&gt; # A tibble: 1,086 x 5</span></span>
<span id="cb88-11"><a href="#cb88-11"></a><span class="co">#&gt;    term         step estimate lambda dev.ratio</span></span>
<span id="cb88-12"><a href="#cb88-12"></a><span class="co">#&gt;    &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb88-13"><a href="#cb88-13"></a><span class="co">#&gt;  1 (Intercept)     1 -0.207    0.152   0      </span></span>
<span id="cb88-14"><a href="#cb88-14"></a><span class="co">#&gt;  2 (Intercept)     2 -0.208    0.139   0.00464</span></span>
<span id="cb88-15"><a href="#cb88-15"></a><span class="co">#&gt;  3 V16             2 -0.00292  0.139   0.00464</span></span>
<span id="cb88-16"><a href="#cb88-16"></a><span class="co">#&gt;  4 V17             2 -0.0148   0.139   0.00464</span></span>
<span id="cb88-17"><a href="#cb88-17"></a><span class="co">#&gt;  5 (Intercept)     3 -0.209    0.127   0.0111 </span></span>
<span id="cb88-18"><a href="#cb88-18"></a><span class="co">#&gt;  6 V16             3 -0.0150   0.127   0.0111 </span></span>
<span id="cb88-19"><a href="#cb88-19"></a><span class="co">#&gt;  7 V17             3 -0.0286   0.127   0.0111 </span></span>
<span id="cb88-20"><a href="#cb88-20"></a><span class="co">#&gt;  8 (Intercept)     4 -0.210    0.115   0.0165 </span></span>
<span id="cb88-21"><a href="#cb88-21"></a><span class="co">#&gt;  9 V16             4 -0.0260   0.115   0.0165 </span></span>
<span id="cb88-22"><a href="#cb88-22"></a><span class="co">#&gt; 10 V17             4 -0.0412   0.115   0.0165 </span></span>
<span id="cb88-23"><a href="#cb88-23"></a><span class="co">#&gt; # ... with 1,076 more rows</span></span>
<span id="cb88-24"><a href="#cb88-24"></a></span>
<span id="cb88-25"><a href="#cb88-25"></a><span class="co"># displaying only a certain step</span></span>
<span id="cb88-26"><a href="#cb88-26"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(<span class="dt">x =</span> dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(df, step <span class="op">==</span><span class="st"> </span><span class="dv">4</span>))</span>
<span id="cb88-27"><a href="#cb88-27"></a><span class="co">#&gt; Note: For the object of classtbl_df, the argument `statistic` must be specified ('t', 'z', or 'f').</span></span>
<span id="cb88-28"><a href="#cb88-28"></a><span class="co">#&gt; Statistical labels will therefore be skipped.</span></span>
<span id="cb88-29"><a href="#cb88-29"></a><span class="co">#&gt; Note: No p-values and/or statistic available for the model object;</span></span>
<span id="cb88-30"><a href="#cb88-30"></a><span class="co">#&gt; skipping labels with statistical details.</span></span>
<span id="cb88-31"><a href="#cb88-31"></a><span class="co">#&gt; Note: No confidence intervals available for regression coefficientsobject, so skipping whiskers in the plot.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/glmnet-1.png" width="384"></p>
</div>
<div id="joint-model-to-time-to-event-data-and-multivariate-longitudinal-data-mjoint" class="section level2">
<h2 class="hasAnchor">
<a href="#joint-model-to-time-to-event-data-and-multivariate-longitudinal-data-mjoint" class="anchor"></a>joint model to time-to-event data and multivariate longitudinal data (<code>mjoint</code>)</h2>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a><span class="co"># setup</span></span>
<span id="cb89-2"><a href="#cb89-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb89-3"><a href="#cb89-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(joineRML)</span>
<span id="cb89-4"><a href="#cb89-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(heart.valve)</span>
<span id="cb89-5"><a href="#cb89-5"></a></span>
<span id="cb89-6"><a href="#cb89-6"></a><span class="co"># data</span></span>
<span id="cb89-7"><a href="#cb89-7"></a>hvd &lt;-<span class="st"> </span>heart.valve[<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(heart.valve<span class="op">$</span>log.grad) <span class="op">&amp;</span></span>
<span id="cb89-8"><a href="#cb89-8"></a><span class="st">  </span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(heart.valve<span class="op">$</span>log.lvmi) <span class="op">&amp;</span></span>
<span id="cb89-9"><a href="#cb89-9"></a><span class="st">  </span>heart.valve<span class="op">$</span>num <span class="op">&lt;=</span><span class="st"> </span><span class="dv">50</span>, ]</span>
<span id="cb89-10"><a href="#cb89-10"></a></span>
<span id="cb89-11"><a href="#cb89-11"></a><span class="co"># model</span></span>
<span id="cb89-12"><a href="#cb89-12"></a>fit &lt;-<span class="st"> </span>joineRML<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/joineRML/man/mjoint.html">mjoint</a></span>(</span>
<span id="cb89-13"><a href="#cb89-13"></a>  <span class="dt">formLongFixed =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</span>
<span id="cb89-14"><a href="#cb89-14"></a>    <span class="st">"grad"</span> =<span class="st"> </span>log.grad <span class="op">~</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>hs,</span>
<span id="cb89-15"><a href="#cb89-15"></a>    <span class="st">"lvmi"</span> =<span class="st"> </span>log.lvmi <span class="op">~</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span>sex</span>
<span id="cb89-16"><a href="#cb89-16"></a>  ),</span>
<span id="cb89-17"><a href="#cb89-17"></a>  <span class="dt">formLongRandom =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</span>
<span id="cb89-18"><a href="#cb89-18"></a>    <span class="st">"grad"</span> =<span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>num,</span>
<span id="cb89-19"><a href="#cb89-19"></a>    <span class="st">"lvmi"</span> =<span class="st"> </span><span class="er">~</span><span class="st"> </span>time <span class="op">|</span><span class="st"> </span>num</span>
<span id="cb89-20"><a href="#cb89-20"></a>  ),</span>
<span id="cb89-21"><a href="#cb89-21"></a>  <span class="dt">formSurv =</span> <span class="kw">Surv</span>(fuyrs, status) <span class="op">~</span><span class="st"> </span>age,</span>
<span id="cb89-22"><a href="#cb89-22"></a>  <span class="dt">data =</span> hvd,</span>
<span id="cb89-23"><a href="#cb89-23"></a>  <span class="dt">inits =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"gamma"</span> =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.11</span>, <span class="fl">1.51</span>, <span class="fl">0.80</span>)),</span>
<span id="cb89-24"><a href="#cb89-24"></a>  <span class="dt">timeVar =</span> <span class="st">"time"</span></span>
<span id="cb89-25"><a href="#cb89-25"></a>)</span>
<span id="cb89-26"><a href="#cb89-26"></a></span>
<span id="cb89-27"><a href="#cb89-27"></a><span class="co"># extract the survival fixed effects and plot them</span></span>
<span id="cb89-28"><a href="#cb89-28"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb89-29"><a href="#cb89-29"></a>  <span class="dt">x =</span> fit,</span>
<span id="cb89-30"><a href="#cb89-30"></a>  <span class="dt">conf.level =</span> <span class="fl">0.99</span>,</span>
<span id="cb89-31"><a href="#cb89-31"></a>  <span class="dt">exclude.intercept =</span> <span class="ot">FALSE</span>,</span>
<span id="cb89-32"><a href="#cb89-32"></a>  <span class="dt">component =</span> <span class="st">"longitudinal"</span>,</span>
<span id="cb89-33"><a href="#cb89-33"></a>  <span class="dt">package =</span> <span class="st">"yarrr"</span>,</span>
<span id="cb89-34"><a href="#cb89-34"></a>  <span class="dt">palette =</span> <span class="st">"basel"</span>,</span>
<span id="cb89-35"><a href="#cb89-35"></a>  <span class="dt">title =</span> <span class="st">"joint model to time-to-event data </span><span class="ch">\n</span><span class="st">and multivariate longitudinal data"</span></span>
<span id="cb89-36"><a href="#cb89-36"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/mjoint-1.png" width="768"></p>
</div>
<div id="exponential-family-random-graph-models-ergm" class="section level2">
<h2 class="hasAnchor">
<a href="#exponential-family-random-graph-models-ergm" class="anchor"></a>exponential-family random graph models (<code>ergm</code>)</h2>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a><span class="co"># load the Florentine marriage network data</span></span>
<span id="cb90-2"><a href="#cb90-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb90-3"><a href="#cb90-3"></a><span class="kw"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ergm))</span>
<span id="cb90-4"><a href="#cb90-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(florentine)</span>
<span id="cb90-5"><a href="#cb90-5"></a></span>
<span id="cb90-6"><a href="#cb90-6"></a><span class="co"># fit a model where the propensity to form ties between</span></span>
<span id="cb90-7"><a href="#cb90-7"></a><span class="co"># families depends on the absolute difference in wealth</span></span>
<span id="cb90-8"><a href="#cb90-8"></a>gest &lt;-<span class="st"> </span><span class="kw">ergm</span>(flomarriage <span class="op">~</span><span class="st"> </span>edges <span class="op">+</span><span class="st"> </span><span class="kw">absdiff</span>(<span class="st">"wealth"</span>))</span>
<span id="cb90-9"><a href="#cb90-9"></a></span>
<span id="cb90-10"><a href="#cb90-10"></a><span class="co"># plot</span></span>
<span id="cb90-11"><a href="#cb90-11"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb90-12"><a href="#cb90-12"></a>  <span class="dt">x =</span> gest,</span>
<span id="cb90-13"><a href="#cb90-13"></a>  <span class="dt">conf.level =</span> <span class="fl">0.99</span>,</span>
<span id="cb90-14"><a href="#cb90-14"></a>  <span class="dt">title =</span> <span class="st">"exponential-family random graph models"</span></span>
<span id="cb90-15"><a href="#cb90-15"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/ergm-1.png" width="480"></p>
</div>
<div id="tergm-by-bootstrapped-pseudolikelihood-or-mcmc-mle-btergm" class="section level2">
<h2 class="hasAnchor">
<a href="#tergm-by-bootstrapped-pseudolikelihood-or-mcmc-mle-btergm" class="anchor"></a>TERGM by bootstrapped pseudolikelihood or MCMC MLE (<code>btergm</code>)</h2>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a><span class="co"># setup</span></span>
<span id="cb91-2"><a href="#cb91-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(network)</span>
<span id="cb91-3"><a href="#cb91-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(btergm)</span>
<span id="cb91-4"><a href="#cb91-4"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb91-5"><a href="#cb91-5"></a></span>
<span id="cb91-6"><a href="#cb91-6"></a><span class="co"># create 10 random networks with 10 actors</span></span>
<span id="cb91-7"><a href="#cb91-7"></a>networks &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>()</span>
<span id="cb91-8"><a href="#cb91-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>) {</span>
<span id="cb91-9"><a href="#cb91-9"></a>  mat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(<span class="dv">100</span>, <span class="dv">1</span>, <span class="fl">.25</span>), <span class="dt">nrow =</span> <span class="dv">10</span>, <span class="dt">ncol =</span> <span class="dv">10</span>)</span>
<span id="cb91-10"><a href="#cb91-10"></a>  <span class="kw"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(mat) &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co"># loops are excluded</span></span>
<span id="cb91-11"><a href="#cb91-11"></a>  nw &lt;-<span class="st"> </span><span class="kw">network</span>(mat) <span class="co"># create network object</span></span>
<span id="cb91-12"><a href="#cb91-12"></a>  networks[[i]] &lt;-<span class="st"> </span>nw <span class="co"># add network to the list</span></span>
<span id="cb91-13"><a href="#cb91-13"></a>}</span>
<span id="cb91-14"><a href="#cb91-14"></a></span>
<span id="cb91-15"><a href="#cb91-15"></a><span class="co"># create 10 matrices as covariate</span></span>
<span id="cb91-16"><a href="#cb91-16"></a>covariates &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>()</span>
<span id="cb91-17"><a href="#cb91-17"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>) {</span>
<span id="cb91-18"><a href="#cb91-18"></a>  mat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dv">100</span>), <span class="dt">nrow =</span> <span class="dv">10</span>, <span class="dt">ncol =</span> <span class="dv">10</span>)</span>
<span id="cb91-19"><a href="#cb91-19"></a>  covariates[[i]] &lt;-<span class="st"> </span>mat <span class="co"># add matrix to the list</span></span>
<span id="cb91-20"><a href="#cb91-20"></a>}</span>
<span id="cb91-21"><a href="#cb91-21"></a></span>
<span id="cb91-22"><a href="#cb91-22"></a><span class="co"># model</span></span>
<span id="cb91-23"><a href="#cb91-23"></a>fit &lt;-</span>
<span id="cb91-24"><a href="#cb91-24"></a><span class="st">  </span>btergm<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/btergm/man/btergm.html">btergm</a></span>(</span>
<span id="cb91-25"><a href="#cb91-25"></a>    <span class="dt">formula =</span> networks <span class="op">~</span><span class="st"> </span>edges <span class="op">+</span><span class="st"> </span><span class="kw">istar</span>(<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">edgecov</span>(covariates),</span>
<span id="cb91-26"><a href="#cb91-26"></a>    <span class="dt">parallel =</span> <span class="st">"multicore"</span>,</span>
<span id="cb91-27"><a href="#cb91-27"></a>    <span class="dt">ncpus =</span> <span class="dv">4</span>,</span>
<span id="cb91-28"><a href="#cb91-28"></a>    <span class="dt">R =</span> <span class="dv">100</span>,</span>
<span id="cb91-29"><a href="#cb91-29"></a>    <span class="dt">verbose =</span> <span class="ot">FALSE</span></span>
<span id="cb91-30"><a href="#cb91-30"></a>  )</span>
<span id="cb91-31"><a href="#cb91-31"></a></span>
<span id="cb91-32"><a href="#cb91-32"></a><span class="co"># plot</span></span>
<span id="cb91-33"><a href="#cb91-33"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb91-34"><a href="#cb91-34"></a>  <span class="dt">x =</span> fit,</span>
<span id="cb91-35"><a href="#cb91-35"></a>  <span class="dt">title =</span> <span class="st">"Terms used in Exponential Family Random Graph Models"</span>,</span>
<span id="cb91-36"><a href="#cb91-36"></a>  <span class="dt">subtitle =</span> <span class="st">"by bootstrapped pseudolikelihood or MCMC MLE"</span></span>
<span id="cb91-37"><a href="#cb91-37"></a>)</span>
<span id="cb91-38"><a href="#cb91-38"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span>
<span id="cb91-39"><a href="#cb91-39"></a><span class="co">#&gt; </span></span>
<span id="cb91-40"><a href="#cb91-40"></a><span class="co">#&gt; Could not extract p-values from model object.</span></span>
<span id="cb91-41"><a href="#cb91-41"></a><span class="co">#&gt; Note: No p-values and/or statistic available for the model object;</span></span>
<span id="cb91-42"><a href="#cb91-42"></a><span class="co">#&gt; skipping labels with statistical details.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/btergm-1.png" width="576"></p>
</div>
<div id="generalized-autoregressive-conditional-heteroscedastic-garch" class="section level2">
<h2 class="hasAnchor">
<a href="#generalized-autoregressive-conditional-heteroscedastic-garch" class="anchor"></a>generalized autoregressive conditional heteroscedastic (<code>garch</code>)</h2>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a><span class="co"># setup</span></span>
<span id="cb92-2"><a href="#cb92-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb92-3"><a href="#cb92-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tseries)</span>
<span id="cb92-4"><a href="#cb92-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(EuStockMarkets)</span>
<span id="cb92-5"><a href="#cb92-5"></a>dax &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/diff.html">diff</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(EuStockMarkets))[, <span class="st">"DAX"</span>]</span>
<span id="cb92-6"><a href="#cb92-6"></a>dax.garch &lt;-<span class="st"> </span>tseries<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/tseries/man/garch.html">garch</a></span>(<span class="dt">x =</span> dax, <span class="dt">trace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb92-7"><a href="#cb92-7"></a></span>
<span id="cb92-8"><a href="#cb92-8"></a><span class="co"># plot</span></span>
<span id="cb92-9"><a href="#cb92-9"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb92-10"><a href="#cb92-10"></a>  <span class="dt">x =</span> dax.garch,</span>
<span id="cb92-11"><a href="#cb92-11"></a>  <span class="dt">title =</span> <span class="st">"generalized autoregressive </span><span class="ch">\n</span><span class="st">conditional heteroscedastic (GARCH)"</span></span>
<span id="cb92-12"><a href="#cb92-12"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/garch-1.png" width="480"></p>
</div>
<div id="maximum-likelihood-fitting-of-univariate-distributions-fitdistr" class="section level2">
<h2 class="hasAnchor">
<a href="#maximum-likelihood-fitting-of-univariate-distributions-fitdistr" class="anchor"></a>maximum-likelihood fitting of univariate distributions (<code>fitdistr</code>)</h2>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a><span class="co"># model</span></span>
<span id="cb93-2"><a href="#cb93-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb93-3"><a href="#cb93-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(MASS)</span>
<span id="cb93-4"><a href="#cb93-4"></a>x &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dv">100</span>, <span class="dv">5</span>, <span class="dv">2</span>)</span>
<span id="cb93-5"><a href="#cb93-5"></a>fit &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/MASS/man/fitdistr.html">fitdistr</a></span>(x, dnorm, <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">mean =</span> <span class="dv">3</span>, <span class="dt">sd =</span> <span class="dv">1</span>))</span>
<span id="cb93-6"><a href="#cb93-6"></a></span>
<span id="cb93-7"><a href="#cb93-7"></a><span class="co"># plot</span></span>
<span id="cb93-8"><a href="#cb93-8"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb93-9"><a href="#cb93-9"></a>  <span class="dt">x =</span> fit,</span>
<span id="cb93-10"><a href="#cb93-10"></a>  <span class="dt">title =</span> <span class="st">"maximum-likelihood fitting of </span><span class="ch">\n</span><span class="st">univariate distributions"</span>,</span>
<span id="cb93-11"><a href="#cb93-11"></a>  <span class="dt">ggtheme =</span> ggthemes<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ggthemes/man/theme_pander.html">theme_pander</a></span>()</span>
<span id="cb93-12"><a href="#cb93-12"></a>)</span>
<span id="cb93-13"><a href="#cb93-13"></a><span class="co">#&gt; </span></span>
<span id="cb93-14"><a href="#cb93-14"></a><span class="co">#&gt; Could not extract p-values from model object.</span></span>
<span id="cb93-15"><a href="#cb93-15"></a><span class="co">#&gt; Note: No p-values and/or statistic available for the model object;</span></span>
<span id="cb93-16"><a href="#cb93-16"></a><span class="co">#&gt; skipping labels with statistical details.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/fitdistr-1.png" width="384"></p>
</div>
<div id="maximum-likelihood-estimation-mle2" class="section level2">
<h2 class="hasAnchor">
<a href="#maximum-likelihood-estimation-mle2" class="anchor"></a>maximum likelihood estimation (<code>mle2</code>)</h2>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a><span class="co"># setup</span></span>
<span id="cb94-2"><a href="#cb94-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb94-3"><a href="#cb94-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(bbmle)</span>
<span id="cb94-4"><a href="#cb94-4"></a></span>
<span id="cb94-5"><a href="#cb94-5"></a><span class="co"># data</span></span>
<span id="cb94-6"><a href="#cb94-6"></a>x &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">10</span></span>
<span id="cb94-7"><a href="#cb94-7"></a>y &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">26</span>, <span class="dv">17</span>, <span class="dv">13</span>, <span class="dv">12</span>, <span class="dv">20</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">8</span>)</span>
<span id="cb94-8"><a href="#cb94-8"></a>d &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(x, y)</span>
<span id="cb94-9"><a href="#cb94-9"></a></span>
<span id="cb94-10"><a href="#cb94-10"></a><span class="co"># custom function</span></span>
<span id="cb94-11"><a href="#cb94-11"></a>LL &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">ymax =</span> <span class="dv">15</span>, <span class="dt">xhalf =</span> <span class="dv">6</span>) {</span>
<span id="cb94-12"><a href="#cb94-12"></a>  <span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span>(y, <span class="dt">lambda =</span> ymax <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x <span class="op">/</span><span class="st"> </span>xhalf), <span class="dt">log =</span> <span class="ot">TRUE</span>))</span>
<span id="cb94-13"><a href="#cb94-13"></a>}</span>
<span id="cb94-14"><a href="#cb94-14"></a></span>
<span id="cb94-15"><a href="#cb94-15"></a><span class="co"># use default parameters of LL</span></span>
<span id="cb94-16"><a href="#cb94-16"></a>fit &lt;-<span class="st"> </span>bbmle<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/bbmle/man/mle2.html">mle2</a></span>(LL, <span class="dt">fixed =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">xhalf =</span> <span class="dv">6</span>))</span>
<span id="cb94-17"><a href="#cb94-17"></a></span>
<span id="cb94-18"><a href="#cb94-18"></a><span class="co"># plot</span></span>
<span id="cb94-19"><a href="#cb94-19"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb94-20"><a href="#cb94-20"></a>  <span class="dt">x =</span> fit,</span>
<span id="cb94-21"><a href="#cb94-21"></a>  <span class="dt">title =</span> <span class="st">"maximum likelihood estimation"</span>,</span>
<span id="cb94-22"><a href="#cb94-22"></a>  <span class="dt">ggtheme =</span> ggthemes<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ggthemes/man/theme_excel_new.html">theme_excel_new</a></span>()</span>
<span id="cb94-23"><a href="#cb94-23"></a>)</span>
<span id="cb94-24"><a href="#cb94-24"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/mle2-1.png" width="384"></p>
</div>
<div id="summary-grid-from-emmeans-package-emmgrid" class="section level2">
<h2 class="hasAnchor">
<a href="#summary-grid-from-emmeans-package-emmgrid" class="anchor"></a>summary grid from <code>emmeans</code> package (<code>emmGrid</code>)</h2>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a><span class="co"># setup</span></span>
<span id="cb95-2"><a href="#cb95-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb95-3"><a href="#cb95-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(emmeans)</span>
<span id="cb95-4"><a href="#cb95-4"></a></span>
<span id="cb95-5"><a href="#cb95-5"></a><span class="co"># linear model for sales of oranges per day</span></span>
<span id="cb95-6"><a href="#cb95-6"></a>oranges_lm1 &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(</span>
<span id="cb95-7"><a href="#cb95-7"></a>  <span class="dt">formula =</span> sales1 <span class="op">~</span><span class="st"> </span>price1 <span class="op">+</span><span class="st"> </span>price2 <span class="op">+</span><span class="st"> </span>day <span class="op">+</span><span class="st"> </span>store,</span>
<span id="cb95-8"><a href="#cb95-8"></a>  <span class="dt">data =</span> oranges</span>
<span id="cb95-9"><a href="#cb95-9"></a>)</span>
<span id="cb95-10"><a href="#cb95-10"></a></span>
<span id="cb95-11"><a href="#cb95-11"></a><span class="co"># reference grid; see vignette("basics", package = "emmeans")</span></span>
<span id="cb95-12"><a href="#cb95-12"></a>oranges_rg1 &lt;-<span class="st"> </span>emmeans<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/emmeans/man/ref_grid.html">ref_grid</a></span>(oranges_lm1)</span>
<span id="cb95-13"><a href="#cb95-13"></a>marginal &lt;-<span class="st"> </span>emmeans<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html">emmeans</a></span>(oranges_rg1, <span class="st">"day"</span>)</span>
<span id="cb95-14"><a href="#cb95-14"></a></span>
<span id="cb95-15"><a href="#cb95-15"></a><span class="co"># looking at the tidy output (you can do this yourself)</span></span>
<span id="cb95-16"><a href="#cb95-16"></a><span class="co"># broom::tidy(marginal)</span></span>
<span id="cb95-17"><a href="#cb95-17"></a></span>
<span id="cb95-18"><a href="#cb95-18"></a><span class="co"># plotting it using `ggcoefstats`</span></span>
<span id="cb95-19"><a href="#cb95-19"></a><span class="co"># note that since there was column called `term`, the function created one</span></span>
<span id="cb95-20"><a href="#cb95-20"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb95-21"><a href="#cb95-21"></a>  <span class="dt">x =</span> marginal,</span>
<span id="cb95-22"><a href="#cb95-22"></a>  <span class="dt">point.color =</span> <span class="st">"darkgreen"</span>,</span>
<span id="cb95-23"><a href="#cb95-23"></a>  <span class="dt">point.shape =</span> <span class="dv">9</span>,</span>
<span id="cb95-24"><a href="#cb95-24"></a>  <span class="dt">title =</span> <span class="st">"summary grid from `emmeans` package"</span></span>
<span id="cb95-25"><a href="#cb95-25"></a>)</span>
<span id="cb95-26"><a href="#cb95-26"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span>
<span id="cb95-27"><a href="#cb95-27"></a><span class="co">#&gt; </span></span>
<span id="cb95-28"><a href="#cb95-28"></a><span class="co">#&gt; Could not extract p-values from model object.</span></span>
<span id="cb95-29"><a href="#cb95-29"></a><span class="co">#&gt; Note: No p-values and/or statistic available for the model object;</span></span>
<span id="cb95-30"><a href="#cb95-30"></a><span class="co">#&gt; skipping labels with statistical details.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/emmGrid-1.png" width="480"></p>
</div>
<div id="cochrane-orcutt-estimation-orcutt" class="section level2">
<h2 class="hasAnchor">
<a href="#cochrane-orcutt-estimation-orcutt" class="anchor"></a>Cochrane-Orcutt estimation (<code>orcutt</code>)</h2>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a><span class="co"># model</span></span>
<span id="cb96-2"><a href="#cb96-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(orcutt)</span>
<span id="cb96-3"><a href="#cb96-3"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb96-4"><a href="#cb96-4"></a>reg &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="dt">formula =</span> mpg <span class="op">~</span><span class="st"> </span>wt <span class="op">+</span><span class="st"> </span>qsec <span class="op">+</span><span class="st"> </span>disp, <span class="dt">data =</span> mtcars)</span>
<span id="cb96-5"><a href="#cb96-5"></a>co &lt;-<span class="st"> </span>orcutt<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/orcutt/man/cochrane.orcutt.html">cochrane.orcutt</a></span>(reg)</span>
<span id="cb96-6"><a href="#cb96-6"></a></span>
<span id="cb96-7"><a href="#cb96-7"></a><span class="co"># plot</span></span>
<span id="cb96-8"><a href="#cb96-8"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb96-9"><a href="#cb96-9"></a>  <span class="dt">x =</span> co,</span>
<span id="cb96-10"><a href="#cb96-10"></a>  <span class="dt">title =</span> <span class="st">"Cochrane-Orcutt estimation"</span></span>
<span id="cb96-11"><a href="#cb96-11"></a>)</span>
<span id="cb96-12"><a href="#cb96-12"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/orcutt-1.png" width="480"></p>
</div>
<div id="confusion-matrix-confusionmatrix" class="section level2">
<h2 class="hasAnchor">
<a href="#confusion-matrix-confusionmatrix" class="anchor"></a>confusion matrix (<code>confusionMatrix</code>)</h2>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a><span class="co"># setup</span></span>
<span id="cb97-2"><a href="#cb97-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(caret)</span>
<span id="cb97-3"><a href="#cb97-3"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb97-4"><a href="#cb97-4"></a></span>
<span id="cb97-5"><a href="#cb97-5"></a><span class="co"># setting up confusion matrix</span></span>
<span id="cb97-6"><a href="#cb97-6"></a>two_class_sample1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dv">100</span>, <span class="ot">TRUE</span>))</span>
<span id="cb97-7"><a href="#cb97-7"></a>two_class_sample2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dv">100</span>, <span class="ot">TRUE</span>))</span>
<span id="cb97-8"><a href="#cb97-8"></a></span>
<span id="cb97-9"><a href="#cb97-9"></a>two_class_cm &lt;-<span class="st"> </span>caret<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/caret/man/confusionMatrix.html">confusionMatrix</a></span>(</span>
<span id="cb97-10"><a href="#cb97-10"></a>  two_class_sample1,</span>
<span id="cb97-11"><a href="#cb97-11"></a>  two_class_sample2</span>
<span id="cb97-12"><a href="#cb97-12"></a>)</span>
<span id="cb97-13"><a href="#cb97-13"></a></span>
<span id="cb97-14"><a href="#cb97-14"></a><span class="co"># plot</span></span>
<span id="cb97-15"><a href="#cb97-15"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb97-16"><a href="#cb97-16"></a>  <span class="dt">x =</span> two_class_cm,</span>
<span id="cb97-17"><a href="#cb97-17"></a>  <span class="dt">by.class =</span> <span class="ot">TRUE</span>,</span>
<span id="cb97-18"><a href="#cb97-18"></a>  <span class="dt">title =</span> <span class="st">"confusion matrix"</span></span>
<span id="cb97-19"><a href="#cb97-19"></a>)</span>
<span id="cb97-20"><a href="#cb97-20"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span>
<span id="cb97-21"><a href="#cb97-21"></a><span class="co">#&gt; Note: No p-values and/or statistic available for the model object;</span></span>
<span id="cb97-22"><a href="#cb97-22"></a><span class="co">#&gt; skipping labels with statistical details.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/confusionMatrix-1.png" width="576"></p>
</div>
<div id="dose-response-modelscurves-drc" class="section level2">
<h2 class="hasAnchor">
<a href="#dose-response-modelscurves-drc" class="anchor"></a>dose-response models/curves (<code>drc</code>)</h2>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a><span class="co"># setup</span></span>
<span id="cb98-2"><a href="#cb98-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb98-3"><a href="#cb98-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(drc)</span>
<span id="cb98-4"><a href="#cb98-4"></a></span>
<span id="cb98-5"><a href="#cb98-5"></a><span class="co"># model</span></span>
<span id="cb98-6"><a href="#cb98-6"></a>mod &lt;-</span>
<span id="cb98-7"><a href="#cb98-7"></a><span class="st">  </span>drc<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/drc/man/drm.html">drm</a></span>(</span>
<span id="cb98-8"><a href="#cb98-8"></a>    <span class="dt">formula =</span> dead <span class="op">/</span><span class="st"> </span>total <span class="op">~</span><span class="st"> </span>conc,</span>
<span id="cb98-9"><a href="#cb98-9"></a>    <span class="dt">curveid =</span> type,</span>
<span id="cb98-10"><a href="#cb98-10"></a>    <span class="dt">weights =</span> total,</span>
<span id="cb98-11"><a href="#cb98-11"></a>    <span class="dt">data =</span> selenium,</span>
<span id="cb98-12"><a href="#cb98-12"></a>    <span class="dt">fct =</span> <span class="kw">LL.2</span>(),</span>
<span id="cb98-13"><a href="#cb98-13"></a>    <span class="dt">type =</span> <span class="st">"binomial"</span></span>
<span id="cb98-14"><a href="#cb98-14"></a>  )</span>
<span id="cb98-15"><a href="#cb98-15"></a></span>
<span id="cb98-16"><a href="#cb98-16"></a><span class="co"># plot</span></span>
<span id="cb98-17"><a href="#cb98-17"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb98-18"><a href="#cb98-18"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb98-19"><a href="#cb98-19"></a>  <span class="dt">conf.level =</span> <span class="fl">0.99</span>,</span>
<span id="cb98-20"><a href="#cb98-20"></a>  <span class="dt">title =</span> <span class="st">"Dose-Response Curves"</span></span>
<span id="cb98-21"><a href="#cb98-21"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/drc-1.png" width="480"></p>
</div>
<div id="flexible-parametric-regression-for-time-to-event-data-flexsurvreg" class="section level2">
<h2 class="hasAnchor">
<a href="#flexible-parametric-regression-for-time-to-event-data-flexsurvreg" class="anchor"></a>Flexible parametric regression for time-to-event data (<code>flexsurvreg</code>)</h2>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a><span class="co"># setup</span></span>
<span id="cb99-2"><a href="#cb99-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb99-3"><a href="#cb99-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(flexsurv)</span>
<span id="cb99-4"><a href="#cb99-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(ovarian)</span>
<span id="cb99-5"><a href="#cb99-5"></a></span>
<span id="cb99-6"><a href="#cb99-6"></a><span class="co"># compare generalized gamma fit with Weibull</span></span>
<span id="cb99-7"><a href="#cb99-7"></a>fitg &lt;-<span class="st"> </span><span class="kw">flexsurvreg</span>(</span>
<span id="cb99-8"><a href="#cb99-8"></a>  <span class="dt">formula =</span> <span class="kw">Surv</span>(futime, fustat) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb99-9"><a href="#cb99-9"></a>  <span class="dt">data =</span> ovarian,</span>
<span id="cb99-10"><a href="#cb99-10"></a>  <span class="dt">dist =</span> <span class="st">"gengamma"</span></span>
<span id="cb99-11"><a href="#cb99-11"></a>)</span>
<span id="cb99-12"><a href="#cb99-12"></a></span>
<span id="cb99-13"><a href="#cb99-13"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb99-14"><a href="#cb99-14"></a>  <span class="dt">x =</span> fitg,</span>
<span id="cb99-15"><a href="#cb99-15"></a>  <span class="dt">title =</span> <span class="st">"Flexible parametric regression for time-to-event data"</span></span>
<span id="cb99-16"><a href="#cb99-16"></a>)</span>
<span id="cb99-17"><a href="#cb99-17"></a><span class="co">#&gt; 'r2()' does not support models of class 'flexsurvreg'.</span></span>
<span id="cb99-18"><a href="#cb99-18"></a><span class="co">#&gt; Can't extract residuals from model.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/flexsurvreg-1.png" width="672"></p>
</div>
<div id="panel-regression-models-fit-via-multilevel-modeling-wblm" class="section level2">
<h2 class="hasAnchor">
<a href="#panel-regression-models-fit-via-multilevel-modeling-wblm" class="anchor"></a>panel regression models fit via multilevel modeling (<code>wblm</code>)</h2>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a><span class="co"># setup</span></span>
<span id="cb100-2"><a href="#cb100-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb100-3"><a href="#cb100-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(panelr)</span>
<span id="cb100-4"><a href="#cb100-4"></a></span>
<span id="cb100-5"><a href="#cb100-5"></a><span class="co"># data</span></span>
<span id="cb100-6"><a href="#cb100-6"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"WageData"</span>)</span>
<span id="cb100-7"><a href="#cb100-7"></a>wages &lt;-<span class="st"> </span>panelr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/panelr/man/panel_data.html">panel_data</a></span>(<span class="dt">data =</span> WageData, <span class="dt">id =</span> id, <span class="dt">wave =</span> t)</span>
<span id="cb100-8"><a href="#cb100-8"></a></span>
<span id="cb100-9"><a href="#cb100-9"></a><span class="co"># model</span></span>
<span id="cb100-10"><a href="#cb100-10"></a>mod &lt;-<span class="st"> </span><span class="kw">wbm</span>(</span>
<span id="cb100-11"><a href="#cb100-11"></a>  <span class="dt">formula =</span> lwage <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span>(union) <span class="op">+</span><span class="st"> </span>wks <span class="op">|</span><span class="st"> </span>blk <span class="op">+</span><span class="st"> </span>fem <span class="op">|</span><span class="st"> </span>blk <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span>(union),</span>
<span id="cb100-12"><a href="#cb100-12"></a>  <span class="dt">data =</span> wages</span>
<span id="cb100-13"><a href="#cb100-13"></a>)</span>
<span id="cb100-14"><a href="#cb100-14"></a></span>
<span id="cb100-15"><a href="#cb100-15"></a><span class="co"># plot</span></span>
<span id="cb100-16"><a href="#cb100-16"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb100-17"><a href="#cb100-17"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb100-18"><a href="#cb100-18"></a>  <span class="dt">title =</span> <span class="st">"panel regression models fit </span><span class="ch">\n</span><span class="st">via multilevel modeling"</span></span>
<span id="cb100-19"><a href="#cb100-19"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/wblm-1.png" width="672"></p>
</div>
<div id="panel-regression-models-fit-via-generalized-estimating-equations-wbgee" class="section level2">
<h2 class="hasAnchor">
<a href="#panel-regression-models-fit-via-generalized-estimating-equations-wbgee" class="anchor"></a>panel regression models fit via generalized estimating equations (<code>wbgee</code>)</h2>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a><span class="co"># setup</span></span>
<span id="cb101-2"><a href="#cb101-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb101-3"><a href="#cb101-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(panelr)</span>
<span id="cb101-4"><a href="#cb101-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"WageData"</span>)</span>
<span id="cb101-5"><a href="#cb101-5"></a></span>
<span id="cb101-6"><a href="#cb101-6"></a><span class="co"># data</span></span>
<span id="cb101-7"><a href="#cb101-7"></a>wages &lt;-<span class="st"> </span>panelr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/panelr/man/panel_data.html">panel_data</a></span>(<span class="dt">data =</span> WageData, <span class="dt">id =</span> id, <span class="dt">wave =</span> t)</span>
<span id="cb101-8"><a href="#cb101-8"></a></span>
<span id="cb101-9"><a href="#cb101-9"></a><span class="co"># model</span></span>
<span id="cb101-10"><a href="#cb101-10"></a>model &lt;-<span class="st"> </span>panelr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/panelr/man/wbgee.html">wbgee</a></span>(</span>
<span id="cb101-11"><a href="#cb101-11"></a>  <span class="dt">formula =</span> lwage <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span>(union) <span class="op">+</span><span class="st"> </span>wks <span class="op">|</span><span class="st"> </span>blk <span class="op">+</span><span class="st"> </span>fem <span class="op">|</span><span class="st"> </span>blk <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span>(union),</span>
<span id="cb101-12"><a href="#cb101-12"></a>  <span class="dt">data =</span> wages</span>
<span id="cb101-13"><a href="#cb101-13"></a>)</span>
<span id="cb101-14"><a href="#cb101-14"></a></span>
<span id="cb101-15"><a href="#cb101-15"></a><span class="co"># plot</span></span>
<span id="cb101-16"><a href="#cb101-16"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb101-17"><a href="#cb101-17"></a>  <span class="dt">x =</span> model,</span>
<span id="cb101-18"><a href="#cb101-18"></a>  <span class="dt">exclude.intercept =</span> <span class="ot">FALSE</span>,</span>
<span id="cb101-19"><a href="#cb101-19"></a>  <span class="dt">conf.level =</span> <span class="fl">0.99</span>,</span>
<span id="cb101-20"><a href="#cb101-20"></a>  <span class="dt">title =</span> <span class="st">"panel regression models fit </span><span class="ch">\n</span><span class="st">via generalized estimating equations"</span></span>
<span id="cb101-21"><a href="#cb101-21"></a>)</span>
<span id="cb101-22"><a href="#cb101-22"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/wbgee-1.png" width="576"></p>
</div>
<div id="summary-measures-for-count-data-epi-2by2" class="section level2">
<h2 class="hasAnchor">
<a href="#summary-measures-for-count-data-epi-2by2" class="anchor"></a>summary measures for count data (<code>epi.2by2</code>)</h2>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a><span class="co"># setup</span></span>
<span id="cb102-2"><a href="#cb102-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb102-3"><a href="#cb102-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(epiR)</span>
<span id="cb102-4"><a href="#cb102-4"></a></span>
<span id="cb102-5"><a href="#cb102-5"></a><span class="co"># data</span></span>
<span id="cb102-6"><a href="#cb102-6"></a>dat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">13</span>, <span class="dv">2163</span>, <span class="dv">5</span>, <span class="dv">3349</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</span>
<span id="cb102-7"><a href="#cb102-7"></a><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(dat) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"DF+"</span>, <span class="st">"DF-"</span>)</span>
<span id="cb102-8"><a href="#cb102-8"></a><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(dat) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"FUS+"</span>, <span class="st">"FUS-"</span>)</span>
<span id="cb102-9"><a href="#cb102-9"></a></span>
<span id="cb102-10"><a href="#cb102-10"></a><span class="co"># model</span></span>
<span id="cb102-11"><a href="#cb102-11"></a>fit &lt;-</span>
<span id="cb102-12"><a href="#cb102-12"></a><span class="st">  </span>epiR<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/epiR/man/epi.2by2.html">epi.2by2</a></span>(</span>
<span id="cb102-13"><a href="#cb102-13"></a>    <span class="dt">dat =</span> <span class="kw"><a href="https://rdrr.io/r/base/table.html">as.table</a></span>(dat),</span>
<span id="cb102-14"><a href="#cb102-14"></a>    <span class="dt">method =</span> <span class="st">"cross.sectional"</span>,</span>
<span id="cb102-15"><a href="#cb102-15"></a>    <span class="dt">conf.level =</span> <span class="fl">0.95</span>,</span>
<span id="cb102-16"><a href="#cb102-16"></a>    <span class="dt">units =</span> <span class="dv">100</span>,</span>
<span id="cb102-17"><a href="#cb102-17"></a>    <span class="dt">outcome =</span> <span class="st">"as.columns"</span></span>
<span id="cb102-18"><a href="#cb102-18"></a>  )</span>
<span id="cb102-19"><a href="#cb102-19"></a></span>
<span id="cb102-20"><a href="#cb102-20"></a><span class="co"># tidy dataframe</span></span>
<span id="cb102-21"><a href="#cb102-21"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb102-22"><a href="#cb102-22"></a>  <span class="dt">x =</span> fit,</span>
<span id="cb102-23"><a href="#cb102-23"></a>  <span class="dt">parameters =</span> <span class="st">"moa"</span>,</span>
<span id="cb102-24"><a href="#cb102-24"></a>  <span class="dt">title =</span> <span class="st">"Summary measures for count data </span><span class="ch">\n</span><span class="st">presented in a 2 by 2 table"</span></span>
<span id="cb102-25"><a href="#cb102-25"></a>)</span>
<span id="cb102-26"><a href="#cb102-26"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span>
<span id="cb102-27"><a href="#cb102-27"></a><span class="co">#&gt; </span></span>
<span id="cb102-28"><a href="#cb102-28"></a><span class="co">#&gt; Could not extract p-values from model object.</span></span>
<span id="cb102-29"><a href="#cb102-29"></a><span class="co">#&gt; Note: No p-values and/or statistic available for the model object;</span></span>
<span id="cb102-30"><a href="#cb102-30"></a><span class="co">#&gt; skipping labels with statistical details.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/epi.2by2-1.png" width="576"></p>
</div>
<div id="bayesian-generalized-non-linear-multivariate-multilevel-models-brmsfit" class="section level2">
<h2 class="hasAnchor">
<a href="#bayesian-generalized-non-linear-multivariate-multilevel-models-brmsfit" class="anchor"></a>Bayesian generalized (non-)linear multivariate multilevel models (<code>brmsfit</code>)</h2>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a><span class="co"># setup</span></span>
<span id="cb103-2"><a href="#cb103-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb103-3"><a href="#cb103-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(brms)</span>
<span id="cb103-4"><a href="#cb103-4"></a></span>
<span id="cb103-5"><a href="#cb103-5"></a><span class="co"># prior</span></span>
<span id="cb103-6"><a href="#cb103-6"></a>bprior1 &lt;-<span class="st"> </span><span class="kw">prior</span>(<span class="kw">student_t</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">10</span>), <span class="dt">class =</span> b) <span class="op">+</span><span class="st"> </span><span class="kw">prior</span>(<span class="kw">cauchy</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">class =</span> sd)</span>
<span id="cb103-7"><a href="#cb103-7"></a></span>
<span id="cb103-8"><a href="#cb103-8"></a><span class="co"># model</span></span>
<span id="cb103-9"><a href="#cb103-9"></a>fit1 &lt;-</span>
<span id="cb103-10"><a href="#cb103-10"></a><span class="st">  </span>brms<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/brms/man/brm.html">brm</a></span>(</span>
<span id="cb103-11"><a href="#cb103-11"></a>    <span class="dt">formula =</span> count <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>Base <span class="op">*</span><span class="st"> </span>Trt <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>patient),</span>
<span id="cb103-12"><a href="#cb103-12"></a>    <span class="dt">data =</span> epilepsy,</span>
<span id="cb103-13"><a href="#cb103-13"></a>    <span class="dt">family =</span> <span class="kw"><a href="https://rdrr.io/r/stats/family.html">poisson</a></span>(),</span>
<span id="cb103-14"><a href="#cb103-14"></a>    <span class="dt">prior =</span> bprior1,</span>
<span id="cb103-15"><a href="#cb103-15"></a>    <span class="dt">silent =</span> <span class="ot">TRUE</span></span>
<span id="cb103-16"><a href="#cb103-16"></a>  )</span>
<span id="cb103-17"><a href="#cb103-17"></a><span class="co">#&gt; </span></span>
<span id="cb103-18"><a href="#cb103-18"></a><span class="co">#&gt; SAMPLING FOR MODEL '48d3c6d0c01bc5c25f2639c8331fe9e8' NOW (CHAIN 1).</span></span>
<span id="cb103-19"><a href="#cb103-19"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb103-20"><a href="#cb103-20"></a><span class="co">#&gt; Chain 1: Gradient evaluation took 0 seconds</span></span>
<span id="cb103-21"><a href="#cb103-21"></a><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.</span></span>
<span id="cb103-22"><a href="#cb103-22"></a><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span id="cb103-23"><a href="#cb103-23"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb103-24"><a href="#cb103-24"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb103-25"><a href="#cb103-25"></a><span class="co">#&gt; Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span id="cb103-26"><a href="#cb103-26"></a><span class="co">#&gt; Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span id="cb103-27"><a href="#cb103-27"></a><span class="co">#&gt; Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span id="cb103-28"><a href="#cb103-28"></a><span class="co">#&gt; Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span id="cb103-29"><a href="#cb103-29"></a><span class="co">#&gt; Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span id="cb103-30"><a href="#cb103-30"></a><span class="co">#&gt; Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span id="cb103-31"><a href="#cb103-31"></a><span class="co">#&gt; Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span id="cb103-32"><a href="#cb103-32"></a><span class="co">#&gt; Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span id="cb103-33"><a href="#cb103-33"></a><span class="co">#&gt; Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span id="cb103-34"><a href="#cb103-34"></a><span class="co">#&gt; Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span id="cb103-35"><a href="#cb103-35"></a><span class="co">#&gt; Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span id="cb103-36"><a href="#cb103-36"></a><span class="co">#&gt; Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span id="cb103-37"><a href="#cb103-37"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb103-38"><a href="#cb103-38"></a><span class="co">#&gt; Chain 1:  Elapsed Time: 17.317 seconds (Warm-up)</span></span>
<span id="cb103-39"><a href="#cb103-39"></a><span class="co">#&gt; Chain 1:                5.729 seconds (Sampling)</span></span>
<span id="cb103-40"><a href="#cb103-40"></a><span class="co">#&gt; Chain 1:                23.046 seconds (Total)</span></span>
<span id="cb103-41"><a href="#cb103-41"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb103-42"><a href="#cb103-42"></a><span class="co">#&gt; </span></span>
<span id="cb103-43"><a href="#cb103-43"></a><span class="co">#&gt; SAMPLING FOR MODEL '48d3c6d0c01bc5c25f2639c8331fe9e8' NOW (CHAIN 2).</span></span>
<span id="cb103-44"><a href="#cb103-44"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb103-45"><a href="#cb103-45"></a><span class="co">#&gt; Chain 2: Gradient evaluation took 0 seconds</span></span>
<span id="cb103-46"><a href="#cb103-46"></a><span class="co">#&gt; Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.</span></span>
<span id="cb103-47"><a href="#cb103-47"></a><span class="co">#&gt; Chain 2: Adjust your expectations accordingly!</span></span>
<span id="cb103-48"><a href="#cb103-48"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb103-49"><a href="#cb103-49"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb103-50"><a href="#cb103-50"></a><span class="co">#&gt; Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span id="cb103-51"><a href="#cb103-51"></a><span class="co">#&gt; Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span id="cb103-52"><a href="#cb103-52"></a><span class="co">#&gt; Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span id="cb103-53"><a href="#cb103-53"></a><span class="co">#&gt; Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span id="cb103-54"><a href="#cb103-54"></a><span class="co">#&gt; Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span id="cb103-55"><a href="#cb103-55"></a><span class="co">#&gt; Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span id="cb103-56"><a href="#cb103-56"></a><span class="co">#&gt; Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span id="cb103-57"><a href="#cb103-57"></a><span class="co">#&gt; Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span id="cb103-58"><a href="#cb103-58"></a><span class="co">#&gt; Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span id="cb103-59"><a href="#cb103-59"></a><span class="co">#&gt; Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span id="cb103-60"><a href="#cb103-60"></a><span class="co">#&gt; Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span id="cb103-61"><a href="#cb103-61"></a><span class="co">#&gt; Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span id="cb103-62"><a href="#cb103-62"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb103-63"><a href="#cb103-63"></a><span class="co">#&gt; Chain 2:  Elapsed Time: 27.828 seconds (Warm-up)</span></span>
<span id="cb103-64"><a href="#cb103-64"></a><span class="co">#&gt; Chain 2:                61.592 seconds (Sampling)</span></span>
<span id="cb103-65"><a href="#cb103-65"></a><span class="co">#&gt; Chain 2:                89.42 seconds (Total)</span></span>
<span id="cb103-66"><a href="#cb103-66"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb103-67"><a href="#cb103-67"></a><span class="co">#&gt; </span></span>
<span id="cb103-68"><a href="#cb103-68"></a><span class="co">#&gt; SAMPLING FOR MODEL '48d3c6d0c01bc5c25f2639c8331fe9e8' NOW (CHAIN 3).</span></span>
<span id="cb103-69"><a href="#cb103-69"></a><span class="co">#&gt; Chain 3: </span></span>
<span id="cb103-70"><a href="#cb103-70"></a><span class="co">#&gt; Chain 3: Gradient evaluation took 0 seconds</span></span>
<span id="cb103-71"><a href="#cb103-71"></a><span class="co">#&gt; Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.</span></span>
<span id="cb103-72"><a href="#cb103-72"></a><span class="co">#&gt; Chain 3: Adjust your expectations accordingly!</span></span>
<span id="cb103-73"><a href="#cb103-73"></a><span class="co">#&gt; Chain 3: </span></span>
<span id="cb103-74"><a href="#cb103-74"></a><span class="co">#&gt; Chain 3: </span></span>
<span id="cb103-75"><a href="#cb103-75"></a><span class="co">#&gt; Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span id="cb103-76"><a href="#cb103-76"></a><span class="co">#&gt; Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span id="cb103-77"><a href="#cb103-77"></a><span class="co">#&gt; Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span id="cb103-78"><a href="#cb103-78"></a><span class="co">#&gt; Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span id="cb103-79"><a href="#cb103-79"></a><span class="co">#&gt; Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span id="cb103-80"><a href="#cb103-80"></a><span class="co">#&gt; Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span id="cb103-81"><a href="#cb103-81"></a><span class="co">#&gt; Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span id="cb103-82"><a href="#cb103-82"></a><span class="co">#&gt; Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span id="cb103-83"><a href="#cb103-83"></a><span class="co">#&gt; Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span id="cb103-84"><a href="#cb103-84"></a><span class="co">#&gt; Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span id="cb103-85"><a href="#cb103-85"></a><span class="co">#&gt; Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span id="cb103-86"><a href="#cb103-86"></a><span class="co">#&gt; Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span id="cb103-87"><a href="#cb103-87"></a><span class="co">#&gt; Chain 3: </span></span>
<span id="cb103-88"><a href="#cb103-88"></a><span class="co">#&gt; Chain 3:  Elapsed Time: 10.039 seconds (Warm-up)</span></span>
<span id="cb103-89"><a href="#cb103-89"></a><span class="co">#&gt; Chain 3:                6.96 seconds (Sampling)</span></span>
<span id="cb103-90"><a href="#cb103-90"></a><span class="co">#&gt; Chain 3:                16.999 seconds (Total)</span></span>
<span id="cb103-91"><a href="#cb103-91"></a><span class="co">#&gt; Chain 3: </span></span>
<span id="cb103-92"><a href="#cb103-92"></a><span class="co">#&gt; </span></span>
<span id="cb103-93"><a href="#cb103-93"></a><span class="co">#&gt; SAMPLING FOR MODEL '48d3c6d0c01bc5c25f2639c8331fe9e8' NOW (CHAIN 4).</span></span>
<span id="cb103-94"><a href="#cb103-94"></a><span class="co">#&gt; Chain 4: </span></span>
<span id="cb103-95"><a href="#cb103-95"></a><span class="co">#&gt; Chain 4: Gradient evaluation took 0 seconds</span></span>
<span id="cb103-96"><a href="#cb103-96"></a><span class="co">#&gt; Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.</span></span>
<span id="cb103-97"><a href="#cb103-97"></a><span class="co">#&gt; Chain 4: Adjust your expectations accordingly!</span></span>
<span id="cb103-98"><a href="#cb103-98"></a><span class="co">#&gt; Chain 4: </span></span>
<span id="cb103-99"><a href="#cb103-99"></a><span class="co">#&gt; Chain 4: </span></span>
<span id="cb103-100"><a href="#cb103-100"></a><span class="co">#&gt; Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span id="cb103-101"><a href="#cb103-101"></a><span class="co">#&gt; Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span id="cb103-102"><a href="#cb103-102"></a><span class="co">#&gt; Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span id="cb103-103"><a href="#cb103-103"></a><span class="co">#&gt; Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span id="cb103-104"><a href="#cb103-104"></a><span class="co">#&gt; Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span id="cb103-105"><a href="#cb103-105"></a><span class="co">#&gt; Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span id="cb103-106"><a href="#cb103-106"></a><span class="co">#&gt; Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span id="cb103-107"><a href="#cb103-107"></a><span class="co">#&gt; Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span id="cb103-108"><a href="#cb103-108"></a><span class="co">#&gt; Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span id="cb103-109"><a href="#cb103-109"></a><span class="co">#&gt; Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span id="cb103-110"><a href="#cb103-110"></a><span class="co">#&gt; Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span id="cb103-111"><a href="#cb103-111"></a><span class="co">#&gt; Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span id="cb103-112"><a href="#cb103-112"></a><span class="co">#&gt; Chain 4: </span></span>
<span id="cb103-113"><a href="#cb103-113"></a><span class="co">#&gt; Chain 4:  Elapsed Time: 8.618 seconds (Warm-up)</span></span>
<span id="cb103-114"><a href="#cb103-114"></a><span class="co">#&gt; Chain 4:                6.719 seconds (Sampling)</span></span>
<span id="cb103-115"><a href="#cb103-115"></a><span class="co">#&gt; Chain 4:                15.337 seconds (Total)</span></span>
<span id="cb103-116"><a href="#cb103-116"></a><span class="co">#&gt; Chain 4:</span></span>
<span id="cb103-117"><a href="#cb103-117"></a></span>
<span id="cb103-118"><a href="#cb103-118"></a><span class="co"># plot</span></span>
<span id="cb103-119"><a href="#cb103-119"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb103-120"><a href="#cb103-120"></a>  <span class="dt">x =</span> fit1,</span>
<span id="cb103-121"><a href="#cb103-121"></a>  <span class="dt">exclude.intercept =</span> <span class="ot">FALSE</span>,</span>
<span id="cb103-122"><a href="#cb103-122"></a>  <span class="dt">conf.method =</span> <span class="st">"HPDinterval"</span>,</span>
<span id="cb103-123"><a href="#cb103-123"></a>  <span class="dt">title =</span> <span class="st">"Bayesian generalized (non-)linear </span><span class="ch">\n</span><span class="st">multivariate multilevel models"</span>,</span>
<span id="cb103-124"><a href="#cb103-124"></a>  <span class="dt">subtitle =</span> <span class="st">"using `brms` package"</span></span>
<span id="cb103-125"><a href="#cb103-125"></a>)</span>
<span id="cb103-126"><a href="#cb103-126"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span>
<span id="cb103-127"><a href="#cb103-127"></a><span class="co">#&gt; Note: No p-values and/or statistic available for the model object;</span></span>
<span id="cb103-128"><a href="#cb103-128"></a><span class="co">#&gt; skipping labels with statistical details.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/brmsfit-1.png" width="480"></p>
<p>Let’s see another example where we use <code>brms</code> to run the same model on multiple datasets-</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a><span class="co"># setup</span></span>
<span id="cb104-2"><a href="#cb104-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb104-3"><a href="#cb104-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(brms)</span>
<span id="cb104-4"><a href="#cb104-4"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(mice)</span>
<span id="cb104-5"><a href="#cb104-5"></a></span>
<span id="cb104-6"><a href="#cb104-6"></a><span class="co"># data</span></span>
<span id="cb104-7"><a href="#cb104-7"></a>imp &lt;-<span class="st"> </span>mice<span class="op">::</span><span class="kw"><a href="http://stefvanbuuren.github.io/mice/reference/mice.html">mice</a></span>(<span class="dt">data =</span> nhanes2, <span class="dt">print =</span> <span class="ot">FALSE</span>)</span>
<span id="cb104-8"><a href="#cb104-8"></a></span>
<span id="cb104-9"><a href="#cb104-9"></a><span class="co"># fit the model using brms</span></span>
<span id="cb104-10"><a href="#cb104-10"></a>fit &lt;-</span>
<span id="cb104-11"><a href="#cb104-11"></a><span class="st">  </span>brms<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/brms/man/brm_multiple.html">brm_multiple</a></span>(</span>
<span id="cb104-12"><a href="#cb104-12"></a>    <span class="dt">formula =</span> bmi <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>hyp <span class="op">+</span><span class="st"> </span>chl,</span>
<span id="cb104-13"><a href="#cb104-13"></a>    <span class="dt">data =</span> imp,</span>
<span id="cb104-14"><a href="#cb104-14"></a>    <span class="dt">chains =</span> <span class="dv">1</span></span>
<span id="cb104-15"><a href="#cb104-15"></a>  )</span>
<span id="cb104-16"><a href="#cb104-16"></a><span class="co">#&gt; </span></span>
<span id="cb104-17"><a href="#cb104-17"></a><span class="co">#&gt; SAMPLING FOR MODEL '7314ca32b757518f6b6cf5c642a54cb2' NOW (CHAIN 1).</span></span>
<span id="cb104-18"><a href="#cb104-18"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb104-19"><a href="#cb104-19"></a><span class="co">#&gt; Chain 1: Gradient evaluation took 0 seconds</span></span>
<span id="cb104-20"><a href="#cb104-20"></a><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.</span></span>
<span id="cb104-21"><a href="#cb104-21"></a><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span id="cb104-22"><a href="#cb104-22"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb104-23"><a href="#cb104-23"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb104-24"><a href="#cb104-24"></a><span class="co">#&gt; Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span id="cb104-25"><a href="#cb104-25"></a><span class="co">#&gt; Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span id="cb104-26"><a href="#cb104-26"></a><span class="co">#&gt; Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span id="cb104-27"><a href="#cb104-27"></a><span class="co">#&gt; Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span id="cb104-28"><a href="#cb104-28"></a><span class="co">#&gt; Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span id="cb104-29"><a href="#cb104-29"></a><span class="co">#&gt; Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span id="cb104-30"><a href="#cb104-30"></a><span class="co">#&gt; Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span id="cb104-31"><a href="#cb104-31"></a><span class="co">#&gt; Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span id="cb104-32"><a href="#cb104-32"></a><span class="co">#&gt; Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span id="cb104-33"><a href="#cb104-33"></a><span class="co">#&gt; Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span id="cb104-34"><a href="#cb104-34"></a><span class="co">#&gt; Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span id="cb104-35"><a href="#cb104-35"></a><span class="co">#&gt; Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span id="cb104-36"><a href="#cb104-36"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb104-37"><a href="#cb104-37"></a><span class="co">#&gt; Chain 1:  Elapsed Time: 0.234 seconds (Warm-up)</span></span>
<span id="cb104-38"><a href="#cb104-38"></a><span class="co">#&gt; Chain 1:                0.127 seconds (Sampling)</span></span>
<span id="cb104-39"><a href="#cb104-39"></a><span class="co">#&gt; Chain 1:                0.361 seconds (Total)</span></span>
<span id="cb104-40"><a href="#cb104-40"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb104-41"><a href="#cb104-41"></a><span class="co">#&gt; </span></span>
<span id="cb104-42"><a href="#cb104-42"></a><span class="co">#&gt; SAMPLING FOR MODEL '7314ca32b757518f6b6cf5c642a54cb2' NOW (CHAIN 1).</span></span>
<span id="cb104-43"><a href="#cb104-43"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb104-44"><a href="#cb104-44"></a><span class="co">#&gt; Chain 1: Gradient evaluation took 0 seconds</span></span>
<span id="cb104-45"><a href="#cb104-45"></a><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.</span></span>
<span id="cb104-46"><a href="#cb104-46"></a><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span id="cb104-47"><a href="#cb104-47"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb104-48"><a href="#cb104-48"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb104-49"><a href="#cb104-49"></a><span class="co">#&gt; Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span id="cb104-50"><a href="#cb104-50"></a><span class="co">#&gt; Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span id="cb104-51"><a href="#cb104-51"></a><span class="co">#&gt; Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span id="cb104-52"><a href="#cb104-52"></a><span class="co">#&gt; Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span id="cb104-53"><a href="#cb104-53"></a><span class="co">#&gt; Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span id="cb104-54"><a href="#cb104-54"></a><span class="co">#&gt; Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span id="cb104-55"><a href="#cb104-55"></a><span class="co">#&gt; Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span id="cb104-56"><a href="#cb104-56"></a><span class="co">#&gt; Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span id="cb104-57"><a href="#cb104-57"></a><span class="co">#&gt; Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span id="cb104-58"><a href="#cb104-58"></a><span class="co">#&gt; Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span id="cb104-59"><a href="#cb104-59"></a><span class="co">#&gt; Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span id="cb104-60"><a href="#cb104-60"></a><span class="co">#&gt; Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span id="cb104-61"><a href="#cb104-61"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb104-62"><a href="#cb104-62"></a><span class="co">#&gt; Chain 1:  Elapsed Time: 0.24 seconds (Warm-up)</span></span>
<span id="cb104-63"><a href="#cb104-63"></a><span class="co">#&gt; Chain 1:                0.107 seconds (Sampling)</span></span>
<span id="cb104-64"><a href="#cb104-64"></a><span class="co">#&gt; Chain 1:                0.347 seconds (Total)</span></span>
<span id="cb104-65"><a href="#cb104-65"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb104-66"><a href="#cb104-66"></a><span class="co">#&gt; </span></span>
<span id="cb104-67"><a href="#cb104-67"></a><span class="co">#&gt; SAMPLING FOR MODEL '7314ca32b757518f6b6cf5c642a54cb2' NOW (CHAIN 1).</span></span>
<span id="cb104-68"><a href="#cb104-68"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb104-69"><a href="#cb104-69"></a><span class="co">#&gt; Chain 1: Gradient evaluation took 0 seconds</span></span>
<span id="cb104-70"><a href="#cb104-70"></a><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.</span></span>
<span id="cb104-71"><a href="#cb104-71"></a><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span id="cb104-72"><a href="#cb104-72"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb104-73"><a href="#cb104-73"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb104-74"><a href="#cb104-74"></a><span class="co">#&gt; Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span id="cb104-75"><a href="#cb104-75"></a><span class="co">#&gt; Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span id="cb104-76"><a href="#cb104-76"></a><span class="co">#&gt; Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span id="cb104-77"><a href="#cb104-77"></a><span class="co">#&gt; Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span id="cb104-78"><a href="#cb104-78"></a><span class="co">#&gt; Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span id="cb104-79"><a href="#cb104-79"></a><span class="co">#&gt; Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span id="cb104-80"><a href="#cb104-80"></a><span class="co">#&gt; Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span id="cb104-81"><a href="#cb104-81"></a><span class="co">#&gt; Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span id="cb104-82"><a href="#cb104-82"></a><span class="co">#&gt; Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span id="cb104-83"><a href="#cb104-83"></a><span class="co">#&gt; Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span id="cb104-84"><a href="#cb104-84"></a><span class="co">#&gt; Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span id="cb104-85"><a href="#cb104-85"></a><span class="co">#&gt; Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span id="cb104-86"><a href="#cb104-86"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb104-87"><a href="#cb104-87"></a><span class="co">#&gt; Chain 1:  Elapsed Time: 0.223 seconds (Warm-up)</span></span>
<span id="cb104-88"><a href="#cb104-88"></a><span class="co">#&gt; Chain 1:                0.038 seconds (Sampling)</span></span>
<span id="cb104-89"><a href="#cb104-89"></a><span class="co">#&gt; Chain 1:                0.261 seconds (Total)</span></span>
<span id="cb104-90"><a href="#cb104-90"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb104-91"><a href="#cb104-91"></a><span class="co">#&gt; </span></span>
<span id="cb104-92"><a href="#cb104-92"></a><span class="co">#&gt; SAMPLING FOR MODEL '7314ca32b757518f6b6cf5c642a54cb2' NOW (CHAIN 1).</span></span>
<span id="cb104-93"><a href="#cb104-93"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb104-94"><a href="#cb104-94"></a><span class="co">#&gt; Chain 1: Gradient evaluation took 0 seconds</span></span>
<span id="cb104-95"><a href="#cb104-95"></a><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.</span></span>
<span id="cb104-96"><a href="#cb104-96"></a><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span id="cb104-97"><a href="#cb104-97"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb104-98"><a href="#cb104-98"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb104-99"><a href="#cb104-99"></a><span class="co">#&gt; Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span id="cb104-100"><a href="#cb104-100"></a><span class="co">#&gt; Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span id="cb104-101"><a href="#cb104-101"></a><span class="co">#&gt; Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span id="cb104-102"><a href="#cb104-102"></a><span class="co">#&gt; Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span id="cb104-103"><a href="#cb104-103"></a><span class="co">#&gt; Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span id="cb104-104"><a href="#cb104-104"></a><span class="co">#&gt; Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span id="cb104-105"><a href="#cb104-105"></a><span class="co">#&gt; Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span id="cb104-106"><a href="#cb104-106"></a><span class="co">#&gt; Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span id="cb104-107"><a href="#cb104-107"></a><span class="co">#&gt; Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span id="cb104-108"><a href="#cb104-108"></a><span class="co">#&gt; Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span id="cb104-109"><a href="#cb104-109"></a><span class="co">#&gt; Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span id="cb104-110"><a href="#cb104-110"></a><span class="co">#&gt; Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span id="cb104-111"><a href="#cb104-111"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb104-112"><a href="#cb104-112"></a><span class="co">#&gt; Chain 1:  Elapsed Time: 0.213 seconds (Warm-up)</span></span>
<span id="cb104-113"><a href="#cb104-113"></a><span class="co">#&gt; Chain 1:                0.034 seconds (Sampling)</span></span>
<span id="cb104-114"><a href="#cb104-114"></a><span class="co">#&gt; Chain 1:                0.247 seconds (Total)</span></span>
<span id="cb104-115"><a href="#cb104-115"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb104-116"><a href="#cb104-116"></a><span class="co">#&gt; </span></span>
<span id="cb104-117"><a href="#cb104-117"></a><span class="co">#&gt; SAMPLING FOR MODEL '7314ca32b757518f6b6cf5c642a54cb2' NOW (CHAIN 1).</span></span>
<span id="cb104-118"><a href="#cb104-118"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb104-119"><a href="#cb104-119"></a><span class="co">#&gt; Chain 1: Gradient evaluation took 0 seconds</span></span>
<span id="cb104-120"><a href="#cb104-120"></a><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.</span></span>
<span id="cb104-121"><a href="#cb104-121"></a><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span id="cb104-122"><a href="#cb104-122"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb104-123"><a href="#cb104-123"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb104-124"><a href="#cb104-124"></a><span class="co">#&gt; Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span id="cb104-125"><a href="#cb104-125"></a><span class="co">#&gt; Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span id="cb104-126"><a href="#cb104-126"></a><span class="co">#&gt; Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span id="cb104-127"><a href="#cb104-127"></a><span class="co">#&gt; Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span id="cb104-128"><a href="#cb104-128"></a><span class="co">#&gt; Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span id="cb104-129"><a href="#cb104-129"></a><span class="co">#&gt; Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span id="cb104-130"><a href="#cb104-130"></a><span class="co">#&gt; Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span id="cb104-131"><a href="#cb104-131"></a><span class="co">#&gt; Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span id="cb104-132"><a href="#cb104-132"></a><span class="co">#&gt; Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span id="cb104-133"><a href="#cb104-133"></a><span class="co">#&gt; Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span id="cb104-134"><a href="#cb104-134"></a><span class="co">#&gt; Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span id="cb104-135"><a href="#cb104-135"></a><span class="co">#&gt; Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span id="cb104-136"><a href="#cb104-136"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb104-137"><a href="#cb104-137"></a><span class="co">#&gt; Chain 1:  Elapsed Time: 0.211 seconds (Warm-up)</span></span>
<span id="cb104-138"><a href="#cb104-138"></a><span class="co">#&gt; Chain 1:                0.042 seconds (Sampling)</span></span>
<span id="cb104-139"><a href="#cb104-139"></a><span class="co">#&gt; Chain 1:                0.253 seconds (Total)</span></span>
<span id="cb104-140"><a href="#cb104-140"></a><span class="co">#&gt; Chain 1:</span></span>
<span id="cb104-141"><a href="#cb104-141"></a></span>
<span id="cb104-142"><a href="#cb104-142"></a><span class="co"># plot</span></span>
<span id="cb104-143"><a href="#cb104-143"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb104-144"><a href="#cb104-144"></a>  <span class="dt">x =</span> fit,</span>
<span id="cb104-145"><a href="#cb104-145"></a>  <span class="dt">title =</span> <span class="st">"Same `brms` model with multiple datasets"</span>,</span>
<span id="cb104-146"><a href="#cb104-146"></a>  <span class="dt">conf.level =</span> <span class="fl">0.99</span></span>
<span id="cb104-147"><a href="#cb104-147"></a>)</span>
<span id="cb104-148"><a href="#cb104-148"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span>
<span id="cb104-149"><a href="#cb104-149"></a><span class="co">#&gt; Note: No p-values and/or statistic available for the model object;</span></span>
<span id="cb104-150"><a href="#cb104-150"></a><span class="co">#&gt; skipping labels with statistical details.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/brmsfit_multiple-1.png" width="672"></p>
</div>
<div id="bayesian-regression-models-via-stan-stanreg" class="section level2">
<h2 class="hasAnchor">
<a href="#bayesian-regression-models-via-stan-stanreg" class="anchor"></a>Bayesian regression models via Stan (<code>stanreg</code>)</h2>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a><span class="co"># set up</span></span>
<span id="cb105-2"><a href="#cb105-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb105-3"><a href="#cb105-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(rstanarm)</span>
<span id="cb105-4"><a href="#cb105-4"></a></span>
<span id="cb105-5"><a href="#cb105-5"></a><span class="co"># model</span></span>
<span id="cb105-6"><a href="#cb105-6"></a>fit &lt;-</span>
<span id="cb105-7"><a href="#cb105-7"></a><span class="st">  </span>rstanarm<span class="op">::</span><span class="kw"><a href="https://mc-stan.org/rstanarm/reference/stan_glm.html">stan_glm</a></span>(</span>
<span id="cb105-8"><a href="#cb105-8"></a>    <span class="dt">formula =</span> mpg <span class="op">~</span><span class="st"> </span>wt <span class="op">+</span><span class="st"> </span>am,</span>
<span id="cb105-9"><a href="#cb105-9"></a>    <span class="dt">data =</span> mtcars,</span>
<span id="cb105-10"><a href="#cb105-10"></a>    <span class="dt">chains =</span> <span class="dv">1</span></span>
<span id="cb105-11"><a href="#cb105-11"></a>  )</span>
<span id="cb105-12"><a href="#cb105-12"></a><span class="co">#&gt; </span></span>
<span id="cb105-13"><a href="#cb105-13"></a><span class="co">#&gt; SAMPLING FOR MODEL 'continuous' NOW (CHAIN 1).</span></span>
<span id="cb105-14"><a href="#cb105-14"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb105-15"><a href="#cb105-15"></a><span class="co">#&gt; Chain 1: Gradient evaluation took 0.002 seconds</span></span>
<span id="cb105-16"><a href="#cb105-16"></a><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 20 seconds.</span></span>
<span id="cb105-17"><a href="#cb105-17"></a><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span id="cb105-18"><a href="#cb105-18"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb105-19"><a href="#cb105-19"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb105-20"><a href="#cb105-20"></a><span class="co">#&gt; Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span id="cb105-21"><a href="#cb105-21"></a><span class="co">#&gt; Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span id="cb105-22"><a href="#cb105-22"></a><span class="co">#&gt; Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span id="cb105-23"><a href="#cb105-23"></a><span class="co">#&gt; Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span id="cb105-24"><a href="#cb105-24"></a><span class="co">#&gt; Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span id="cb105-25"><a href="#cb105-25"></a><span class="co">#&gt; Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span id="cb105-26"><a href="#cb105-26"></a><span class="co">#&gt; Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span id="cb105-27"><a href="#cb105-27"></a><span class="co">#&gt; Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span id="cb105-28"><a href="#cb105-28"></a><span class="co">#&gt; Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span id="cb105-29"><a href="#cb105-29"></a><span class="co">#&gt; Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span id="cb105-30"><a href="#cb105-30"></a><span class="co">#&gt; Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span id="cb105-31"><a href="#cb105-31"></a><span class="co">#&gt; Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span id="cb105-32"><a href="#cb105-32"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb105-33"><a href="#cb105-33"></a><span class="co">#&gt; Chain 1:  Elapsed Time: 0.131 seconds (Warm-up)</span></span>
<span id="cb105-34"><a href="#cb105-34"></a><span class="co">#&gt; Chain 1:                0.135 seconds (Sampling)</span></span>
<span id="cb105-35"><a href="#cb105-35"></a><span class="co">#&gt; Chain 1:                0.266 seconds (Total)</span></span>
<span id="cb105-36"><a href="#cb105-36"></a><span class="co">#&gt; Chain 1:</span></span>
<span id="cb105-37"><a href="#cb105-37"></a></span>
<span id="cb105-38"><a href="#cb105-38"></a><span class="co"># plot</span></span>
<span id="cb105-39"><a href="#cb105-39"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb105-40"><a href="#cb105-40"></a>  <span class="dt">x =</span> fit,</span>
<span id="cb105-41"><a href="#cb105-41"></a>  <span class="dt">title =</span> <span class="st">"Bayesian generalized linear models via Stan"</span></span>
<span id="cb105-42"><a href="#cb105-42"></a>)</span>
<span id="cb105-43"><a href="#cb105-43"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span>
<span id="cb105-44"><a href="#cb105-44"></a><span class="co">#&gt; Note: No p-values and/or statistic available for the model object;</span></span>
<span id="cb105-45"><a href="#cb105-45"></a><span class="co">#&gt; skipping labels with statistical details.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/stanreg-1.png" width="480"></p>
</div>
<div id="bayesian-multivariate-generalized-linear-models-via-stan-stanmvreg" class="section level2">
<h2 class="hasAnchor">
<a href="#bayesian-multivariate-generalized-linear-models-via-stan-stanmvreg" class="anchor"></a>Bayesian multivariate generalized linear models via Stan (<code>stanmvreg</code>)</h2>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a><span class="co"># setup</span></span>
<span id="cb106-2"><a href="#cb106-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb106-3"><a href="#cb106-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(rstanarm)</span>
<span id="cb106-4"><a href="#cb106-4"></a>pbcLong<span class="op">$</span>ybern &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(pbcLong<span class="op">$</span>logBili <span class="op">&gt;=</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(pbcLong<span class="op">$</span>logBili))</span>
<span id="cb106-5"><a href="#cb106-5"></a></span>
<span id="cb106-6"><a href="#cb106-6"></a><span class="co"># model</span></span>
<span id="cb106-7"><a href="#cb106-7"></a>mod &lt;-</span>
<span id="cb106-8"><a href="#cb106-8"></a><span class="st">  </span>rstanarm<span class="op">::</span><span class="kw"><a href="https://mc-stan.org/rstanarm/reference/stan_mvmer.html">stan_mvmer</a></span>(</span>
<span id="cb106-9"><a href="#cb106-9"></a>    <span class="dt">formula =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</span>
<span id="cb106-10"><a href="#cb106-10"></a>      ybern <span class="op">~</span><span class="st"> </span>year <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>id),</span>
<span id="cb106-11"><a href="#cb106-11"></a>      albumin <span class="op">~</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>year <span class="op">+</span><span class="st"> </span>(year <span class="op">|</span><span class="st"> </span>id)</span>
<span id="cb106-12"><a href="#cb106-12"></a>    ),</span>
<span id="cb106-13"><a href="#cb106-13"></a>    <span class="dt">data =</span> pbcLong,</span>
<span id="cb106-14"><a href="#cb106-14"></a>    <span class="dt">cores =</span> <span class="dv">4</span>,</span>
<span id="cb106-15"><a href="#cb106-15"></a>    <span class="dt">seed =</span> <span class="dv">12345</span>,</span>
<span id="cb106-16"><a href="#cb106-16"></a>    <span class="dt">iter =</span> <span class="dv">1000</span></span>
<span id="cb106-17"><a href="#cb106-17"></a>  )</span>
<span id="cb106-18"><a href="#cb106-18"></a><span class="co">#&gt; Fitting a multivariate glmer model.</span></span>
<span id="cb106-19"><a href="#cb106-19"></a><span class="co">#&gt; </span></span>
<span id="cb106-20"><a href="#cb106-20"></a><span class="co">#&gt; Please note the warmup may be much slower than later iterations!</span></span>
<span id="cb106-21"><a href="#cb106-21"></a></span>
<span id="cb106-22"><a href="#cb106-22"></a><span class="co"># plot</span></span>
<span id="cb106-23"><a href="#cb106-23"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb106-24"><a href="#cb106-24"></a>  <span class="dt">x =</span> mod,</span>
<span id="cb106-25"><a href="#cb106-25"></a>  <span class="dt">title =</span> <span class="st">"Bayesian multivariate generalized linear models </span><span class="ch">\n</span><span class="st">via Stan"</span></span>
<span id="cb106-26"><a href="#cb106-26"></a>)</span>
<span id="cb106-27"><a href="#cb106-27"></a><span class="co">#&gt; argument is of length zero</span></span>
<span id="cb106-28"><a href="#cb106-28"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span>
<span id="cb106-29"><a href="#cb106-29"></a><span class="co">#&gt; Error: All elements in the column `term` should be unique.</span></span></code></pre></div>
</div>
<div id="bayesian-nonlinear-models-via-stan-nlstanreg" class="section level2">
<h2 class="hasAnchor">
<a href="#bayesian-nonlinear-models-via-stan-nlstanreg" class="anchor"></a>Bayesian nonlinear models via Stan (<code>nlstanreg</code>)</h2>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a><span class="co"># setup</span></span>
<span id="cb107-2"><a href="#cb107-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb107-3"><a href="#cb107-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(rstanarm)</span>
<span id="cb107-4"><a href="#cb107-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"Orange"</span>, <span class="dt">package =</span> <span class="st">"datasets"</span>)</span>
<span id="cb107-5"><a href="#cb107-5"></a>Orange<span class="op">$</span>circumference &lt;-<span class="st"> </span>Orange<span class="op">$</span>circumference <span class="op">/</span><span class="st"> </span><span class="dv">100</span></span>
<span id="cb107-6"><a href="#cb107-6"></a>Orange<span class="op">$</span>age &lt;-<span class="st"> </span>Orange<span class="op">$</span>age <span class="op">/</span><span class="st"> </span><span class="dv">100</span></span>
<span id="cb107-7"><a href="#cb107-7"></a></span>
<span id="cb107-8"><a href="#cb107-8"></a><span class="co"># model</span></span>
<span id="cb107-9"><a href="#cb107-9"></a>fit &lt;-</span>
<span id="cb107-10"><a href="#cb107-10"></a><span class="st">  </span>rstanarm<span class="op">::</span><span class="kw"><a href="https://mc-stan.org/rstanarm/reference/stan_nlmer.html">stan_nlmer</a></span>(</span>
<span id="cb107-11"><a href="#cb107-11"></a>    <span class="dt">formula =</span> circumference <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/SSlogis.html">SSlogis</a></span>(age, Asym, xmid, scal) <span class="op">~</span><span class="st"> </span>Asym <span class="op">|</span><span class="st"> </span>Tree,</span>
<span id="cb107-12"><a href="#cb107-12"></a>    <span class="dt">data =</span> Orange,</span>
<span id="cb107-13"><a href="#cb107-13"></a>    <span class="co"># for speed only</span></span>
<span id="cb107-14"><a href="#cb107-14"></a>    <span class="dt">chains =</span> <span class="dv">1</span>,</span>
<span id="cb107-15"><a href="#cb107-15"></a>    <span class="dt">iter =</span> <span class="dv">1000</span></span>
<span id="cb107-16"><a href="#cb107-16"></a>  )</span>
<span id="cb107-17"><a href="#cb107-17"></a><span class="co">#&gt; </span></span>
<span id="cb107-18"><a href="#cb107-18"></a><span class="co">#&gt; SAMPLING FOR MODEL 'continuous' NOW (CHAIN 1).</span></span>
<span id="cb107-19"><a href="#cb107-19"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb107-20"><a href="#cb107-20"></a><span class="co">#&gt; Chain 1: Gradient evaluation took 0.001 seconds</span></span>
<span id="cb107-21"><a href="#cb107-21"></a><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 10 seconds.</span></span>
<span id="cb107-22"><a href="#cb107-22"></a><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span id="cb107-23"><a href="#cb107-23"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb107-24"><a href="#cb107-24"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb107-25"><a href="#cb107-25"></a><span class="co">#&gt; Chain 1: Iteration:   1 / 1000 [  0%]  (Warmup)</span></span>
<span id="cb107-26"><a href="#cb107-26"></a><span class="co">#&gt; Chain 1: Iteration: 100 / 1000 [ 10%]  (Warmup)</span></span>
<span id="cb107-27"><a href="#cb107-27"></a><span class="co">#&gt; Chain 1: Iteration: 200 / 1000 [ 20%]  (Warmup)</span></span>
<span id="cb107-28"><a href="#cb107-28"></a><span class="co">#&gt; Chain 1: Iteration: 300 / 1000 [ 30%]  (Warmup)</span></span>
<span id="cb107-29"><a href="#cb107-29"></a><span class="co">#&gt; Chain 1: Iteration: 400 / 1000 [ 40%]  (Warmup)</span></span>
<span id="cb107-30"><a href="#cb107-30"></a><span class="co">#&gt; Chain 1: Iteration: 500 / 1000 [ 50%]  (Warmup)</span></span>
<span id="cb107-31"><a href="#cb107-31"></a><span class="co">#&gt; Chain 1: Iteration: 501 / 1000 [ 50%]  (Sampling)</span></span>
<span id="cb107-32"><a href="#cb107-32"></a><span class="co">#&gt; Chain 1: Iteration: 600 / 1000 [ 60%]  (Sampling)</span></span>
<span id="cb107-33"><a href="#cb107-33"></a><span class="co">#&gt; Chain 1: Iteration: 700 / 1000 [ 70%]  (Sampling)</span></span>
<span id="cb107-34"><a href="#cb107-34"></a><span class="co">#&gt; Chain 1: Iteration: 800 / 1000 [ 80%]  (Sampling)</span></span>
<span id="cb107-35"><a href="#cb107-35"></a><span class="co">#&gt; Chain 1: Iteration: 900 / 1000 [ 90%]  (Sampling)</span></span>
<span id="cb107-36"><a href="#cb107-36"></a><span class="co">#&gt; Chain 1: Iteration: 1000 / 1000 [100%]  (Sampling)</span></span>
<span id="cb107-37"><a href="#cb107-37"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb107-38"><a href="#cb107-38"></a><span class="co">#&gt; Chain 1:  Elapsed Time: 1.112 seconds (Warm-up)</span></span>
<span id="cb107-39"><a href="#cb107-39"></a><span class="co">#&gt; Chain 1:                0.598 seconds (Sampling)</span></span>
<span id="cb107-40"><a href="#cb107-40"></a><span class="co">#&gt; Chain 1:                1.71 seconds (Total)</span></span>
<span id="cb107-41"><a href="#cb107-41"></a><span class="co">#&gt; Chain 1:</span></span>
<span id="cb107-42"><a href="#cb107-42"></a></span>
<span id="cb107-43"><a href="#cb107-43"></a><span class="co"># plot</span></span>
<span id="cb107-44"><a href="#cb107-44"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb107-45"><a href="#cb107-45"></a>  <span class="dt">x =</span> fit,</span>
<span id="cb107-46"><a href="#cb107-46"></a>  <span class="dt">title =</span> <span class="st">"Bayesian nonlinear models via Stan"</span></span>
<span id="cb107-47"><a href="#cb107-47"></a>)</span>
<span id="cb107-48"><a href="#cb107-48"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span>
<span id="cb107-49"><a href="#cb107-49"></a><span class="co">#&gt; Note: No p-values and/or statistic available for the model object;</span></span>
<span id="cb107-50"><a href="#cb107-50"></a><span class="co">#&gt; skipping labels with statistical details.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/nlstanreg-1.png" width="480"></p>
</div>
<div id="multivariate-generalized-linear-mixed-models-mcmcglmm" class="section level2">
<h2 class="hasAnchor">
<a href="#multivariate-generalized-linear-mixed-models-mcmcglmm" class="anchor"></a>multivariate generalized linear mixed models (<code>MCMCglmm</code>)</h2>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a><span class="co"># setup</span></span>
<span id="cb108-2"><a href="#cb108-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb108-3"><a href="#cb108-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(lme4)</span>
<span id="cb108-4"><a href="#cb108-4"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(MCMCglmm)</span>
<span id="cb108-5"><a href="#cb108-5"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(sleepstudy)</span>
<span id="cb108-6"><a href="#cb108-6"></a></span>
<span id="cb108-7"><a href="#cb108-7"></a><span class="co"># model</span></span>
<span id="cb108-8"><a href="#cb108-8"></a>mm0 &lt;-</span>
<span id="cb108-9"><a href="#cb108-9"></a><span class="st">  </span>MCMCglmm<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/MCMCglmm/man/MCMCglmm.html">MCMCglmm</a></span>(</span>
<span id="cb108-10"><a href="#cb108-10"></a>    <span class="dt">fixed =</span> <span class="kw"><a href="https://rdrr.io/r/base/scale.html">scale</a></span>(Reaction) <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/scale.html">scale</a></span>(Days),</span>
<span id="cb108-11"><a href="#cb108-11"></a>    <span class="dt">random =</span> <span class="op">~</span>Subject,</span>
<span id="cb108-12"><a href="#cb108-12"></a>    <span class="dt">data =</span> sleepstudy,</span>
<span id="cb108-13"><a href="#cb108-13"></a>    <span class="dt">nitt =</span> <span class="dv">4000</span>,</span>
<span id="cb108-14"><a href="#cb108-14"></a>    <span class="dt">pr =</span> <span class="ot">TRUE</span>,</span>
<span id="cb108-15"><a href="#cb108-15"></a>    <span class="dt">verbose =</span> <span class="ot">FALSE</span></span>
<span id="cb108-16"><a href="#cb108-16"></a>  )</span>
<span id="cb108-17"><a href="#cb108-17"></a></span>
<span id="cb108-18"><a href="#cb108-18"></a><span class="co"># plot</span></span>
<span id="cb108-19"><a href="#cb108-19"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb108-20"><a href="#cb108-20"></a>  <span class="dt">x =</span> mm0,</span>
<span id="cb108-21"><a href="#cb108-21"></a>  <span class="dt">title =</span> <span class="st">"multivariate generalized linear mixed model"</span>,</span>
<span id="cb108-22"><a href="#cb108-22"></a>  <span class="dt">conf.method =</span> <span class="st">"HPDinterval"</span>,</span>
<span id="cb108-23"><a href="#cb108-23"></a>  <span class="dt">exclude.intercept =</span> <span class="ot">FALSE</span>,</span>
<span id="cb108-24"><a href="#cb108-24"></a>  <span class="dt">robust =</span> <span class="ot">TRUE</span></span>
<span id="cb108-25"><a href="#cb108-25"></a>)</span>
<span id="cb108-26"><a href="#cb108-26"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span>
<span id="cb108-27"><a href="#cb108-27"></a><span class="co">#&gt; Note: No p-values and/or statistic available for the model object;</span></span>
<span id="cb108-28"><a href="#cb108-28"></a><span class="co">#&gt; skipping labels with statistical details.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/MCMCglmm-1.png" width="576"></p>
</div>
<div id="markov-chain-monte-carlo-objects-mcmc" class="section level2">
<h2 class="hasAnchor">
<a href="#markov-chain-monte-carlo-objects-mcmc" class="anchor"></a>Markov Chain Monte Carlo objects (<code>mcmc</code>)</h2>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a><span class="co"># loading the data</span></span>
<span id="cb109-2"><a href="#cb109-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb109-3"><a href="#cb109-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(coda)</span>
<span id="cb109-4"><a href="#cb109-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(line)</span>
<span id="cb109-5"><a href="#cb109-5"></a></span>
<span id="cb109-6"><a href="#cb109-6"></a><span class="co"># select first chain</span></span>
<span id="cb109-7"><a href="#cb109-7"></a>x1 &lt;-<span class="st"> </span>line[[<span class="dv">1</span>]]</span>
<span id="cb109-8"><a href="#cb109-8"></a></span>
<span id="cb109-9"><a href="#cb109-9"></a><span class="co"># plot</span></span>
<span id="cb109-10"><a href="#cb109-10"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb109-11"><a href="#cb109-11"></a>  <span class="dt">x =</span> x1,</span>
<span id="cb109-12"><a href="#cb109-12"></a>  <span class="dt">title =</span> <span class="st">"Markov Chain Monte Carlo objects"</span>,</span>
<span id="cb109-13"><a href="#cb109-13"></a>  <span class="dt">robust =</span> <span class="ot">TRUE</span>,</span>
<span id="cb109-14"><a href="#cb109-14"></a>  <span class="dt">ess =</span> <span class="ot">TRUE</span></span>
<span id="cb109-15"><a href="#cb109-15"></a>)</span>
<span id="cb109-16"><a href="#cb109-16"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span>
<span id="cb109-17"><a href="#cb109-17"></a><span class="co">#&gt; </span></span>
<span id="cb109-18"><a href="#cb109-18"></a><span class="co">#&gt; Could not extract p-values from model object.</span></span>
<span id="cb109-19"><a href="#cb109-19"></a><span class="co">#&gt; Note: No p-values and/or statistic available for the model object;</span></span>
<span id="cb109-20"><a href="#cb109-20"></a><span class="co">#&gt; skipping labels with statistical details.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/mcmc-1.png" width="480"></p>
</div>
<div id="mcmc-with-just-another-gibbs-sampler-rjags" class="section level2">
<h2 class="hasAnchor">
<a href="#mcmc-with-just-another-gibbs-sampler-rjags" class="anchor"></a>MCMC with Just Another Gibbs Sampler (<code>rjags</code>)</h2>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a><span class="co"># setup</span></span>
<span id="cb110-2"><a href="#cb110-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb110-3"><a href="#cb110-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(R2jags)</span>
<span id="cb110-4"><a href="#cb110-4"></a></span>
<span id="cb110-5"><a href="#cb110-5"></a><span class="co"># An example model file is given in:</span></span>
<span id="cb110-6"><a href="#cb110-6"></a>model.file &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="dt">package =</span> <span class="st">"R2jags"</span>, <span class="st">"model"</span>, <span class="st">"schools.txt"</span>)</span>
<span id="cb110-7"><a href="#cb110-7"></a></span>
<span id="cb110-8"><a href="#cb110-8"></a><span class="co"># data</span></span>
<span id="cb110-9"><a href="#cb110-9"></a>J &lt;-<span class="st"> </span><span class="fl">8.0</span></span>
<span id="cb110-10"><a href="#cb110-10"></a>y &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">28.4</span>, <span class="fl">7.9</span>, <span class="fl">-2.8</span>, <span class="fl">6.8</span>, <span class="fl">-0.6</span>, <span class="fl">0.6</span>, <span class="fl">18.0</span>, <span class="fl">12.2</span>)</span>
<span id="cb110-11"><a href="#cb110-11"></a>sd &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">14.9</span>, <span class="fl">10.2</span>, <span class="fl">16.3</span>, <span class="fl">11.0</span>, <span class="fl">9.4</span>, <span class="fl">11.4</span>, <span class="fl">10.4</span>, <span class="fl">17.6</span>)</span>
<span id="cb110-12"><a href="#cb110-12"></a></span>
<span id="cb110-13"><a href="#cb110-13"></a><span class="co"># setting up model</span></span>
<span id="cb110-14"><a href="#cb110-14"></a>jags.data &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"y"</span>, <span class="st">"sd"</span>, <span class="st">"J"</span>)</span>
<span id="cb110-15"><a href="#cb110-15"></a>jags.params &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"mu"</span>, <span class="st">"sigma"</span>, <span class="st">"theta"</span>)</span>
<span id="cb110-16"><a href="#cb110-16"></a>jags.inits &lt;-<span class="st"> </span><span class="cf">function</span>() {</span>
<span id="cb110-17"><a href="#cb110-17"></a>  <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"mu"</span> =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dv">1</span>), <span class="st">"sigma"</span> =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="dv">1</span>), <span class="st">"theta"</span> =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(J))</span>
<span id="cb110-18"><a href="#cb110-18"></a>}</span>
<span id="cb110-19"><a href="#cb110-19"></a></span>
<span id="cb110-20"><a href="#cb110-20"></a><span class="co"># model fitting</span></span>
<span id="cb110-21"><a href="#cb110-21"></a>jagsfit &lt;-</span>
<span id="cb110-22"><a href="#cb110-22"></a><span class="st">  </span>R2jags<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/R2jags/man/jags.html">jags</a></span>(</span>
<span id="cb110-23"><a href="#cb110-23"></a>    <span class="dt">data =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"y"</span>, <span class="st">"sd"</span>, <span class="st">"J"</span>),</span>
<span id="cb110-24"><a href="#cb110-24"></a>    <span class="dt">inits =</span> jags.inits,</span>
<span id="cb110-25"><a href="#cb110-25"></a>    jags.params,</span>
<span id="cb110-26"><a href="#cb110-26"></a>    <span class="dt">n.iter =</span> <span class="dv">10</span>,</span>
<span id="cb110-27"><a href="#cb110-27"></a>    <span class="dt">model.file =</span> model.file</span>
<span id="cb110-28"><a href="#cb110-28"></a>  )</span>
<span id="cb110-29"><a href="#cb110-29"></a><span class="co">#&gt; Compiling model graph</span></span>
<span id="cb110-30"><a href="#cb110-30"></a><span class="co">#&gt;    Resolving undeclared variables</span></span>
<span id="cb110-31"><a href="#cb110-31"></a><span class="co">#&gt;    Allocating nodes</span></span>
<span id="cb110-32"><a href="#cb110-32"></a><span class="co">#&gt; Graph information:</span></span>
<span id="cb110-33"><a href="#cb110-33"></a><span class="co">#&gt;    Observed stochastic nodes: 8</span></span>
<span id="cb110-34"><a href="#cb110-34"></a><span class="co">#&gt;    Unobserved stochastic nodes: 10</span></span>
<span id="cb110-35"><a href="#cb110-35"></a><span class="co">#&gt;    Total graph size: 41</span></span>
<span id="cb110-36"><a href="#cb110-36"></a><span class="co">#&gt; </span></span>
<span id="cb110-37"><a href="#cb110-37"></a><span class="co">#&gt; Initializing model</span></span>
<span id="cb110-38"><a href="#cb110-38"></a></span>
<span id="cb110-39"><a href="#cb110-39"></a><span class="co"># plot</span></span>
<span id="cb110-40"><a href="#cb110-40"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb110-41"><a href="#cb110-41"></a>  <span class="dt">x =</span> jagsfit,</span>
<span id="cb110-42"><a href="#cb110-42"></a>  <span class="dt">title =</span> <span class="st">"Markov Chain Monte Carlo with</span><span class="ch">\n</span><span class="st">Just Another Gibbs Sampler"</span>,</span>
<span id="cb110-43"><a href="#cb110-43"></a>  <span class="dt">point.color =</span> <span class="st">"darkgreen"</span></span>
<span id="cb110-44"><a href="#cb110-44"></a>)</span>
<span id="cb110-45"><a href="#cb110-45"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span>
<span id="cb110-46"><a href="#cb110-46"></a><span class="co">#&gt; </span></span>
<span id="cb110-47"><a href="#cb110-47"></a><span class="co">#&gt; Could not extract p-values from model object.</span></span>
<span id="cb110-48"><a href="#cb110-48"></a><span class="co">#&gt; Note: No p-values and/or statistic available for the model object;</span></span>
<span id="cb110-49"><a href="#cb110-49"></a><span class="co">#&gt; skipping labels with statistical details.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/R2jags-1.png" width="576"></p>
</div>
<div id="latent-variable-model-lavaan" class="section level2">
<h2 class="hasAnchor">
<a href="#latent-variable-model-lavaan" class="anchor"></a>latent variable model (<code>lavaan</code>)</h2>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a><span class="co"># setup</span></span>
<span id="cb111-2"><a href="#cb111-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb111-3"><a href="#cb111-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(lavaan)</span>
<span id="cb111-4"><a href="#cb111-4"></a></span>
<span id="cb111-5"><a href="#cb111-5"></a><span class="co"># The Holzinger and Swineford (1939) example</span></span>
<span id="cb111-6"><a href="#cb111-6"></a>HS.model &lt;-<span class="st"> " visual =~ x1 + x2 + x3</span></span>
<span id="cb111-7"><a href="#cb111-7"></a><span class="st">textual =~ x4 + x5 + x6</span></span>
<span id="cb111-8"><a href="#cb111-8"></a><span class="st">speed =~ x7 + x8 + x9 "</span></span>
<span id="cb111-9"><a href="#cb111-9"></a></span>
<span id="cb111-10"><a href="#cb111-10"></a><span class="co"># model</span></span>
<span id="cb111-11"><a href="#cb111-11"></a>fit &lt;-</span>
<span id="cb111-12"><a href="#cb111-12"></a><span class="st">  </span>lavaan<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/lavaan/man/lavaan.html">lavaan</a></span>(</span>
<span id="cb111-13"><a href="#cb111-13"></a>    HS.model,</span>
<span id="cb111-14"><a href="#cb111-14"></a>    <span class="dt">data =</span> HolzingerSwineford1939,</span>
<span id="cb111-15"><a href="#cb111-15"></a>    <span class="dt">auto.var =</span> <span class="ot">TRUE</span>,</span>
<span id="cb111-16"><a href="#cb111-16"></a>    <span class="dt">auto.fix.first =</span> <span class="ot">TRUE</span>,</span>
<span id="cb111-17"><a href="#cb111-17"></a>    <span class="dt">auto.cov.lv.x =</span> <span class="ot">TRUE</span></span>
<span id="cb111-18"><a href="#cb111-18"></a>  )</span>
<span id="cb111-19"><a href="#cb111-19"></a></span>
<span id="cb111-20"><a href="#cb111-20"></a><span class="co"># tidy</span></span>
<span id="cb111-21"><a href="#cb111-21"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb111-22"><a href="#cb111-22"></a>  <span class="dt">x =</span> fit,</span>
<span id="cb111-23"><a href="#cb111-23"></a>  <span class="dt">title =</span> <span class="st">"latent variable model"</span>,</span>
<span id="cb111-24"><a href="#cb111-24"></a>  <span class="dt">conf.level =</span> <span class="fl">0.99</span></span>
<span id="cb111-25"><a href="#cb111-25"></a>)</span>
<span id="cb111-26"><a href="#cb111-26"></a><span class="co">#&gt; Warning:  No. of factor levels is greater than default palette color count.</span></span>
<span id="cb111-27"><a href="#cb111-27"></a><span class="co">#&gt;  Try using another color `palette` (and/or `package`).</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/lavaan-1.png" width="576"></p>
</div>
<div id="bayesian-latent-variable-model-blavaan" class="section level2">
<h2 class="hasAnchor">
<a href="#bayesian-latent-variable-model-blavaan" class="anchor"></a>Bayesian latent variable model (<code>blavaan</code>)</h2>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a><span class="co"># setup</span></span>
<span id="cb112-2"><a href="#cb112-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb112-3"><a href="#cb112-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(blavaan)</span>
<span id="cb112-4"><a href="#cb112-4"></a>future<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/future/man/plan.html">plan</a></span>(<span class="st">"multiprocess"</span>)</span>
<span id="cb112-5"><a href="#cb112-5"></a></span>
<span id="cb112-6"><a href="#cb112-6"></a><span class="co"># The Holzinger and Swineford (1939) example</span></span>
<span id="cb112-7"><a href="#cb112-7"></a>HS.model &lt;-<span class="st"> " visual =~ x1 + x2 + x3</span></span>
<span id="cb112-8"><a href="#cb112-8"></a><span class="st">textual =~ x4 + x5 + x6</span></span>
<span id="cb112-9"><a href="#cb112-9"></a><span class="st">speed =~ x7 + x8 + x9 "</span></span>
<span id="cb112-10"><a href="#cb112-10"></a></span>
<span id="cb112-11"><a href="#cb112-11"></a><span class="co"># model</span></span>
<span id="cb112-12"><a href="#cb112-12"></a>fit &lt;-</span>
<span id="cb112-13"><a href="#cb112-13"></a><span class="st">  </span>blavaan<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/blavaan/man/blavaan.html">blavaan</a></span>(</span>
<span id="cb112-14"><a href="#cb112-14"></a>    HS.model,</span>
<span id="cb112-15"><a href="#cb112-15"></a>    <span class="dt">data =</span> HolzingerSwineford1939,</span>
<span id="cb112-16"><a href="#cb112-16"></a>    <span class="dt">auto.var =</span> <span class="ot">TRUE</span>,</span>
<span id="cb112-17"><a href="#cb112-17"></a>    <span class="dt">auto.fix.first =</span> <span class="ot">TRUE</span>,</span>
<span id="cb112-18"><a href="#cb112-18"></a>    <span class="dt">auto.cov.lv.x =</span> <span class="ot">TRUE</span></span>
<span id="cb112-19"><a href="#cb112-19"></a>  )</span>
<span id="cb112-20"><a href="#cb112-20"></a><span class="co">#&gt; </span></span>
<span id="cb112-21"><a href="#cb112-21"></a><span class="co">#&gt; SAMPLING FOR MODEL 'stanmarg' NOW (CHAIN 1).</span></span>
<span id="cb112-22"><a href="#cb112-22"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb112-23"><a href="#cb112-23"></a><span class="co">#&gt; Chain 1: Gradient evaluation took 0.003 seconds</span></span>
<span id="cb112-24"><a href="#cb112-24"></a><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 30 seconds.</span></span>
<span id="cb112-25"><a href="#cb112-25"></a><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span id="cb112-26"><a href="#cb112-26"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb112-27"><a href="#cb112-27"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb112-28"><a href="#cb112-28"></a><span class="co">#&gt; Chain 1: Iteration:    1 / 1500 [  0%]  (Warmup)</span></span>
<span id="cb112-29"><a href="#cb112-29"></a><span class="co">#&gt; Chain 1: Iteration:  150 / 1500 [ 10%]  (Warmup)</span></span>
<span id="cb112-30"><a href="#cb112-30"></a><span class="co">#&gt; Chain 1: Iteration:  300 / 1500 [ 20%]  (Warmup)</span></span>
<span id="cb112-31"><a href="#cb112-31"></a><span class="co">#&gt; Chain 1: Iteration:  450 / 1500 [ 30%]  (Warmup)</span></span>
<span id="cb112-32"><a href="#cb112-32"></a><span class="co">#&gt; Chain 1: Iteration:  501 / 1500 [ 33%]  (Sampling)</span></span>
<span id="cb112-33"><a href="#cb112-33"></a><span class="co">#&gt; Chain 1: Iteration:  650 / 1500 [ 43%]  (Sampling)</span></span>
<span id="cb112-34"><a href="#cb112-34"></a><span class="co">#&gt; Chain 1: Iteration:  800 / 1500 [ 53%]  (Sampling)</span></span>
<span id="cb112-35"><a href="#cb112-35"></a><span class="co">#&gt; Chain 1: Iteration:  950 / 1500 [ 63%]  (Sampling)</span></span>
<span id="cb112-36"><a href="#cb112-36"></a><span class="co">#&gt; Chain 1: Iteration: 1100 / 1500 [ 73%]  (Sampling)</span></span>
<span id="cb112-37"><a href="#cb112-37"></a><span class="co">#&gt; Chain 1: Iteration: 1250 / 1500 [ 83%]  (Sampling)</span></span>
<span id="cb112-38"><a href="#cb112-38"></a><span class="co">#&gt; Chain 1: Iteration: 1400 / 1500 [ 93%]  (Sampling)</span></span>
<span id="cb112-39"><a href="#cb112-39"></a><span class="co">#&gt; Chain 1: Iteration: 1500 / 1500 [100%]  (Sampling)</span></span>
<span id="cb112-40"><a href="#cb112-40"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb112-41"><a href="#cb112-41"></a><span class="co">#&gt; Chain 1:  Elapsed Time: 14.835 seconds (Warm-up)</span></span>
<span id="cb112-42"><a href="#cb112-42"></a><span class="co">#&gt; Chain 1:                25.409 seconds (Sampling)</span></span>
<span id="cb112-43"><a href="#cb112-43"></a><span class="co">#&gt; Chain 1:                40.244 seconds (Total)</span></span>
<span id="cb112-44"><a href="#cb112-44"></a><span class="co">#&gt; Chain 1: </span></span>
<span id="cb112-45"><a href="#cb112-45"></a><span class="co">#&gt; </span></span>
<span id="cb112-46"><a href="#cb112-46"></a><span class="co">#&gt; SAMPLING FOR MODEL 'stanmarg' NOW (CHAIN 2).</span></span>
<span id="cb112-47"><a href="#cb112-47"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb112-48"><a href="#cb112-48"></a><span class="co">#&gt; Chain 2: Gradient evaluation took 0 seconds</span></span>
<span id="cb112-49"><a href="#cb112-49"></a><span class="co">#&gt; Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.</span></span>
<span id="cb112-50"><a href="#cb112-50"></a><span class="co">#&gt; Chain 2: Adjust your expectations accordingly!</span></span>
<span id="cb112-51"><a href="#cb112-51"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb112-52"><a href="#cb112-52"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb112-53"><a href="#cb112-53"></a><span class="co">#&gt; Chain 2: Iteration:    1 / 1500 [  0%]  (Warmup)</span></span>
<span id="cb112-54"><a href="#cb112-54"></a><span class="co">#&gt; Chain 2: Iteration:  150 / 1500 [ 10%]  (Warmup)</span></span>
<span id="cb112-55"><a href="#cb112-55"></a><span class="co">#&gt; Chain 2: Iteration:  300 / 1500 [ 20%]  (Warmup)</span></span>
<span id="cb112-56"><a href="#cb112-56"></a><span class="co">#&gt; Chain 2: Iteration:  450 / 1500 [ 30%]  (Warmup)</span></span>
<span id="cb112-57"><a href="#cb112-57"></a><span class="co">#&gt; Chain 2: Iteration:  501 / 1500 [ 33%]  (Sampling)</span></span>
<span id="cb112-58"><a href="#cb112-58"></a><span class="co">#&gt; Chain 2: Iteration:  650 / 1500 [ 43%]  (Sampling)</span></span>
<span id="cb112-59"><a href="#cb112-59"></a><span class="co">#&gt; Chain 2: Iteration:  800 / 1500 [ 53%]  (Sampling)</span></span>
<span id="cb112-60"><a href="#cb112-60"></a><span class="co">#&gt; Chain 2: Iteration:  950 / 1500 [ 63%]  (Sampling)</span></span>
<span id="cb112-61"><a href="#cb112-61"></a><span class="co">#&gt; Chain 2: Iteration: 1100 / 1500 [ 73%]  (Sampling)</span></span>
<span id="cb112-62"><a href="#cb112-62"></a><span class="co">#&gt; Chain 2: Iteration: 1250 / 1500 [ 83%]  (Sampling)</span></span>
<span id="cb112-63"><a href="#cb112-63"></a><span class="co">#&gt; Chain 2: Iteration: 1400 / 1500 [ 93%]  (Sampling)</span></span>
<span id="cb112-64"><a href="#cb112-64"></a><span class="co">#&gt; Chain 2: Iteration: 1500 / 1500 [100%]  (Sampling)</span></span>
<span id="cb112-65"><a href="#cb112-65"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb112-66"><a href="#cb112-66"></a><span class="co">#&gt; Chain 2:  Elapsed Time: 16.309 seconds (Warm-up)</span></span>
<span id="cb112-67"><a href="#cb112-67"></a><span class="co">#&gt; Chain 2:                27.564 seconds (Sampling)</span></span>
<span id="cb112-68"><a href="#cb112-68"></a><span class="co">#&gt; Chain 2:                43.873 seconds (Total)</span></span>
<span id="cb112-69"><a href="#cb112-69"></a><span class="co">#&gt; Chain 2: </span></span>
<span id="cb112-70"><a href="#cb112-70"></a><span class="co">#&gt; </span></span>
<span id="cb112-71"><a href="#cb112-71"></a><span class="co">#&gt; SAMPLING FOR MODEL 'stanmarg' NOW (CHAIN 3).</span></span>
<span id="cb112-72"><a href="#cb112-72"></a><span class="co">#&gt; Chain 3: </span></span>
<span id="cb112-73"><a href="#cb112-73"></a><span class="co">#&gt; Chain 3: Gradient evaluation took 0 seconds</span></span>
<span id="cb112-74"><a href="#cb112-74"></a><span class="co">#&gt; Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.</span></span>
<span id="cb112-75"><a href="#cb112-75"></a><span class="co">#&gt; Chain 3: Adjust your expectations accordingly!</span></span>
<span id="cb112-76"><a href="#cb112-76"></a><span class="co">#&gt; Chain 3: </span></span>
<span id="cb112-77"><a href="#cb112-77"></a><span class="co">#&gt; Chain 3: </span></span>
<span id="cb112-78"><a href="#cb112-78"></a><span class="co">#&gt; Chain 3: Iteration:    1 / 1500 [  0%]  (Warmup)</span></span>
<span id="cb112-79"><a href="#cb112-79"></a><span class="co">#&gt; Chain 3: Iteration:  150 / 1500 [ 10%]  (Warmup)</span></span>
<span id="cb112-80"><a href="#cb112-80"></a><span class="co">#&gt; Chain 3: Iteration:  300 / 1500 [ 20%]  (Warmup)</span></span>
<span id="cb112-81"><a href="#cb112-81"></a><span class="co">#&gt; Chain 3: Iteration:  450 / 1500 [ 30%]  (Warmup)</span></span>
<span id="cb112-82"><a href="#cb112-82"></a><span class="co">#&gt; Chain 3: Iteration:  501 / 1500 [ 33%]  (Sampling)</span></span>
<span id="cb112-83"><a href="#cb112-83"></a><span class="co">#&gt; Chain 3: Iteration:  650 / 1500 [ 43%]  (Sampling)</span></span>
<span id="cb112-84"><a href="#cb112-84"></a><span class="co">#&gt; Chain 3: Iteration:  800 / 1500 [ 53%]  (Sampling)</span></span>
<span id="cb112-85"><a href="#cb112-85"></a><span class="co">#&gt; Chain 3: Iteration:  950 / 1500 [ 63%]  (Sampling)</span></span>
<span id="cb112-86"><a href="#cb112-86"></a><span class="co">#&gt; Chain 3: Iteration: 1100 / 1500 [ 73%]  (Sampling)</span></span>
<span id="cb112-87"><a href="#cb112-87"></a><span class="co">#&gt; Chain 3: Iteration: 1250 / 1500 [ 83%]  (Sampling)</span></span>
<span id="cb112-88"><a href="#cb112-88"></a><span class="co">#&gt; Chain 3: Iteration: 1400 / 1500 [ 93%]  (Sampling)</span></span>
<span id="cb112-89"><a href="#cb112-89"></a><span class="co">#&gt; Chain 3: Iteration: 1500 / 1500 [100%]  (Sampling)</span></span>
<span id="cb112-90"><a href="#cb112-90"></a><span class="co">#&gt; Chain 3: </span></span>
<span id="cb112-91"><a href="#cb112-91"></a><span class="co">#&gt; Chain 3:  Elapsed Time: 24.173 seconds (Warm-up)</span></span>
<span id="cb112-92"><a href="#cb112-92"></a><span class="co">#&gt; Chain 3:                40.839 seconds (Sampling)</span></span>
<span id="cb112-93"><a href="#cb112-93"></a><span class="co">#&gt; Chain 3:                65.012 seconds (Total)</span></span>
<span id="cb112-94"><a href="#cb112-94"></a><span class="co">#&gt; Chain 3: </span></span>
<span id="cb112-95"><a href="#cb112-95"></a><span class="co">#&gt; Computing posterior predictives...</span></span>
<span id="cb112-96"><a href="#cb112-96"></a></span>
<span id="cb112-97"><a href="#cb112-97"></a><span class="co"># tidy</span></span>
<span id="cb112-98"><a href="#cb112-98"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb112-99"><a href="#cb112-99"></a>  <span class="dt">x =</span> fit,</span>
<span id="cb112-100"><a href="#cb112-100"></a>  <span class="dt">title =</span> <span class="st">"Bayesian latent variable model"</span></span>
<span id="cb112-101"><a href="#cb112-101"></a>)</span>
<span id="cb112-102"><a href="#cb112-102"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span>
<span id="cb112-103"><a href="#cb112-103"></a><span class="co">#&gt; </span></span>
<span id="cb112-104"><a href="#cb112-104"></a><span class="co">#&gt; Could not extract p-values from model object.</span></span>
<span id="cb112-105"><a href="#cb112-105"></a><span class="co">#&gt; Note: No p-values and/or statistic available for the model object;</span></span>
<span id="cb112-106"><a href="#cb112-106"></a><span class="co">#&gt; skipping labels with statistical details.</span></span>
<span id="cb112-107"><a href="#cb112-107"></a><span class="co">#&gt; Note: No confidence intervals available for regression coefficientsobject, so skipping whiskers in the plot.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/blavaan-1.png" width="576"></p>
</div>
<div id="regression-models-with-list-outputs" class="section level2">
<h2 class="hasAnchor">
<a href="#regression-models-with-list-outputs" class="anchor"></a>regression models with <code>list</code> outputs</h2>
<p>Note that a number of regression models will return an object of class <code>list</code>, in which case this function will fail. But often you can extract the object of interest from this list and use it to plot the regression coefficients.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a><span class="co"># setup</span></span>
<span id="cb113-2"><a href="#cb113-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(gamm4)</span>
<span id="cb113-3"><a href="#cb113-3"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb113-4"><a href="#cb113-4"></a></span>
<span id="cb113-5"><a href="#cb113-5"></a><span class="co"># data</span></span>
<span id="cb113-6"><a href="#cb113-6"></a>dat &lt;-<span class="st"> </span><span class="kw">gamSim</span>(<span class="dv">1</span>, <span class="dt">n =</span> <span class="dv">400</span>, <span class="dt">scale =</span> <span class="dv">2</span>)</span>
<span id="cb113-7"><a href="#cb113-7"></a><span class="co">#&gt; Gu &amp; Wahba 4 term additive model</span></span>
<span id="cb113-8"><a href="#cb113-8"></a></span>
<span id="cb113-9"><a href="#cb113-9"></a><span class="co"># now add 20 level random effect `fac'...</span></span>
<span id="cb113-10"><a href="#cb113-10"></a>dat<span class="op">$</span>fac &lt;-<span class="st"> </span>fac &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>, <span class="dv">400</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>))</span>
<span id="cb113-11"><a href="#cb113-11"></a>dat<span class="op">$</span>y &lt;-<span class="st"> </span>dat<span class="op">$</span>y <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span>(<span class="op">~</span><span class="st"> </span>fac <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%*%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dv">20</span>) <span class="op">*</span><span class="st"> </span><span class="fl">.5</span></span>
<span id="cb113-12"><a href="#cb113-12"></a></span>
<span id="cb113-13"><a href="#cb113-13"></a><span class="co"># model object</span></span>
<span id="cb113-14"><a href="#cb113-14"></a>br &lt;-</span>
<span id="cb113-15"><a href="#cb113-15"></a><span class="st">  </span>gamm4<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/gamm4/man/gamm4.html">gamm4</a></span>(</span>
<span id="cb113-16"><a href="#cb113-16"></a>    <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(x0) <span class="op">+</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span><span class="kw">s</span>(x2),</span>
<span id="cb113-17"><a href="#cb113-17"></a>    <span class="dt">data =</span> dat,</span>
<span id="cb113-18"><a href="#cb113-18"></a>    <span class="dt">random =</span> <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>fac)</span>
<span id="cb113-19"><a href="#cb113-19"></a>  )</span>
<span id="cb113-20"><a href="#cb113-20"></a></span>
<span id="cb113-21"><a href="#cb113-21"></a><span class="co"># looking at the classes of the objects contained in the list</span></span>
<span id="cb113-22"><a href="#cb113-22"></a>purrr<span class="op">::</span><span class="kw"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span>(br, class)</span>
<span id="cb113-23"><a href="#cb113-23"></a><span class="co">#&gt; $mer</span></span>
<span id="cb113-24"><a href="#cb113-24"></a><span class="co">#&gt; [1] "lmerMod"</span></span>
<span id="cb113-25"><a href="#cb113-25"></a><span class="co">#&gt; attr(,"package")</span></span>
<span id="cb113-26"><a href="#cb113-26"></a><span class="co">#&gt; [1] "lme4"</span></span>
<span id="cb113-27"><a href="#cb113-27"></a><span class="co">#&gt; </span></span>
<span id="cb113-28"><a href="#cb113-28"></a><span class="co">#&gt; $gam</span></span>
<span id="cb113-29"><a href="#cb113-29"></a><span class="co">#&gt; [1] "gam"</span></span>
<span id="cb113-30"><a href="#cb113-30"></a></span>
<span id="cb113-31"><a href="#cb113-31"></a><span class="co"># plotting</span></span>
<span id="cb113-32"><a href="#cb113-32"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/combine_plots.html">combine_plots</a></span>(</span>
<span id="cb113-33"><a href="#cb113-33"></a>  <span class="co"># first object plot (only parametric terms are shown)</span></span>
<span id="cb113-34"><a href="#cb113-34"></a>  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb113-35"><a href="#cb113-35"></a>    <span class="dt">x =</span> br<span class="op">$</span>gam,</span>
<span id="cb113-36"><a href="#cb113-36"></a>    <span class="dt">exclude.intercept =</span> <span class="ot">FALSE</span>,</span>
<span id="cb113-37"><a href="#cb113-37"></a>    <span class="dt">title =</span> <span class="st">"generalized additive model (parametric terms)"</span>,</span>
<span id="cb113-38"><a href="#cb113-38"></a>    <span class="dt">k =</span> <span class="dv">3</span></span>
<span id="cb113-39"><a href="#cb113-39"></a>  ),</span>
<span id="cb113-40"><a href="#cb113-40"></a>  <span class="co"># second object plot</span></span>
<span id="cb113-41"><a href="#cb113-41"></a>  ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb113-42"><a href="#cb113-42"></a>    <span class="dt">x =</span> br<span class="op">$</span>mer,</span>
<span id="cb113-43"><a href="#cb113-43"></a>    <span class="dt">exclude.intercept =</span> <span class="ot">FALSE</span>,</span>
<span id="cb113-44"><a href="#cb113-44"></a>    <span class="dt">title =</span> <span class="st">"linear mixed-effects model"</span>,</span>
<span id="cb113-45"><a href="#cb113-45"></a>    <span class="dt">k =</span> <span class="dv">3</span></span>
<span id="cb113-46"><a href="#cb113-46"></a>  ),</span>
<span id="cb113-47"><a href="#cb113-47"></a>  <span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"(a)"</span>, <span class="st">"(b)"</span>),</span>
<span id="cb113-48"><a href="#cb113-48"></a>  <span class="dt">nrow =</span> <span class="dv">1</span></span>
<span id="cb113-49"><a href="#cb113-49"></a>)</span>
<span id="cb113-50"><a href="#cb113-50"></a><span class="co">#&gt; Note: No model diagnostics information available, so skipping caption.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/list_gamm4-1.png" width="960"></p>
</div>
<div id="dataframes-tbl_df-tbl-data-frame" class="section level2">
<h2 class="hasAnchor">
<a href="#dataframes-tbl_df-tbl-data-frame" class="anchor"></a>dataframes (<code>tbl_df</code>, <code>tbl</code>, <code>data.frame</code>)</h2>
<p>Sometimes you don’t have a model object but a custom dataframe that you want display using this function. If a data frame is to be plotted, it <strong>must</strong> contain columns named <code>term</code> (names of predictors), and <code>estimate</code> (corresponding estimates of coefficients or other quantities of interest). Other optional columns are <code>conf.low</code> and <code>conf.high</code> (for confidence intervals), and <code>p.value</code>. You will also have to specify the type of statistic relevant for regression models (<code>"t"</code>, <code>"z"</code>, <code>"f"</code>) in case you want to display statistical labels.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1"></a><span class="co"># set up</span></span>
<span id="cb114-2"><a href="#cb114-2"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</span>
<span id="cb114-3"><a href="#cb114-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggstatsplot)</span>
<span id="cb114-4"><a href="#cb114-4"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(gapminder)</span>
<span id="cb114-5"><a href="#cb114-5"></a></span>
<span id="cb114-6"><a href="#cb114-6"></a><span class="co"># data for running regression models</span></span>
<span id="cb114-7"><a href="#cb114-7"></a>df &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="dt">.data =</span> gapminder<span class="op">::</span>gapminder, continent <span class="op">!=</span><span class="st"> "Oceania"</span>)</span>
<span id="cb114-8"><a href="#cb114-8"></a></span>
<span id="cb114-9"><a href="#cb114-9"></a><span class="co"># saving results from regression</span></span>
<span id="cb114-10"><a href="#cb114-10"></a>df_results &lt;-</span>
<span id="cb114-11"><a href="#cb114-11"></a><span class="st">  </span>purrr<span class="op">::</span><span class="kw"><a href="https://purrr.tidyverse.org/reference/map2.html">pmap</a></span>(</span>
<span id="cb114-12"><a href="#cb114-12"></a>    <span class="dt">.l =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</span>
<span id="cb114-13"><a href="#cb114-13"></a>      <span class="dt">data =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(df),</span>
<span id="cb114-14"><a href="#cb114-14"></a>      <span class="dt">formula =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/scale.html">scale</a></span>(lifeExp) <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/scale.html">scale</a></span>(gdpPercap) <span class="op">+</span><span class="st"> </span>(gdpPercap <span class="op">|</span><span class="st"> </span>country)),</span>
<span id="cb114-15"><a href="#cb114-15"></a>      <span class="dt">grouping.vars =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">alist</a></span>(continent),</span>
<span id="cb114-16"><a href="#cb114-16"></a>      <span class="dt">output =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"tidy"</span>, <span class="st">"glance"</span>)</span>
<span id="cb114-17"><a href="#cb114-17"></a>    ),</span>
<span id="cb114-18"><a href="#cb114-18"></a>    <span class="dt">.f =</span> groupedstats<span class="op">::</span>grouped_lmer</span>
<span id="cb114-19"><a href="#cb114-19"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb114-20"><a href="#cb114-20"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">full_join</a></span>(<span class="dt">x =</span> .[[<span class="dv">1</span>]], <span class="dt">y =</span> .[[<span class="dv">2</span>]], <span class="dt">by =</span> <span class="st">"continent"</span>)</span>
<span id="cb114-21"><a href="#cb114-21"></a></span>
<span id="cb114-22"><a href="#cb114-22"></a><span class="co"># modifying the results so to be compatible with the `ggcoefstats` requirement</span></span>
<span id="cb114-23"><a href="#cb114-23"></a>(df_results <span class="op">%&lt;&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="dt">.data =</span> ., term <span class="op">!=</span><span class="st"> "(Intercept)"</span>))</span>
<span id="cb114-24"><a href="#cb114-24"></a><span class="co">#&gt; # A tibble: 4 x 16</span></span>
<span id="cb114-25"><a href="#cb114-25"></a><span class="co">#&gt;   continent effect term  estimate std.error statistic conf.low conf.high</span></span>
<span id="cb114-26"><a href="#cb114-26"></a><span class="co">#&gt;   &lt;fct&gt;     &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb114-27"><a href="#cb114-27"></a><span class="co">#&gt; 1 Africa    fixed  scal~     1.67     0.424      3.94    0.840      2.50</span></span>
<span id="cb114-28"><a href="#cb114-28"></a><span class="co">#&gt; 2 Americas  fixed  scal~     2.04     0.318      6.43    1.42       2.67</span></span>
<span id="cb114-29"><a href="#cb114-29"></a><span class="co">#&gt; 3 Asia      fixed  scal~     7.78     1.54       5.05    4.76      10.8 </span></span>
<span id="cb114-30"><a href="#cb114-30"></a><span class="co">#&gt; 4 Europe    fixed  scal~     1.59     0.376      4.22    0.851      2.33</span></span>
<span id="cb114-31"><a href="#cb114-31"></a><span class="co">#&gt; # ... with 8 more variables: p.value &lt;dbl&gt;, significance &lt;chr&gt;, sigma &lt;dbl&gt;,</span></span>
<span id="cb114-32"><a href="#cb114-32"></a><span class="co">#&gt; #   logLik &lt;dbl&gt;, AIC &lt;dbl&gt;, BIC &lt;dbl&gt;, REMLcrit &lt;dbl&gt;, df.residual &lt;int&gt;</span></span>
<span id="cb114-33"><a href="#cb114-33"></a></span>
<span id="cb114-34"><a href="#cb114-34"></a><span class="co"># plot</span></span>
<span id="cb114-35"><a href="#cb114-35"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb114-36"><a href="#cb114-36"></a>  <span class="dt">x =</span> df_results,</span>
<span id="cb114-37"><a href="#cb114-37"></a>  <span class="dt">statistic =</span> <span class="st">"t"</span>,</span>
<span id="cb114-38"><a href="#cb114-38"></a>  <span class="dt">sort =</span> <span class="st">"ascending"</span>,</span>
<span id="cb114-39"><a href="#cb114-39"></a>  <span class="dt">title =</span> <span class="st">"Relationship between life expectancy and GDP"</span>,</span>
<span id="cb114-40"><a href="#cb114-40"></a>  <span class="dt">subtitle =</span> <span class="st">"Source: Gapminder foundation"</span>,</span>
<span id="cb114-41"><a href="#cb114-41"></a>  <span class="dt">caption =</span> <span class="st">"Data from Oceania continent not included"</span></span>
<span id="cb114-42"><a href="#cb114-42"></a>)</span>
<span id="cb114-43"><a href="#cb114-43"></a><span class="co">#&gt; Error: All elements in the column `term` should be unique.</span></span></code></pre></div>
</div>
<div id="meta-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#meta-analysis" class="anchor"></a>meta-analysis</h2>
<p>In case the estimates you are displaying come from multiple studies, you can also use this function to carry out random-effects meta-analysis (as implemented in the <a href="http://www.metafor-project.org/doku.php">metafor</a> package; see <code><a href="https://rdrr.io/pkg/metafor/man/rma.uni.html">metafor::rma()</a></code>).</p>
<p>The dataframe you enter <strong>must</strong> contain at the minimum the following three columns- <code>term</code>, <code>estimate</code>, <code>std.error</code>.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a><span class="co"># let's make up a dataframe (with minimum amount of details)</span></span>
<span id="cb115-2"><a href="#cb115-2"></a>df_min &lt;-</span>
<span id="cb115-3"><a href="#cb115-3"></a><span class="st">  </span>tibble<span class="op">::</span><span class="kw"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span>(</span>
<span id="cb115-4"><a href="#cb115-4"></a>    <span class="op">~</span>term, <span class="op">~</span>estimate, <span class="op">~</span>std.error,</span>
<span id="cb115-5"><a href="#cb115-5"></a>    <span class="st">"study1"</span>, <span class="fl">0.0665</span>, <span class="fl">0.778</span>,</span>
<span id="cb115-6"><a href="#cb115-6"></a>    <span class="st">"study2"</span>, <span class="fl">0.542</span>, <span class="fl">0.280</span>,</span>
<span id="cb115-7"><a href="#cb115-7"></a>    <span class="st">"study3"</span>, <span class="fl">0.045</span>, <span class="fl">0.030</span>,</span>
<span id="cb115-8"><a href="#cb115-8"></a>    <span class="st">"study4"</span>, <span class="fl">0.500</span>, <span class="fl">0.708</span>,</span>
<span id="cb115-9"><a href="#cb115-9"></a>    <span class="st">"study5"</span>, <span class="fl">0.032</span>, <span class="fl">0.280</span>,</span>
<span id="cb115-10"><a href="#cb115-10"></a>    <span class="st">"study6"</span>, <span class="fl">0.085</span>, <span class="fl">0.030</span></span>
<span id="cb115-11"><a href="#cb115-11"></a>  )</span>
<span id="cb115-12"><a href="#cb115-12"></a></span>
<span id="cb115-13"><a href="#cb115-13"></a><span class="co"># plot</span></span>
<span id="cb115-14"><a href="#cb115-14"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb115-15"><a href="#cb115-15"></a>  <span class="dt">x =</span> df_min,</span>
<span id="cb115-16"><a href="#cb115-16"></a>  <span class="dt">meta.analytic.effect =</span> <span class="ot">TRUE</span>,</span>
<span id="cb115-17"><a href="#cb115-17"></a>  <span class="dt">point.color =</span> <span class="st">"red"</span>,</span>
<span id="cb115-18"><a href="#cb115-18"></a>  <span class="dt">title =</span> <span class="st">"random-effects meta-analysis"</span></span>
<span id="cb115-19"><a href="#cb115-19"></a>)</span>
<span id="cb115-20"><a href="#cb115-20"></a><span class="co">#&gt; Note: For the object of classtbl_df, the argument `statistic` must be specified ('t', 'z', or 'f').</span></span>
<span id="cb115-21"><a href="#cb115-21"></a><span class="co">#&gt; Statistical labels will therefore be skipped.</span></span>
<span id="cb115-22"><a href="#cb115-22"></a><span class="co">#&gt; Note: No p-values and/or statistic available for the model object;</span></span>
<span id="cb115-23"><a href="#cb115-23"></a><span class="co">#&gt; skipping labels with statistical details.</span></span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/meta1-1.png" width="576"></p>
<p>Or you can also provide a dataframe containing all the other relevant information for additionally displaying labels with statistical information.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1"></a><span class="co"># let's make up a dataframe (with all available details)</span></span>
<span id="cb116-2"><a href="#cb116-2"></a>df_full &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span>(</span>
<span id="cb116-3"><a href="#cb116-3"></a>  <span class="op">~</span>term, <span class="op">~</span>statistic, <span class="op">~</span>estimate, <span class="op">~</span>std.error, <span class="op">~</span>p.value, <span class="op">~</span>df.residual,</span>
<span id="cb116-4"><a href="#cb116-4"></a>  <span class="st">"study1"</span>, <span class="fl">0.158</span>, <span class="fl">0.0665</span>, <span class="fl">0.778</span>, <span class="fl">0.875</span>, 5L,</span>
<span id="cb116-5"><a href="#cb116-5"></a>  <span class="st">"study2"</span>, <span class="fl">1.33</span>, <span class="fl">0.542</span>, <span class="fl">0.280</span>, <span class="fl">0.191</span>, 10L,</span>
<span id="cb116-6"><a href="#cb116-6"></a>  <span class="st">"study3"</span>, <span class="fl">1.24</span>, <span class="fl">0.045</span>, <span class="fl">0.030</span>, <span class="fl">0.001</span>, 12L,</span>
<span id="cb116-7"><a href="#cb116-7"></a>  <span class="st">"study4"</span>, <span class="fl">0.156</span>, <span class="fl">0.500</span>, <span class="fl">0.708</span>, <span class="fl">0.885</span>, 8L,</span>
<span id="cb116-8"><a href="#cb116-8"></a>  <span class="st">"study5"</span>, <span class="fl">0.33</span>, <span class="fl">0.032</span>, <span class="fl">0.280</span>, <span class="fl">0.101</span>, 2L,</span>
<span id="cb116-9"><a href="#cb116-9"></a>  <span class="st">"study6"</span>, <span class="fl">1.04</span>, <span class="fl">0.085</span>, <span class="fl">0.030</span>, <span class="fl">0.001</span>, 3L</span>
<span id="cb116-10"><a href="#cb116-10"></a>)</span>
<span id="cb116-11"><a href="#cb116-11"></a></span>
<span id="cb116-12"><a href="#cb116-12"></a><span class="co"># plot</span></span>
<span id="cb116-13"><a href="#cb116-13"></a>ggstatsplot<span class="op">::</span><span class="kw"><a href="https://indrajeetpatil.github.io/ggstatsplot//reference/ggcoefstats.html">ggcoefstats</a></span>(</span>
<span id="cb116-14"><a href="#cb116-14"></a>  <span class="dt">x =</span> df_full,</span>
<span id="cb116-15"><a href="#cb116-15"></a>  <span class="dt">meta.analytic.effect =</span> <span class="ot">TRUE</span>,</span>
<span id="cb116-16"><a href="#cb116-16"></a>  <span class="dt">statistic =</span> <span class="st">"t"</span>,</span>
<span id="cb116-17"><a href="#cb116-17"></a>  <span class="dt">package =</span> <span class="st">"LaCroixColoR"</span>,</span>
<span id="cb116-18"><a href="#cb116-18"></a>  <span class="dt">palette =</span> <span class="st">"paired"</span></span>
<span id="cb116-19"><a href="#cb116-19"></a>)</span></code></pre></div>
<p><img src="ggcoefstats_files/figure-html/meta2-1.png" width="672"></p>
</div>
<div id="and-much-more" class="section level2">
<h2 class="hasAnchor">
<a href="#and-much-more" class="anchor"></a>And much more…</h2>
<p>This vignette was supposed to give a comprehensive account of regression models supported by <code>ggcoefstats</code>. The list of supported models will keep expanding as additional tidiers are added to the <code>broom</code> and <code>broom.mixed</code> package: <a href="https://broom.tidyverse.org/articles/available-methods.html" class="uri">https://broom.tidyverse.org/articles/available-methods.html</a></p>
<p>Note that not <strong>all</strong> models supported by <code>broom</code> will be supported by <code>ggcoefstats</code>. In particular, classes of objects for which there is no column for <code>estimate</code> (e.g., <code>kmeans</code>, <code>optim</code>, <code>muhaz</code>, <code>survdiff</code>, <code>zoo</code>, etc.) are not supported.</p>
</div>
<div id="suggestions" class="section level1">
<h1 class="hasAnchor">
<a href="#suggestions" class="anchor"></a>Suggestions</h1>
<p>If you find any bugs or have any suggestions/remarks, please file an issue on <code>GitHub</code>: <a href="https://github.com/IndrajeetPatil/ggstatsplot/issues" class="uri">https://github.com/IndrajeetPatil/ggstatsplot/issues</a></p>
</div>
<div id="session-information" class="section level1">
<h1 class="hasAnchor">
<a href="#session-information" class="anchor"></a>Session Information</h1>
<p>For details, see- <a href="https://indrajeetpatil.github.io/ggstatsplot/articles/web_only/session_info.html" class="uri">https://indrajeetpatil.github.io/ggstatsplot/articles/web_only/session_info.html</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#general-structure-of-the-plots">General structure of the plots</a></li>
      <li><a href="#omnibus-anova-aov">omnibus ANOVA (<code>aov</code>)</a></li>
      <li><a href="#linear-model-lm">linear model (<code>lm</code>)</a></li>
      <li><a href="#linear-mixed-effects-model-lmerlmermod">linear mixed-effects model (<code>lmer</code>/<code>lmerMod</code>)</a></li>
      <li><a href="#robust-linear-mixed-effects-models-rlmer">robust linear mixed-effects models (<code>rlmer</code>)</a></li>
      <li><a href="#non-linear-mixed-effects-model-nlmernlmermod">non-linear mixed-effects model (<code>nlmer</code>/<code>nlmerMod</code>)</a></li>
      <li><a href="#non-linear-least-squares-model-nls">non-linear least-squares model (<code>nls</code>)</a></li>
      <li><a href="#stationary-linear-model-slm">stationary linear model (<code>slm</code>)</a></li>
      <li><a href="#generalized-linear-model-glm">generalized linear model (<code>glm</code>)</a></li>
      <li><a href="#modified-fitting-for-generalized-linear-models-glm2">modified fitting for generalized linear models (<code>glm2</code>)</a></li>
      <li><a href="#two-stage-least-squares-instrumental-variables-regression-iv_robust">Two-Stage Least Squares Instrumental Variables Regression (<code>iv_robust</code>)</a></li>
      <li><a href="#fitting-negative-binomial-glm-negbin">fitting negative binomial GLM (<code>negbin</code>)</a></li>
      <li><a href="#generalized-linear-mixed-effects-model-glmerglmermod">generalized linear mixed-effects model (<code>glmer</code>/<code>glmerMod</code>)</a></li>
      <li><a href="#fitting-negative-binomial-glmm-glmer-nb">fitting negative binomial GLMM (<code>glmer.nb</code>)</a></li>
      <li><a href="#compound-poisson-generalized-linear-models-cpglm">Compound Poisson Generalized Linear Models (<code>cpglm</code>)</a></li>
      <li><a href="#compound-poisson-generalized-linear-mixed-models-cpglmm">Compound Poisson Generalized Linear Mixed Models (<code>cpglmm</code>)</a></li>
      <li><a href="#bayesian-compound-poisson-linear-models-bcplm">Bayesian Compound Poisson Linear Models (<code>bcplm</code>)</a></li>
      <li><a href="#zero-inflated-compound-poisson-generalized-linear-models-zcpglm">Zero-inflated Compound Poisson Generalized Linear Models (<code>zcpglm</code>)</a></li>
      <li><a href="#vector-generalized-linear-models-vgam">Vector Generalized Linear Models (<code>vgam</code>)</a></li>
      <li><a href="#constrained-generalized-additive-model-fitting-cgam">Constrained Generalized Additive Model Fitting (<code>cgam</code>)</a></li>
      <li><a href="#constrained-generalized-additive-mixed-effects-model-fitting-cgamm">Constrained Generalized Additive Mixed-Effects Model Fitting (<code>cgamm</code>)</a></li>
      <li><a href="#hurdle-models-for-count-data-regression-hurdle">Hurdle Models for Count Data Regression (<code>hurdle</code>)</a></li>
      <li><a href="#dirichlet-regression-model-dirichreg">Dirichlet regression model (<code>DirichReg</code>)</a></li>
      <li><a href="#generalized-linear-models-with-extra-parameters-glmx">Generalized Linear Models with Extra Parameters (<code>glmx</code>)</a></li>
      <li><a href="#generalized-linear-mixed-model-trees-glmertree">generalized linear mixed model trees (<code>glmertree</code>)</a></li>
      <li><a href="#generalized-linear-mixed-models-using-penalized-quasi-likelihood-glmmpql">generalized linear mixed models using Penalized Quasi-Likelihood (<code>glmmPQL</code>)</a></li>
      <li><a href="#generalized-linear-mixed-models-using-template-model-builder-glmmtmb">generalized linear mixed models using Template Model Builder (<code>glmmTMB</code>)</a></li>
      <li><a href="#generalized-linear-mixed-models-using-ad-model-builder-glmmadmb">generalized linear mixed models using AD Model Builder (<code>glmmadmb</code>)</a></li>
      <li><a href="#cumulative-link-models-clm">cumulative link models (<code>clm</code>)</a></li>
      <li><a href="#cumulative-link-models-clm2">cumulative link models (<code>clm2</code>)</a></li>
      <li><a href="#cumulative-link-mixed-models-clmm">cumulative link mixed models (<code>clmm</code>)</a></li>
      <li><a href="#mixed-effects-ordinal-regression-analysis-mixor">Mixed-Effects Ordinal Regression Analysis (<code>mixor</code>)</a></li>
      <li><a href="#bias-reduction-in-generalized-linear-models-brglm2">bias reduction in generalized linear models (<code>brglm2</code>)</a></li>
      <li><a href="#bias-reduction-for-adjacent-category-logit-models-bracl">bias reduction for adjacent category logit models (<code>bracl</code>)</a></li>
      <li><a href="#generalized-linear-models-subject-to-population-constraints">generalized linear models subject to population constraints</a></li>
      <li><a href="#bayesian-linear-linear-mixed-effects-models-blmermod">Bayesian linear linear mixed-effects models (<code>blmerMod</code>)</a></li>
      <li><a href="#bayesian-generalized-linear-mixed-effects-models-bglmermod">Bayesian generalized linear mixed-effects models (<code>bglmerMod</code>)</a></li>
      <li><a href="#ordered-logistic-or-probit-regression-polr">ordered logistic or probit regression (<code>polr</code>)</a></li>
      <li><a href="#multiple-linear-regression-models-mlm">multiple linear regression models (<code>mlm</code>)</a></li>
      <li><a href="#multinomial-logistic-regression-models-multinom">multinomial logistic regression models (<code>multinom</code>)</a></li>
      <li><a href="#multilevel-mediation-model-bmlm">multilevel mediation model (<code>bmlm</code>)</a></li>
      <li><a href="#proportional-odds-and-related-models-svyolr">proportional odds and related models (<code>svyolr</code>)</a></li>
      <li><a href="#survey-weighted-generalized-linear-models-svyglm">survey-weighted generalized linear models (<code>svyglm</code>)</a></li>
      <li><a href="#repeated-measures-anova-aovlist">repeated measures ANOVA (<code>aovlist</code>)</a></li>
      <li><a href="#robust-regression-with-robust-package-lmrob-glmrob">robust regression with <code>robust</code> package (<code>lmRob</code>, <code>glmRob</code>)</a></li>
      <li><a href="#robust-regression-with-robustbase-package-lmrob-glmrob">robust regression with <code>robustbase</code> package (<code>lmrob</code>, <code>glmrob</code>)</a></li>
      <li><a href="#mm-type-estimators-for-linear-regression-on-compositional-data-complmrob">MM-type estimators for linear regression on compositional data (<code>complmrob</code>)</a></li>
      <li><a href="#fit-a-nonlinear-heteroscedastic-model-via-maximum-likelihood-nlreg">fit a nonlinear heteroscedastic model via maximum likelihood (<code>nlreg</code>)</a></li>
      <li><a href="#fit-a-linear-model-with-multiple-group-fixed-effects-felm">fit a linear model with multiple group fixed effects (<code>felm</code>)</a></li>
      <li><a href="#linear-models-for-panel-data-plm">linear models for panel data (<code>plm</code>)</a></li>
      <li><a href="#analysis-of-factorial-experiments-mixed">analysis of factorial experiments (<code>mixed</code>)</a></li>
      <li><a href="#multinomial-logit-model-mlogit">multinomial logit model (<code>mlogit</code>)</a></li>
      <li><a href="#conditional-logit-models-mclogit">conditional logit models (<code>mclogit</code>)</a></li>
      <li><a href="#mixed-conditional-logit-models-mmclogit">mixed conditional logit models (<code>mmclogit</code>)</a></li>
      <li><a href="#conditional-generalized-linear-models-for-clustered-data-cglm">conditional generalized linear models for clustered data (<code>cglm</code>)</a></li>
      <li><a href="#cox-proportional-hazards-regression-model-coxph">Cox proportional hazards regression model (<code>coxph</code>)</a></li>
      <li><a href="#mixed-effects-cox-model-coxme">mixed effects Cox model (<code>coxme</code>)</a></li>
      <li><a href="#truncated-gaussian-regression-models-truncreg">truncated Gaussian Regression Models (<code>truncreg</code>)</a></li>
      <li><a href="#autoregressive-integrated-moving-average-arima">autoregressive integrated moving average (<code>Arima</code>)</a></li>
      <li><a href="#high-performance-linear-model-speedlmspeedglm">high performance linear model (<code>speedlm</code>/<code>speedglm</code>)</a></li>
      <li><a href="#bounded-memory-linear-regression-biglm">bounded memory linear regression (<code>biglm</code>)</a></li>
      <li><a href="#bounded-memory-general-linear-regression-bigglm">bounded memory general linear regression (<code>bigglm</code>)</a></li>
      <li><a href="#parametric-survival-regression-model-survreg">parametric survival regression model (<code>survreg</code>)</a></li>
      <li><a href="#fixed-effects-individual-slope-estimator-feis">Fixed Effects Individual Slope Estimator (<code>feis</code>)</a></li>
      <li><a href="#tobit-regression-tobit">tobit regression (<code>tobit</code>)</a></li>
      <li><a href="#aalens-additive-regression-model-for-censored-data-aareg">Aalen’s additive regression model for censored data (<code>aareg</code>)</a></li>
      <li><a href="#relative-risk-regression-model-for-case-cohort-studies-cch">relative risk regression model for case-cohort studies (<code>cch</code>)</a></li>
      <li><a href="#ridge-regression-ridgelm">ridge regression (<code>ridgelm</code>)</a></li>
      <li><a href="#generalized-additive-models-with-integrated-smoothness-estimation-gam">generalized additive models with integrated smoothness estimation (<code>gam</code>)</a></li>
      <li><a href="#generalized-additive-model-gam">generalized additive model (<code>Gam</code>)</a></li>
      <li><a href="#linear-mixed-effects-models-lme">linear mixed-effects models (<code>lme</code>)</a></li>
      <li><a href="#linear-model-using-generalized-least-squares-gls">linear model using generalized least squares (<code>gls</code>)</a></li>
      <li><a href="#ordinary-least-squares-with-robust-standard-errors-lm_robust">ordinary least squares with robust standard errors (<code>lm_robust</code>)</a></li>
      <li><a href="#inference-for-estimated-coefficients-coeftest">inference for estimated coefficients (<code>coeftest</code>)</a></li>
      <li><a href="#robust-regression-using-an-m-estimator-rlm">robust regression using an M estimator (<code>rlm</code>)</a></li>
      <li><a href="#quantile-regression-rq">quantile regression (<code>rq</code>)</a></li>
      <li><a href="#nonlinear-quantile-regression-estimates-nlrq">nonlinear quantile regression estimates (<code>nlrq</code>)</a></li>
      <li><a href="#additive-quantile-regression-rqss">additive quantile regression (<code>rqss</code>)</a></li>
      <li><a href="#instrumental-variable-regression-ivreg">instrumental-variable regression (<code>ivreg</code>)</a></li>
      <li><a href="#causal-mediation-analysis-mediate">causal mediation analysis (<code>mediate</code>)</a></li>
      <li><a href="#model-ii-regression-lmodel2">Model II regression (<code>lmodel2</code>)</a></li>
      <li><a href="#generalized-additive-models-for-location-scale-and-shape-gamlss">generalized additive models for location scale and shape (<code>gamlss</code>)</a></li>
      <li><a href="#generalized-method-of-moment-estimation-gmm">generalized method of moment estimation (<code>gmm</code>)</a></li>
      <li><a href="#fit-a-glm-with-lasso-or-elasticnet-regularization-glmnet">fit a GLM with lasso or elasticnet regularization (<code>glmnet</code>)</a></li>
      <li><a href="#joint-model-to-time-to-event-data-and-multivariate-longitudinal-data-mjoint">joint model to time-to-event data and multivariate longitudinal data (<code>mjoint</code>)</a></li>
      <li><a href="#exponential-family-random-graph-models-ergm">exponential-family random graph models (<code>ergm</code>)</a></li>
      <li><a href="#tergm-by-bootstrapped-pseudolikelihood-or-mcmc-mle-btergm">TERGM by bootstrapped pseudolikelihood or MCMC MLE (<code>btergm</code>)</a></li>
      <li><a href="#generalized-autoregressive-conditional-heteroscedastic-garch">generalized autoregressive conditional heteroscedastic (<code>garch</code>)</a></li>
      <li><a href="#maximum-likelihood-fitting-of-univariate-distributions-fitdistr">maximum-likelihood fitting of univariate distributions (<code>fitdistr</code>)</a></li>
      <li><a href="#maximum-likelihood-estimation-mle2">maximum likelihood estimation (<code>mle2</code>)</a></li>
      <li><a href="#summary-grid-from-emmeans-package-emmgrid">summary grid from <code>emmeans</code> package (<code>emmGrid</code>)</a></li>
      <li><a href="#cochrane-orcutt-estimation-orcutt">Cochrane-Orcutt estimation (<code>orcutt</code>)</a></li>
      <li><a href="#confusion-matrix-confusionmatrix">confusion matrix (<code>confusionMatrix</code>)</a></li>
      <li><a href="#dose-response-modelscurves-drc">dose-response models/curves (<code>drc</code>)</a></li>
      <li><a href="#flexible-parametric-regression-for-time-to-event-data-flexsurvreg">Flexible parametric regression for time-to-event data (<code>flexsurvreg</code>)</a></li>
      <li><a href="#panel-regression-models-fit-via-multilevel-modeling-wblm">panel regression models fit via multilevel modeling (<code>wblm</code>)</a></li>
      <li><a href="#panel-regression-models-fit-via-generalized-estimating-equations-wbgee">panel regression models fit via generalized estimating equations (<code>wbgee</code>)</a></li>
      <li><a href="#summary-measures-for-count-data-epi-2by2">summary measures for count data (<code>epi.2by2</code>)</a></li>
      <li><a href="#bayesian-generalized-non-linear-multivariate-multilevel-models-brmsfit">Bayesian generalized (non-)linear multivariate multilevel models (<code>brmsfit</code>)</a></li>
      <li><a href="#bayesian-regression-models-via-stan-stanreg">Bayesian regression models via Stan (<code>stanreg</code>)</a></li>
      <li><a href="#bayesian-multivariate-generalized-linear-models-via-stan-stanmvreg">Bayesian multivariate generalized linear models via Stan (<code>stanmvreg</code>)</a></li>
      <li><a href="#bayesian-nonlinear-models-via-stan-nlstanreg">Bayesian nonlinear models via Stan (<code>nlstanreg</code>)</a></li>
      <li><a href="#multivariate-generalized-linear-mixed-models-mcmcglmm">multivariate generalized linear mixed models (<code>MCMCglmm</code>)</a></li>
      <li><a href="#markov-chain-monte-carlo-objects-mcmc">Markov Chain Monte Carlo objects (<code>mcmc</code>)</a></li>
      <li><a href="#mcmc-with-just-another-gibbs-sampler-rjags">MCMC with Just Another Gibbs Sampler (<code>rjags</code>)</a></li>
      <li><a href="#latent-variable-model-lavaan">latent variable model (<code>lavaan</code>)</a></li>
      <li><a href="#bayesian-latent-variable-model-blavaan">Bayesian latent variable model (<code>blavaan</code>)</a></li>
      <li><a href="#regression-models-with-list-outputs">regression models with <code>list</code> outputs</a></li>
      <li><a href="#dataframes-tbl_df-tbl-data-frame">dataframes (<code>tbl_df</code>, <code>tbl</code>, <code>data.frame</code>)</a></li>
      <li><a href="#meta-analysis">meta-analysis</a></li>
      <li><a href="#and-much-more">And much more…</a></li>
      <li><a href="#suggestions">Suggestions</a></li>
      <li><a href="#session-information">Session Information</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://sites.google.com/site/indrajeetspatilmorality/">Indrajeet Patil</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.9000.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '44345fbe359c5496fbc3955c513333d1',
    indexName: 'ggstatsplot',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
