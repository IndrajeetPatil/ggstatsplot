<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ggstatsplot">
<title>ggpiestats • ggstatsplot</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><link href="../../deps/Roboto-0.4.2/font.css" rel="stylesheet">
<link href="../../deps/JetBrains_Mono-0.4.2/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="ggpiestats">
<meta property="og:description" content="ggstatsplot">
<meta property="og:image" content="https://indrajeetpatil.github.io/ggstatsplot/reference/figures/card.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@patilindrajeets">
<meta name="twitter:site" content="@patilindrajeets">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../../index.html">ggstatsplot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.4.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../../articles/ggstatsplot.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Primary functions</h6>
    <a class="dropdown-item" href="../../articles/web_only/ggbetweenstats.html">ggbetweenstats</a>
    <a class="dropdown-item" href="../../articles/web_only/ggwithinstats.html">ggwithinstats</a>
    <a class="dropdown-item" href="../../articles/web_only/gghistostats.html">gghistostats</a>
    <a class="dropdown-item" href="../../articles/web_only/ggdotplotstats.html">ggdotplotstats</a>
    <a class="dropdown-item" href="../../articles/web_only/ggcorrmat.html">ggcorrmat</a>
    <a class="dropdown-item" href="../../articles/web_only/ggscatterstats.html">ggscatterstats</a>
    <a class="dropdown-item" href="../../articles/web_only/ggbarstats.html">ggbarstats</a>
    <a class="dropdown-item" href="../../articles/web_only/ggpiestats.html">ggpiestats</a>
    <a class="dropdown-item" href="../../articles/web_only/ggcoefstats.html">ggcoefstats</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Miscellaneous</h6>
    <a class="dropdown-item" href="../../articles/additional.html">Additional vignettes</a>
    <a class="dropdown-item" href="../../articles/web_only/pairwise.html">Pairwise comparisons with `{ggstatsplot}`</a>
    <a class="dropdown-item" href="../../articles/web_only/faq.html">Frequently Asked Questions (FAQ)</a>
    <a class="dropdown-item" href="../../articles/web_only/purrr_examples.html">using 'ggstatsplot' with the 'purrr' package</a>
    <a class="dropdown-item" href="../../articles/web_only/principles.html">Graphic design and statistical reporting principles</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/IndrajeetPatil/ggstatsplot/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../../logo.png" class="logo" alt=""><h1>ggpiestats</h1>
                        <h4 data-toc-skip class="author">Indrajeet
Patil</h4>
            
            <h4 data-toc-skip class="date">2022-09-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/IndrajeetPatil/ggstatsplot/blob/HEAD/vignettes/web_only/ggpiestats.Rmd" class="external-link"><code>vignettes/web_only/ggpiestats.Rmd</code></a></small>
      <div class="d-none name"><code>ggpiestats.Rmd</code></div>
    </div>

    
    
<hr>
<p>You can cite this package/vignette as:</p>
<pre><code>
To cite package 'ggstatsplot' in publications use:

  Patil, I. (2021). Visualizations with statistical details: The
  'ggstatsplot' approach. Journal of Open Source Software, 6(61), 3167,
  doi:10.21105/joss.03167

A BibTeX entry for LaTeX users is

  @Article{,
    doi = {10.21105/joss.03167},
    url = {https://doi.org/10.21105/joss.03167},
    year = {2021},
    publisher = {{The Open Journal}},
    volume = {6},
    number = {61},
    pages = {3167},
    author = {Indrajeet Patil},
    title = {{Visualizations with statistical details: The {'ggstatsplot'} approach}},
    journal = {{Journal of Open Source Software}},
  }</code></pre>
<hr>
<p>Lifecycle: <a href="https://lifecycle.r-lib.org/articles/stages.html" class="external-link"><img src="https://img.shields.io/badge/lifecycle-maturing-blue.svg" alt="lifecycle"></a></p>
<div class="section level2">
<h2 id="introduction-to-ggpiestats">Introduction to <code>ggpiestats</code><a class="anchor" aria-label="anchor" href="#introduction-to-ggpiestats"></a>
</h2>
<p>The function <code>ggpiestats</code> can be used for quick
<strong>data exploration</strong> and/or to prepare
<strong>publication-ready pie charts</strong> to summarize the
statistical relationship(s) among one or more categorical variables. We
will see examples of how to use this function in this vignette.</p>
<p>To begin with, here are some instances where you would want to use
<code>ggpiestats</code>-</p>
<ul>
<li><p>to check if the proportion of observations matches our
hypothesized proportion, this is typically known as a “Goodness of Fit”
test</p></li>
<li><p>to see if the frequency distribution of two categorical variables
are independent of each other using the contingency table
analysis</p></li>
<li><p>to check if the proportion of observations at each level of a
categorical variable is equal</p></li>
</ul>
<p><strong>Note:</strong> The following demo uses the pipe operator
(<code>%&gt;%</code>), if you are not familiar with this operator, here
is a good explanation: <a href="http://r4ds.had.co.nz/pipes.html" class="external-link uri">http://r4ds.had.co.nz/pipes.html</a>.</p>
<p><code>ggpiestats</code> works <strong>only</strong> with data
organized in data frames or tibbles. It will not work with other data
structures like base-R tables or matrices. It can operate on data frames
that are organized with one row per observation or data frames that have
one column containing counts. This vignette provides examples of both
(see examples below).</p>
<p>To help demonstrate how <code>ggpiestats</code> can be used with
categorical (also known as nominal) data, a modified version of the
original <code>Titanic</code> dataset (from the <code>datasets</code>
library) has been provided in the <a href="https://indrajeetpatil.github.io/ggstatsplot/">ggstatsplot</a> package
with the name <code>Titanic_full</code>. The Titanic Passenger Survival
Dataset provides information “on the fate of passengers on the fatal
maiden voyage of the ocean liner <em>Titanic</em>, including economic
status (class), sex, age, and survival.”</p>
<p>Let’s have a look at the structure of both.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://indrajeetpatil.github.io/ggstatsplot/">ggstatsplot</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># looking at the original data in tabular format</span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">Titanic</span><span class="op">)</span></span>
<span><span class="co">#&gt;  'table' num [1:4, 1:2, 1:2, 1:2] 0 0 35 0 0 0 17 0 118 154 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "dimnames")=List of 4</span></span>
<span><span class="co">#&gt;   ..$ Class   : chr [1:4] "1st" "2nd" "3rd" "Crew"</span></span>
<span><span class="co">#&gt;   ..$ Sex     : chr [1:2] "Male" "Female"</span></span>
<span><span class="co">#&gt;   ..$ Age     : chr [1:2] "Child" "Adult"</span></span>
<span><span class="co">#&gt;   ..$ Survived: chr [1:2] "No" "Yes"</span></span>
<span></span>
<span><span class="co"># looking at the dataset as a tibble or data frame</span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">Titanic_full</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 2,201</span></span>
<span><span class="co">#&gt; Columns: 5</span></span>
<span><span class="co">#&gt; $ <span style="font-weight: bold;">id      </span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18…</span></span>
<span><span class="co">#&gt; $ <span style="font-weight: bold;">Class   </span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> 3rd, 3rd, 3rd, 3rd, 3rd, 3rd, 3rd, 3rd, 3rd, 3rd, 3rd, 3rd, 3…</span></span>
<span><span class="co">#&gt; $ <span style="font-weight: bold;">Sex     </span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> Male, Male, Male, Male, Male, Male, Male, Male, Male, Male, M…</span></span>
<span><span class="co">#&gt; $ <span style="font-weight: bold;">Age     </span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> Child, Child, Child, Child, Child, Child, Child, Child, Child…</span></span>
<span><span class="co">#&gt; $ <span style="font-weight: bold;">Survived</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> No, No, No, No, No, No, No, No, No, No, No, No, No, No, No, N…</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="goodness-of-fit-with-ggpiestats">Goodness of Fit with <code>ggpiestats</code><a class="anchor" aria-label="anchor" href="#goodness-of-fit-with-ggpiestats"></a>
</h2>
<p>The simplest use case for <code>ggpiestats</code> is that we want to
display information about <strong>one</strong> categorical or nominal
variable. As part of that display or plot, we may also choose to execute
a chi-squared goodness of fit test to see whether the proportions (or
percentages) in categories of the single variable appear to line up with
our hypothesis or model. To start simple and then expand, let’s say that
we’d like to display a piechart with the percentages of passengers who
did or did not survive. Our initial hypothesis is that it was no
different than flipping a coin. People had a 50/50 chance of
surviving.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#  for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot</span></span>
<span><span class="fu"><a href="../../reference/ggpiestats.html">ggpiestats</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">Titanic_full</span>,</span>
<span>  x <span class="op">=</span> <span class="va">Survived</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Passenger survival on the Titanic"</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">"Source: Titanic survival dataset"</span>,</span>
<span>  legend.title <span class="op">=</span> <span class="st">"Survived?"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="ggpiestats_files/figure-html/ggpiestats3-1.png" width="100%"></p>
<p><strong>Note:</strong> equal proportions per category are the
default, e.g. 50/50, but you can specify any hypothesized ratio you like
with <code>ratio</code> so if our hypothesis was that 80% died and 20%
survived we would add <code>ratio = c(.80,.20)</code> when we entered
the code.</p>
</div>
<div class="section level2">
<h2 id="independence-or-association-with-ggpiestats">Independence (or association) with <code>ggpiestats</code><a class="anchor" aria-label="anchor" href="#independence-or-association-with-ggpiestats"></a>
</h2>
<p>Let’s next investigate whether the passenger’s gender was independent
of, or associated with, gender. The test is whether the proportion of
people who survived was different between the sexes using
<code>ggpiestats</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## plot</span></span>
<span><span class="fu"><a href="../../reference/ggpiestats.html">ggpiestats</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">Titanic_full</span>,</span>
<span>  x <span class="op">=</span> <span class="va">Survived</span>,</span>
<span>  y <span class="op">=</span> <span class="va">Sex</span></span>
<span><span class="op">)</span> <span class="op">+</span> <span class="co"># further modification with `{ggplot2}` commands</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span></span>
<span>      color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>      size <span class="op">=</span> <span class="fl">14</span>,</span>
<span>      hjust <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="ggpiestats_files/figure-html/ggpiestats1-1.png" width="100%"></p>
<p>The plot clearly shows that survival rates were very different
between males and females. The Pearson’s <span class="math inline">\(\chi^2\)</span>-test of independence is
significant given our large sample size. Additionally, for both females
and males, the survival rates were significantly different than 50% as
indicated by a goodness of fit test for each gender.</p>
</div>
<div class="section level2">
<h2 id="grouped-analysis-with-grouped_ggpiestats">Grouped analysis with <code>grouped_ggpiestats</code><a class="anchor" aria-label="anchor" href="#grouped-analysis-with-grouped_ggpiestats"></a>
</h2>
<p>What if we want to do the same analysis of gender but also factor in
the passenger’s age (Age)? We have information that classifies the
passengers as Child or Adult, perhaps that makes a difference to their
survival rate?</p>
<p><a href="https://indrajeetpatil.github.io/ggstatsplot/">ggstatsplot</a> provides a special helper function for
such instances: <code>grouped_ggpiestats</code>. It is a convenient
wrapper function around <code>combine_plots</code>. It applies
<code>ggpiestats</code> across all <strong>levels</strong> of a
specified <strong>grouping variable</strong> and then combines the list
of individual plots into a single plot. Note that the grouping variable
can be anything: conditions in a given study, groups in a study sample,
different studies, etc.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot</span></span>
<span><span class="fu"><a href="../../reference/grouped_ggpiestats.html">grouped_ggpiestats</a></span><span class="op">(</span></span>
<span>  <span class="co"># arguments relevant for `ggpiestats()`</span></span>
<span>  data <span class="op">=</span> <span class="va">Titanic_full</span>,</span>
<span>  x <span class="op">=</span> <span class="va">Survived</span>,</span>
<span>  y <span class="op">=</span> <span class="va">Sex</span>,</span>
<span>  grouping.var <span class="op">=</span> <span class="va">Age</span>,</span>
<span>  perc.k <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"ggsci"</span>,</span>
<span>  palette <span class="op">=</span> <span class="st">"category10_d3"</span>,</span>
<span>  <span class="co"># arguments relevant for `combine_plots()`</span></span>
<span>  title.text <span class="op">=</span> <span class="st">"Passenger survival on the Titanic by gender and age"</span>,</span>
<span>  caption.text <span class="op">=</span> <span class="st">"Asterisks denote results from proportion tests; \n***: p &lt; 0.001, ns: non-significant"</span>,</span>
<span>  plotgrid.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="ggpiestats_files/figure-html/ggpiestats4-1.png" width="100%"></p>
<p>The resulting pie charts and statistics make the story clear. For
adults gender very much matters. Women survived at much higher rates
than men. For children gender is not significantly associated with
survival and both male and female children have a survival rate that is
not significantly different from 50/50.</p>
</div>
<div class="section level2">
<h2 id="grouped-analysis-with-ggpiestats-purrr">Grouped analysis with <code>ggpiestats</code> +
<code>{purrr}</code><a class="anchor" aria-label="anchor" href="#grouped-analysis-with-ggpiestats-purrr"></a>
</h2>
<p>Although <code>grouped_ggpiestats</code> provides a quick way to
explore the data, it leaves much to be desired. For example, we may want
to add different captions, titles, themes, or palettes for each level of
the grouping variable, etc. For cases like these, it would be better to
use <a href="http://purrr.tidyverse.org" class="external-link">purrr</a> package.</p>
<p>See the associated vignette here: <a href="https://indrajeetpatil.github.io/ggstatsplot/articles/web_only/purrr_examples.html" class="uri">https://indrajeetpatil.github.io/ggstatsplot/articles/web_only/purrr_examples.html</a></p>
</div>
<div class="section level2">
<h2 id="working-with-data-organized-by-counts">Working with data organized by <code>counts</code><a class="anchor" aria-label="anchor" href="#working-with-data-organized-by-counts"></a>
</h2>
<p><code>ggpiestats</code> can also work with data frame containing
counts (aka tabled data), i.e., when each row doesn’t correspond to a
unique observation. For example, consider the following notional
<code>fishing</code> data frame containing data from two boats
(<code>A</code> and <code>B</code>) about the number of different types
fish they caught in the months of <code>February</code> and
<code>March</code>. In this data frame, each row corresponds to a unique
combination of <code>Boat</code> and <code>Month</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># creating a data frame</span></span>
<span><span class="co"># (this is completely fictional; I don't know first thing about fishing!)</span></span>
<span><span class="op">(</span></span>
<span>  <span class="va">fishing</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    Boat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    Month <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"February"</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"March"</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"February"</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"March"</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    Fish <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Bass"</span>,</span>
<span>      <span class="st">"Catfish"</span>,</span>
<span>      <span class="st">"Cod"</span>,</span>
<span>      <span class="st">"Haddock"</span>,</span>
<span>      <span class="st">"Cod"</span>,</span>
<span>      <span class="st">"Haddock"</span>,</span>
<span>      <span class="st">"Bass"</span>,</span>
<span>      <span class="st">"Catfish"</span>,</span>
<span>      <span class="st">"Bass"</span>,</span>
<span>      <span class="st">"Catfish"</span>,</span>
<span>      <span class="st">"Cod"</span>,</span>
<span>      <span class="st">"Haddock"</span>,</span>
<span>      <span class="st">"Cod"</span>,</span>
<span>      <span class="st">"Haddock"</span>,</span>
<span>      <span class="st">"Bass"</span>,</span>
<span>      <span class="st">"Catfish"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    SumOfCaught <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">20</span>, <span class="fl">35</span>, <span class="fl">40</span>, <span class="fl">40</span>, <span class="fl">25</span>, <span class="fl">30</span>, <span class="fl">42</span>, <span class="fl">40</span>, <span class="fl">30</span>, <span class="fl">33</span>, <span class="fl">26</span>, <span class="fl">100</span>, <span class="fl">30</span>, <span class="fl">20</span>, <span class="fl">20</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 16 × 4</span></span></span>
<span><span class="co">#&gt;    <span style="font-weight: bold;">Boat</span>  <span style="font-weight: bold;">Month</span>    <span style="font-weight: bold;">Fish</span>    <span style="font-weight: bold;">SumOfCaught</span></span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> B     February Bass             25</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> B     February Catfish          20</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> B     March    Cod              35</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> B     March    Haddock          40</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> A     February Cod              40</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> A     February Haddock          25</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> A     March    Bass             30</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> A     March    Catfish          42</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> A     February Bass             40</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> A     February Catfish          30</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> A     March    Cod              33</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> A     March    Haddock          26</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> B     February Cod             100</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> B     February Haddock          30</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> B     March    Bass             20</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> B     March    Catfish          20</span></span></code></pre></div>
<p>When the data is organized this way, we make a slightly different
call to the <code><a href="../../reference/ggpiestats.html">ggpiestats()</a></code> function: we use the
<code>counts</code> argument.</p>
<p>If we want to investigate the relationship of type of fish by month
(a test of independence), our command would be:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/ggpiestats.html">ggpiestats</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">fishing</span>,</span>
<span>  x <span class="op">=</span> <span class="va">Fish</span>,</span>
<span>  y <span class="op">=</span> <span class="va">Month</span>,</span>
<span>  counts <span class="op">=</span> <span class="va">SumOfCaught</span>,</span>
<span>  label <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"ggsci"</span>,</span>
<span>  palette <span class="op">=</span> <span class="st">"default_jama"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Type fish caught by month"</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">"Source: completely made up"</span>,</span>
<span>  legend.title <span class="op">=</span> <span class="st">"Type fish caught: "</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="ggpiestats_files/figure-html/ggpiestats8-1.png" width="100%"></p>
<p>The results support our hypothesis that the type of fish caught is
related to the month in which we’re fishing. The <span class="math inline">\(\chi^2\)</span> independence test results at the
top of the plot. In February, we catch significantly more Cod than we
would hypothesize for an equal distribution. Whereas, in March, our
results indicate there’s no strong evidence that the distribution isn’t
equal.</p>
</div>
<div class="section level2">
<h2 id="within-subjects-designs">Within-subjects designs<a class="anchor" aria-label="anchor" href="#within-subjects-designs"></a>
</h2>
<p>Let’s imagine we’re conducting clinical trials for some new imaginary
wonder drug. We have 134 subjects entering the trial. Some of them enter
healthy (<em>n</em> = 96), some of them enter the trial already being
sick (<em>n</em> = 38). All of them receive our treatment or
intervention. Then we check back in a month to see if they are healthy
or sick. A classic pre/post experimental design. We’re interested in
seeing the change in both groupings. In the case of within-subjects
designs, you can set <code>paired = TRUE</code>, which will display
results from <strong>McNemar test</strong> in the subtitle.</p>
<p>(<strong>Note:</strong> If you forget to set
<code>paired = TRUE</code>, the results will be inaccurate.)</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create our imaginary data</span></span>
<span><span class="va">clinical_trial</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">SickBefore</span>, <span class="op">~</span><span class="va">SickAfter</span>, <span class="op">~</span><span class="va">Counts</span>,</span>
<span>  <span class="st">"No"</span>, <span class="st">"Yes"</span>, <span class="fl">4</span>,</span>
<span>  <span class="st">"Yes"</span>, <span class="st">"No"</span>, <span class="fl">25</span>,</span>
<span>  <span class="st">"Yes"</span>, <span class="st">"Yes"</span>, <span class="fl">13</span>,</span>
<span>  <span class="st">"No"</span>, <span class="st">"No"</span>, <span class="fl">92</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot</span></span>
<span><span class="fu"><a href="../../reference/ggpiestats.html">ggpiestats</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">clinical_trial</span>,</span>
<span>  x <span class="op">=</span> <span class="va">SickAfter</span>,</span>
<span>  y <span class="op">=</span> <span class="va">SickBefore</span>,</span>
<span>  counts <span class="op">=</span> <span class="va">Counts</span>,</span>
<span>  paired <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  label <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Results from imaginary clinical trial"</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"ggsci"</span>,</span>
<span>  palette <span class="op">=</span> <span class="st">"default_ucscgb"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="ggpiestats_files/figure-html/ggpiestats9-1.png" width="100%"></p>
<p>The results bode well for our experimental wonder drug. Of the 96 who
started out healthy only 4% were sick after a month. Ideally, we would
have hoped for zero but reality is seldom perfect. On the other side of
the 38 who started out sick that number has reduced to just 13 or 34%
which is a marked improvement.</p>
</div>
<div class="section level2">
<h2 id="summary-of-graphics">Summary of graphics<a class="anchor" aria-label="anchor" href="#summary-of-graphics"></a>
</h2>
<table class="table">
<colgroup>
<col width="21%">
<col width="16%">
<col width="61%">
</colgroup>
<thead><tr class="header">
<th>graphical element</th>
<th>
<code>geom_</code> used</th>
<th>argument for further modification</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>pie slices</td>
<td><code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">ggplot2::geom_col</a></code></td>
<td>❌</td>
</tr>
<tr class="even">
<td>descriptive labels</td>
<td>
<code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">ggplot2::geom_label</a></code>/<code><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html" class="external-link">ggrepel::geom_label_repel</a></code>
</td>
<td><code>label.args</code></td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="summary-of-tests">Summary of tests<a class="anchor" aria-label="anchor" href="#summary-of-tests"></a>
</h2>
<p><strong>two-way table</strong></p>
<p><strong>Hypothesis testing</strong></p>
<table class="table">
<colgroup>
<col width="23%">
<col width="10%">
<col width="54%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th>Type</th>
<th>Design</th>
<th>Test</th>
<th>Function used</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Parametric/Non-parametric</td>
<td>Unpaired</td>
<td>Pearson’s <span class="math inline">\(\chi^2\)</span> test</td>
<td><code><a href="https://rdrr.io/r/stats/chisq.test.html" class="external-link">stats::chisq.test</a></code></td>
</tr>
<tr class="even">
<td>Bayesian</td>
<td>Unpaired</td>
<td>Bayesian Pearson’s <span class="math inline">\(\chi^2\)</span>
test</td>
<td><code><a href="https://rdrr.io/pkg/BayesFactor/man/contingencyTableBF.html" class="external-link">BayesFactor::contingencyTableBF</a></code></td>
</tr>
<tr class="odd">
<td>Parametric/Non-parametric</td>
<td>Paired</td>
<td>McNemar’s <span class="math inline">\(\chi^2\)</span> test</td>
<td><code><a href="https://rdrr.io/r/stats/mcnemar.test.html" class="external-link">stats::mcnemar.test</a></code></td>
</tr>
<tr class="even">
<td>Bayesian</td>
<td>Paired</td>
<td>❌</td>
<td>❌</td>
</tr>
</tbody>
</table>
<p><strong>Effect size estimation</strong></p>
<table class="table">
<colgroup>
<col width="22%">
<col width="10%">
<col width="51%">
<col width="6%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th>Type</th>
<th>Design</th>
<th>Effect size</th>
<th>CI?</th>
<th>Function used</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Parametric/Non-parametric</td>
<td>Unpaired</td>
<td>Cramer’s <span class="math inline">\(V\)</span>
</td>
<td>✅</td>
<td><code><a href="https://easystats.github.io/effectsize/reference/phi.html" class="external-link">effectsize::cramers_v</a></code></td>
</tr>
<tr class="even">
<td>Bayesian</td>
<td>Unpaired</td>
<td>Cramer’s <span class="math inline">\(V\)</span>
</td>
<td>✅</td>
<td><code><a href="https://easystats.github.io/effectsize/reference/phi.html" class="external-link">effectsize::cramers_v</a></code></td>
</tr>
<tr class="odd">
<td>Parametric/Non-parametric</td>
<td>Paired</td>
<td>Cohen’s <span class="math inline">\(g\)</span>
</td>
<td>✅</td>
<td><code><a href="https://easystats.github.io/effectsize/reference/phi.html" class="external-link">effectsize::cohens_g</a></code></td>
</tr>
<tr class="even">
<td>Bayesian</td>
<td>Paired</td>
<td>❌</td>
<td>❌</td>
<td>❌</td>
</tr>
</tbody>
</table>
<p><strong>one-way table</strong></p>
<p><strong>Hypothesis testing</strong></p>
<table class="table">
<colgroup>
<col width="26%">
<col width="60%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th>Type</th>
<th>Test</th>
<th>Function used</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Parametric/Non-parametric</td>
<td>Goodness of fit <span class="math inline">\(\chi^2\)</span>
test</td>
<td><code><a href="https://rdrr.io/r/stats/chisq.test.html" class="external-link">stats::chisq.test</a></code></td>
</tr>
<tr class="even">
<td>Bayesian</td>
<td>Bayesian Goodness of fit <span class="math inline">\(\chi^2\)</span>
test</td>
<td>(custom)</td>
</tr>
</tbody>
</table>
<p><strong>Effect size estimation</strong></p>
<table class="table">
<colgroup>
<col width="25%">
<col width="56%">
<col width="6%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th>Type</th>
<th>Effect size</th>
<th>CI?</th>
<th>Function used</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Parametric/Non-parametric</td>
<td>Pearson’s <span class="math inline">\(C\)</span>
</td>
<td>✅</td>
<td><code><a href="https://easystats.github.io/effectsize/reference/phi.html" class="external-link">effectsize::pearsons_c</a></code></td>
</tr>
<tr class="even">
<td>Bayesian</td>
<td>❌</td>
<td>❌</td>
<td>❌</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="reporting">Reporting<a class="anchor" aria-label="anchor" href="#reporting"></a>
</h2>
<p>If you wish to include statistical analysis results in a
publication/report, the ideal reporting practice will be a hybrid of two
approaches:</p>
<ul>
<li><p>the <a href="https://indrajeetpatil.github.io/ggstatsplot/">ggstatsplot</a> approach, where the plot contains
both the visual and numerical summaries about a statistical model,
and</p></li>
<li><p>the <em>standard</em> narrative approach, which provides
interpretive context for the reported statistics.</p></li>
</ul>
<p>For example, let’s see the following example:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/ggpiestats.html">ggpiestats</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">am</span>, <span class="va">cyl</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggpiestats_files/figure-html/reporting-1.png" width="100%"></p>
<p>The narrative context (assuming <code>type = "parametric"</code>) can
complement this plot either as a figure caption or in the main text-</p>
<blockquote>
<p>Pearson’s <span class="math inline">\(\chi^2\)</span>-test of
independence revealed that, across 32 automobiles, showed that there was
a significant association between transmission engine and number of
cylinders. The Bayes Factor for the same analysis revealed that the data
were 16.78 times more probable under the alternative hypothesis as
compared to the null hypothesis. This can be considered strong evidence
(Jeffreys, 1961) in favor of the alternative hypothesis.</p>
</blockquote>
<p>Similar reporting style can be followed when the function performs
one-sample goodness-of-fit test instead of a <span class="math inline">\(\chi^2\)</span>-test.</p>
<p>Same holds true for <code>ggbarstats</code>.</p>
</div>
<div class="section level2">
<h2 id="suggestions">Suggestions<a class="anchor" aria-label="anchor" href="#suggestions"></a>
</h2>
<p>If you find any bugs or have any suggestions/remarks, please file an
issue on GitHub: <a href="https://github.com/IndrajeetPatil/ggstatsplot/issues" class="external-link uri">https://github.com/IndrajeetPatil/ggstatsplot/issues</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://sites.google.com/site/indrajeetspatilmorality/" class="external-link">Indrajeet Patil</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.9000.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
